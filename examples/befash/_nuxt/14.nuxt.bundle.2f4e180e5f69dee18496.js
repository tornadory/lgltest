webpackJsonp([14],{633:function(e,t,n){var a=n(75)(n(745),n(863),null,null,null);e.exports=a.exports},647:function(e,t,n){function a(e){n(660)}var i=n(75)(n(650),n(657),a,null,null);e.exports=i.exports},648:function(e,t,n){"use strict";var a=n(11),i=n.n(a),o=n(103),s=n.n(o),r=n(102),l=n.n(r),d=n(162),u=n.n(d),c=n(163),p=n.n(c),h=function(){function e(t){u()(this,e),this.view=t,this.width=parseInt(this.view.style.width),this.height=parseInt(this.view.style.height),this.load=new THREE.CBMLoader;var n={};n.type="js",this.drcLoad=new THREE.DRACOLoader("/upload/js/",n),this.init()}return p()(e,[{key:"init",value:function(){this.initScene(),this.initCamera(),this.initRender(),this.initLight(),this.view.appendChild(this.renderer.domElement),this.render()}},{key:"initScene",value:function(){this.scene=new THREE.Scene}},{key:"initCamera",value:function(){this.camera=new THREE.PerspectiveCamera(60,this.width/this.height,.01,20),this.camera.position.z=.8,this.camera.position.y=0,this.camera.lookAt({x:0,y:0,z:0}),this.camera.up.x=this.camera.up.z=0,this.camera.up.y=1}},{key:"initRender",value:function(){this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setClearColor(13421772),this.renderer.setSize(this.width,this.height),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.renderer.shadowMapSoft=!0,this.renderer.setPixelRatio(window.devicePixelRatio)}},{key:"initLight",value:function(){var e=new THREE.AmbientLight(16777215,.5);this.scene.add(e);var t=new THREE.SpotLight(16777215,.5,100,1,.2,1.5);t.position.set(0,0,5),this.scene.add(t)}},{key:"loadModel",value:function(){function e(e){return t.apply(this,arguments)}var t=l()(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadModelPromise(t);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"loadModelPromise",value:function(e){var t=this;return new i.a(function(n,a){t.mesh&&(t.scene.remove(t.mesh),t.clearScene(t.mesh)),/(.drc|.bf)$/.test(e.toLowerCase())?t.drcLoad.load(e,function(e){var a=new THREE.Mesh(e,new THREE.MeshPhysicalMaterial);(new THREE.Box3).setFromObject(a).getCenter(a.position),a.position.multiplyScalar(-1),t.mesh=a,t.scene.add(a),t.render(),n()}):t.load.load(e,function(e){(new THREE.Box3).setFromObject(e).getCenter(e.position),e.position.multiplyScalar(-1),t.mesh=e,t.scene.add(e),t.render(),n()})})}},{key:"clearScene",value:function(e){if(e.isMesh)e.geometry.dispose(),e.geometry=null,e.material.dispose(),e.material=null,e=null;else if(void 0!==e.children)for(;e.children.length>0;)this.clearScene(e.children[0]),e.remove(e.children[0])}},{key:"renderToBase64",value:function(){return this.render(),this.view.getElementsByTagName("canvas")[0].toDataURL("image/png")}},{key:"renderToImage",value:function(){return this.dataURLtoBlob(this.renderToBase64())}},{key:"dataURLtoBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],a=atob(t[1]),i=a.length,o=new Uint8Array(i);i--;)o[i]=a.charCodeAt(i);return new Blob([o],{type:n})}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}}]),e}();t.a=h},650:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(648),i=n(12),o=n.n(i);t.default={mounted:function(){this.$preview=new a.a(document.getElementById("upload-model")),this.value&&this.$preview.loadModel("/upload/"+this.value)},props:{value:String},data:function(){return{progress:0}},methods:{handleUplaadSuccess:function(e,t){var n=this;this.$preview.loadModelPromise("/upload/"+e.data).then(function(){n.$emit("input",e.data);var t=n.$preview.renderToImage(),a=new FormData;a.append("file",t),a.append("name",e.data.substr(0,e.data.lastIndexOf("."))),o.a.post("/upload/blob",a).then(function(e){n.$emit("preview",e.data.data)})})},on_progress:function(e){this.progress=parseInt(e.percent)},on_upload:function(e){this.value=""}}}},652:function(e,t,n){t=e.exports=n(76)(!0),t.push([e.i,"#upload-model,.model-upload .el-upload-dragger{width:200px;height:200px}","",{version:3,sources:["/var/gdpublic/gdpublic/components/model-upload.vue"],names:[],mappings:"AACA,+CACI,YAAa,AACb,YAAc,CACjB",file:"model-upload.vue",sourcesContent:["\n#upload-model, .model-upload .el-upload-dragger {\n    width: 200px;\n    height: 200px;\n}\n"],sourceRoot:""}])},657:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-upload",{staticClass:"model-upload",attrs:{drag:"",action:"/upload/model","show-file-list":!1,"on-success":e.handleUplaadSuccess,"before-upload":e.on_upload,"on-progress":e.on_progress}},[e.progress?n("div",{staticStyle:{height:"200px",background:"#fff"}},[n("el-progress",{staticStyle:{padding:"40px 0"},attrs:{type:"circle",percentage:e.progress}})],1):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticStyle:{width:"200px",height:"200px"},attrs:{id:"upload-model"}}),n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])])])},staticRenderFns:[]}},660:function(e,t,n){var a=n(652);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(77)("b3db3178",a,!0)},718:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{value:String},data:function(){return{progress:0}},methods:{handleUplaadSuccess:function(e,t){this.progress=0,console.log(e),this.$emit("input",e.data)},on_upload:function(e){this.progress=parseInt(e.percent)}}}},745:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(647),i=n.n(a),o=n(813),s=n.n(o);t.default={components:{modelUpload:i.a,xlsxUpload:s.a},watch:{value:function(e){console.log("value ",e)}},data:function(){return{value:"dc8729ae-e5d0-4111-9202-db7a687ab47a.cbm"}},methods:{previewChange:function(e){console.log("previe chang ",e)}}}},774:function(e,t,n){t=e.exports=n(76)(!0),t.push([e.i,".el-upload-dragger{width:200px;height:200px}","",{version:3,sources:["/var/gdpublic/gdpublic/components/xlsx-upload.vue"],names:[],mappings:"AACA,mBACI,YAAa,AACb,YAAc,CACjB",file:"xlsx-upload.vue",sourcesContent:["\n.el-upload-dragger {\n    width: 200px;\n    height: 200px;\n}\n"],sourceRoot:""}])},813:function(e,t,n){function a(e){n(894)}var i=n(75)(n(718),n(858),a,null,null);e.exports=i.exports},858:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-upload",{attrs:{drag:"",action:"building/household/execl","show-file-list":!1,"on-success":e.handleUplaadSuccess,"on-progress":e.on_upload}},[e.progress?n("div",{staticStyle:{height:"200px",background:"#fff"}},[n("el-progress",{staticStyle:{padding:"40px 0"},attrs:{type:"circle",percentage:e.progress}})],1):e._e(),n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])])])},staticRenderFns:[]}},863:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("model-upload",{attrs:{value:e.value},on:{preview:e.previewChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),n("xlsx-upload")],1)},staticRenderFns:[]}},894:function(e,t,n){var a=n(774);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(77)("11959220",a,!0)}});