(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var Info=function(t,e){var i=document.title,s=$(e.appendCredits);e.appendCredits&&$(".credits").append(s),e.title&&$("#info-title").text(e.title),e.subtitle&&$("#info-subtitle").text(e.subtitle),e.titleCss&&$("#info-title").css(e.titleCss),e.subtitleCss&&$("#info-subtitle").css(e.subtitleCss),e.documentTitle&&(document.title=e.documentTitle),e.showArrowNext&&$(".arrow-next").show(),$("#info").show(),t.emitter.on("destroy",function(){document.title=i,$("#info-title").text(""),$("#info-subtitle").text(""),$("#info-title").attr("style",""),$("#info-subtitle").attr("style",""),$(".arrow-next").hide(),$("#info").hide(),s.remove()})};module.exports=Info;


},{}],2:[function(require,module,exports){
"use strict";var Stars=function(t){this.poem=t,this.object=null,this.count=3e4,this.depth=5e3,this.minDepth=700,this.color=11184810,this.addObject()};module.exports=Stars,Stars.prototype={generateGeometry:function(){var t,e,o,i,h,s;s=new THREE.Geometry;for(var r=0;r<this.count;r++)t=Math.random()*this.depth+this.minDepth,e=2*Math.random()*Math.PI,o=Math.cos(e)*t,h=Math.sin(e)*t,i=(.5-Math.random())*this.depth,s.vertices.push(new THREE.Vector3(o,i,h));return s},addObject:function(){var t;t=this.generateGeometry(),this.object=new THREE.PointCloud(t,new THREE.PointCloudMaterial({size:3*this.poem.ratio,color:this.color,fog:!1})),this.poem.scene.add(this.object)}};


},{}],3:[function(require,module,exports){
"use strict";function setupTexture(e,t,n){var o=new Image,i=new THREE.Texture(o);return o.src="assets/images/cloud1024.png",$("body").append(o),i.wrapS=THREE.RepeatWrapping,i.wrapT=THREE.RepeatWrapping,$(o).on("load",function(){n.needsUpdate=!0,i.needsUpdate=!0}),t.add(e),i}var Clouds=function(e,t){var n=_.extend({width:500,offset:new THREE.Vector2(1,1),color:new THREE.Vector4(.5,1,.7,1),height:-200,rotation:Math.PI/2},t),o=new THREE.PlaneGeometry(n.width,n.width),i=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nvarying vec2 vUv;\n\nvoid main() {\n	\n	vUv = uv;\n	\n	gl_Position = projectionMatrix *\n		modelViewMatrix *\n		vec4( position, 1.0);\n		\n}",fragmentShader:"#define GLSLIFY 1\n\nuniform float time;\nuniform vec4 color;\nuniform vec2 offset;\nuniform sampler2D texture;\n\nvarying vec2 vUv;\n\nvoid main() {\n	\n	vec4 texel = \n		texture2D( texture, vUv * 0.1 + ( offset + time * 0.00001) * offset ) +\n		texture2D( texture, vUv * 0.22 + ( offset + time * 0.0000055) * offset );\n	\n	float edges = 0.5 - length(vUv - 0.5);\n	\n  gl_FragColor = color * edges * vec4( 1.0, 1.0, 1.0, texel.w * texel.w * 2.5 );\n	\n}",transparent:!0,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,depthTest:!1,uniforms:{time:{type:"f",value:0},texture:{type:"t",value:null},offset:{type:"v2",value:n.offset},color:{type:"v4",value:n.color}},attributes:{}}),r=new THREE.Mesh(o,i);r.rotation.x=n.rotation,r.position.y=n.height,r.scale.multiplyScalar(10),i.uniforms.texture.value=setupTexture(r,e.scene,i),e.emitter.on("update",function(t){var n=e.camera.object.position;i.uniforms.time.value=t.elapsed,r.position.set(n.x,r.position.y,n.z)})};module.exports=Clouds;


},{}],4:[function(require,module,exports){
"use strict";var Sky=function(n,e){var i=_.extend({width:5e3},e),t=new THREE.SphereGeometry(i.width,64,30),o=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform float time;\nvarying vec4 vColor;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289_1_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nfloat mod289_1_0(float x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 permute_1_1(vec4 x) {\n     return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nfloat permute_1_1(float x) {\n     return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt_1_2(float r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4_1_3(float j, vec4 ip)\n  {\n  const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n  vec4 p,s;\n\n  p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n  p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n  s = vec4(lessThan(p, vec4(0.0)));\n  p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n  return p;\n  }\n\n// (sqrt(5) - 1)/4 = F4, used once below\n#define F4 0.309016994374947451\n\nfloat snoise_1_4(vec4 v)\n  {\n  const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4\n                        0.276393202250021,  // 2 * G4\n                        0.414589803375032,  // 3 * G4\n                       -0.447213595499958); // -1 + 4 * G4\n\n// First corner\n  vec4 i  = floor(v + dot(v, vec4(F4)) );\n  vec4 x0 = v -   i + dot(i, C.xxxx);\n\n// Other corners\n\n// Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n  vec4 i0;\n  vec3 isX = step( x0.yzw, x0.xxx );\n  vec3 isYZ = step( x0.zww, x0.yyz );\n//  i0.x = dot( isX, vec3( 1.0 ) );\n  i0.x = isX.x + isX.y + isX.z;\n  i0.yzw = 1.0 - isX;\n//  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n  i0.y += isYZ.x + isYZ.y;\n  i0.zw += 1.0 - isYZ.xy;\n  i0.z += isYZ.z;\n  i0.w += 1.0 - isYZ.z;\n\n  // i0 now contains the unique values 0,1,2,3 in each channel\n  vec4 i3 = clamp( i0, 0.0, 1.0 );\n  vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n  vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n  //  x0 = x0 - 0.0 + 0.0 * C.xxxx\n  //  x1 = x0 - i1  + 1.0 * C.xxxx\n  //  x2 = x0 - i2  + 2.0 * C.xxxx\n  //  x3 = x0 - i3  + 3.0 * C.xxxx\n  //  x4 = x0 - 1.0 + 4.0 * C.xxxx\n  vec4 x1 = x0 - i1 + C.xxxx;\n  vec4 x2 = x0 - i2 + C.yyyy;\n  vec4 x3 = x0 - i3 + C.zzzz;\n  vec4 x4 = x0 + C.wwww;\n\n// Permutations\n  i = mod289_1_0(i);\n  float j0 = permute_1_1( permute_1_1( permute_1_1( permute_1_1(i.w) + i.z) + i.y) + i.x);\n  vec4 j1 = permute_1_1( permute_1_1( permute_1_1( permute_1_1 (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n// Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n// 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n  vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n  vec4 p0_1_5 = grad4_1_3(j0,   ip);\n  vec4 p1 = grad4_1_3(j1.x, ip);\n  vec4 p2 = grad4_1_3(j1.y, ip);\n  vec4 p3 = grad4_1_3(j1.z, ip);\n  vec4 p4 = grad4_1_3(j1.w, ip);\n\n// Normalise gradients\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(p0_1_5,p0_1_5), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1_5 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n  p4 *= taylorInvSqrt_1_2(dot(p4,p4));\n\n// Mix contributions from the five corners\n  vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n  vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n  m0 = m0 * m0;\n  m1 = m1 * m1;\n  return 49.0 * ( dot(m0*m0, vec3( dot( p0_1_5, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n               + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n\n  }\n\n\n\nvec3 hsv2rgb_2_6(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n\n\n\nfloat inRange( in float value, in float start, in float stop ) {\n	\n	return min( 1.0, max( 0.0,\n		(value - start) / (stop - start)\n	));\n	\n}\n\nvec4 calculateColor( in vec2 uv, in vec3 position ) {\n	\n	float gradient =\n		inRange( uv.y, 0.55, 0.7 ) +\n		inRange( uv.y, 0.45, 0.3 ) ;\n	\n	float noise = snoise_1_4( vec4( position * 0.03, time * 0.0001 ) );\n	\n	vec3 color = hsv2rgb_2_6(vec3(\n		max(0.0, noise) * 0.2 + 0.4,\n		1.0,\n		1.0\n	));\n	\n	return vec4(\n		color,\n		noise * gradient\n	);\n	\n}\n\nvoid main() {\n	\n	vColor = calculateColor( uv, position );\n	\n	gl_Position = projectionMatrix *\n		modelViewMatrix *\n		vec4( position, 1.0);\n		\n}",fragmentShader:"#define GLSLIFY 1\n\nvarying vec4 vColor;\n\n// float remap( in float value, in float start, in float stop ) {\n// 	return start + value * ( stop - start );\n// }\n\nvoid main() {\n	\n	gl_FragColor = vColor;\n	\n}",side:THREE.BackSide,transparent:!0,depthTest:!1,uniforms:{time:{type:"f",value:0}},attributes:{}}),r=new THREE.Mesh(t,o);n.scene.add(r),n.emitter.on("update",function(e){o.uniforms.time.value=e.elapsed,r.position.copy(n.camera.object.position)})};module.exports=Sky;


},{}],5:[function(require,module,exports){
"use strict";function _createMaterial(n,e){var r=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform float elapsed;\nuniform float uRange;\nattribute float size;\nattribute float aOffset;\n\nvarying float vOffset;\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1_0(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_1_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x) {\n     return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_1_3(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D_1_4 = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_1_5 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_1_5;\n  vec3 i1 = min( g_1_5.xyz, l.zxy );\n  vec3 i2 = max( g_1_5.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D_1_4.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_1_0(i);\n  vec4 p = permute_1_1( permute_1_1( permute_1_1(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D_1_4.wyz - D_1_4.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1_1_6 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0_1_7 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1_1_6.xy,h.z);\n  vec3 p3 = vec3(a1_1_6.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(p0_1_7,p0_1_7), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1_7 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0_1_7,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n\n\n\nvoid main() {\n\n	// vec3 movement = vec3(0.0, elapsed * 0.001, 0.0);\n	vec3 movement = vec3(\n		sin( elapsed * 0.002 * aOffset) * uRange * 0.003,\n		elapsed * (-uRange / 100000.0 - uRange / 100000.0 * aOffset),\n		cos( elapsed * 0.002 * aOffset ) * uRange * 0.003\n	);\n	\n	vec3 range = vec3(uRange, uRange * 0.3, uRange);\n	\n	vec3 cameraOffset = cameraPosition - range;\n	\n	vec3 moduloPosition = mod( position + movement - cameraOffset, range * 2.0 ) + cameraOffset;\n	vec4 mvPosition = modelViewMatrix * vec4( moduloPosition, 1.0 );\n	\n	vOffset = aOffset;\n	\n	gl_PointSize = size * ( uRange / (length( mvPosition.xyz ) + 1.0) );\n	gl_Position = projectionMatrix * mvPosition;\n\n}",fragmentShader:"#define GLSLIFY 1\n\nprecision highp float;\n\nuniform float elapsed;\nvarying float vOffset;\n\nvec2 doModel(vec3 p);\n\n// Originally sourced from https://www.shadertoy.com/view/ldfSWs\n// Thank you Iñigo :)\n\nvec2 calcRayIntersection_2_0(vec3 rayOrigin, vec3 rayDir, float maxd, float precis) {\n  float latest = precis * 2.0;\n  float dist   = +0.0;\n  float type   = -1.0;\n  vec2  res    = vec2(-1.0, -1.0);\n\n  for (int i = 0; i < 30; i++) {\n    if (latest < precis || dist > maxd) break;\n\n    vec2 result = doModel(rayOrigin + rayDir * dist);\n\n    latest = result.x;\n    type   = result.y;\n    dist  += latest;\n  }\n\n  if (dist < maxd) {\n    res = vec2(dist, type);\n  }\n\n  return res;\n}\n\nvec2 calcRayIntersection_2_0(vec3 rayOrigin, vec3 rayDir) {\n  return calcRayIntersection_2_0(rayOrigin, rayDir, 20.0, 0.001);\n}\n\n\n\n// Originally sourced from https://www.shadertoy.com/view/ldfSWs\n// Thank you Iñigo :)\n\nvec3 calcNormal_3_1(vec3 pos, float eps) {\n  const vec3 v1 = vec3( 1.0,-1.0,-1.0);\n  const vec3 v2 = vec3(-1.0,-1.0, 1.0);\n  const vec3 v3 = vec3(-1.0, 1.0,-1.0);\n  const vec3 v4 = vec3( 1.0, 1.0, 1.0);\n\n  return normalize( v1 * doModel( pos + v1*eps ).x +\n                    v2 * doModel( pos + v2*eps ).x +\n                    v3 * doModel( pos + v3*eps ).x +\n                    v4 * doModel( pos + v4*eps ).x );\n}\n\nvec3 calcNormal_3_1(vec3 pos) {\n  return calcNormal_3_1(pos, 0.002);\n}\n\n\n\nvec2 squareFrame_7_2(vec2 screenSize) {\n  vec2 position = 2.0 * (gl_FragCoord.xy / screenSize.xy) - 1.0;\n  position.x *= screenSize.x / screenSize.y;\n  return position;\n}\n\nvec2 squareFrame_7_2(vec2 screenSize, vec2 coord) {\n  vec2 position = 2.0 * (coord.xy / screenSize.xy) - 1.0;\n  position.x *= screenSize.x / screenSize.y;\n  return position;\n}\n\n\n\nmat3 calcLookAtMatrix_9_3(vec3 origin, vec3 target, float roll) {\n  vec3 rr = vec3(sin(roll), cos(roll), 0.0);\n  vec3 ww = normalize(target - origin);\n  vec3 uu = normalize(cross(ww, rr));\n  vec3 vv = normalize(cross(uu, ww));\n\n  return mat3(uu, vv, ww);\n}\n\n\n\n\nvec3 getRay_8_4(mat3 camMat, vec2 screenPos, float lensLength) {\n  return normalize(camMat * vec3(screenPos, lensLength));\n}\n\nvec3 getRay_8_4(vec3 origin, vec3 target, vec2 screenPos, float lensLength) {\n  mat3 camMat = calcLookAtMatrix_9_3(origin, target, 0.0);\n  return getRay_8_4(camMat, screenPos, lensLength);\n}\n\n\n\n\nvoid orbitCamera_4_5(\n  in float camAngle,\n  in float camHeight,\n  in float camDistance,\n  in vec2 screenResolution,\n  out vec3 rayOrigin,\n  out vec3 rayDirection\n) {\n  vec2 screenPos = squareFrame_7_2(screenResolution);\n  vec3 rayTarget = vec3(0.0);\n\n  rayOrigin = vec3(\n    camDistance * sin(camAngle),\n    camHeight,\n    camDistance * cos(camAngle)\n  );\n\n  rayDirection = getRay_8_4(rayOrigin, rayTarget, screenPos, 2.0);\n}\n\n\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289_1_6(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nfloat mod289_1_6(float x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 permute_1_7(vec4 x) {\n     return mod289_1_6(((x*34.0)+1.0)*x);\n}\n\nfloat permute_1_7(float x) {\n     return mod289_1_6(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_8(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt_1_8(float r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4_1_9(float j, vec4 ip)\n  {\n  const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n  vec4 p,s;\n\n  p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n  p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n  s = vec4(lessThan(p, vec4(0.0)));\n  p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n  return p;\n  }\n\n// (sqrt(5) - 1)/4 = F4, used once below\n#define F4 0.309016994374947451\n\nfloat snoise_1_10(vec4 v)\n  {\n  const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4\n                        0.276393202250021,  // 2 * G4\n                        0.414589803375032,  // 3 * G4\n                       -0.447213595499958); // -1 + 4 * G4\n\n// First corner\n  vec4 i  = floor(v + dot(v, vec4(F4)) );\n  vec4 x0 = v -   i + dot(i, C.xxxx);\n\n// Other corners\n\n// Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n  vec4 i0;\n  vec3 isX = step( x0.yzw, x0.xxx );\n  vec3 isYZ = step( x0.zww, x0.yyz );\n//  i0.x = dot( isX, vec3( 1.0 ) );\n  i0.x = isX.x + isX.y + isX.z;\n  i0.yzw = 1.0 - isX;\n//  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n  i0.y += isYZ.x + isYZ.y;\n  i0.zw += 1.0 - isYZ.xy;\n  i0.z += isYZ.z;\n  i0.w += 1.0 - isYZ.z;\n\n  // i0 now contains the unique values 0,1,2,3 in each channel\n  vec4 i3 = clamp( i0, 0.0, 1.0 );\n  vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n  vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n  //  x0 = x0 - 0.0 + 0.0 * C.xxxx\n  //  x1 = x0 - i1  + 1.0 * C.xxxx\n  //  x2 = x0 - i2  + 2.0 * C.xxxx\n  //  x3 = x0 - i3  + 3.0 * C.xxxx\n  //  x4 = x0 - 1.0 + 4.0 * C.xxxx\n  vec4 x1 = x0 - i1 + C.xxxx;\n  vec4 x2 = x0 - i2 + C.yyyy;\n  vec4 x3 = x0 - i3 + C.zzzz;\n  vec4 x4 = x0 + C.wwww;\n\n// Permutations\n  i = mod289_1_6(i);\n  float j0 = permute_1_7( permute_1_7( permute_1_7( permute_1_7(i.w) + i.z) + i.y) + i.x);\n  vec4 j1 = permute_1_7( permute_1_7( permute_1_7( permute_1_7 (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n// Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n// 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n  vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n  vec4 p0_1_11 = grad4_1_9(j0,   ip);\n  vec4 p1 = grad4_1_9(j1.x, ip);\n  vec4 p2 = grad4_1_9(j1.y, ip);\n  vec4 p3 = grad4_1_9(j1.z, ip);\n  vec4 p4 = grad4_1_9(j1.w, ip);\n\n// Normalise gradients\n  vec4 norm = taylorInvSqrt_1_8(vec4(dot(p0_1_11,p0_1_11), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1_11 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n  p4 *= taylorInvSqrt_1_8(dot(p4,p4));\n\n// Mix contributions from the five corners\n  vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n  vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n  m0 = m0 * m0;\n  m1 = m1 * m1;\n  return 49.0 * ( dot(m0*m0, vec3( dot( p0_1_11, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n               + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n\n  }\n\n\n\nmat3 calcLookAtMatrix_6_12(vec3 origin, vec3 target, float roll) {\n  vec3 rr = vec3(sin(roll), cos(roll), 0.0);\n  vec3 ww = normalize(target - origin);\n  vec3 uu = normalize(cross(ww, rr));\n  vec3 vv = normalize(cross(uu, ww));\n\n  return mat3(uu, vv, ww);\n}\n\n\n\n\nvec3 getRay_5_13(mat3 camMat, vec2 screenPos, float lensLength) {\n  return normalize(camMat * vec3(screenPos, lensLength));\n}\n\nvec3 getRay_5_13(vec3 origin, vec3 target, vec2 screenPos, float lensLength) {\n  mat3 camMat = calcLookAtMatrix_6_12(origin, target, 0.0);\n  return getRay_5_13(camMat, screenPos, lensLength);\n}\n\n\n\n\nvec2 doModel(vec3 p) {\n	float r  = 1.0 + snoise_1_10(vec4(p, elapsed / 1000.0)) * 0.25;\n	float d  = length(p) - r;\n	float id = 0.0;\n\n	return vec2(d, id);\n}\n\nvec2 squareFrame(vec2 screenSize, vec2 screenPosition) {\n	vec2 position = 2.0 * (screenPosition.xy / screenSize.xy) - 1.0;\n	position.x *= screenSize.x / screenSize.y;\n	return position;\n}\n\n\nvoid orbitCamera(\n	in float camAngle,\n	in float camHeight,\n	in float camDistance,\n	in vec2 screenResolution,\n	in vec2 screenPosition,\n	out vec3 rayOrigin,\n	out vec3 rayDirection\n) {\n	vec2 screenPos = squareFrame(screenResolution, screenPosition);\n	vec3 rayTarget = vec3(0.0);\n \n	rayOrigin = vec3(\n		camDistance * sin(camAngle),\n		camHeight,\n		camDistance * cos(camAngle)\n	);\n \n	rayDirection = getRay_5_13(rayOrigin, rayTarget, screenPos, 2.0);\n}\n\n\nvoid main() {\n	vec3 color = vec3(0.0);\n	vec3 rayOrigin, rayDirection;\n\n	float rotation = elapsed / 1000.0;\n	float height   = 0.0;\n	float dist     = 3.0;\n	vec2 iResolution = vec2( 1.0, 1.0 );\n	\n	orbitCamera(rotation + vOffset * 100.0, height, dist, iResolution, gl_PointCoord, rayOrigin, rayDirection);\n\n	vec2 t = calcRayIntersection_2_0(rayOrigin, rayDirection);\n	if (t.x > -0.5) {\n		vec3 pos = rayOrigin + rayDirection * t.x;\n		vec3 nor = calcNormal_3_1(pos);\n\n		color = nor * 0.5 + 0.5;\n	}\n\n	gl_FragColor.rgb = color;\n	gl_FragColor.a	 = length(color) * 10.0;\n}\n\n// Old shader:\n//\n// uniform vec3 color;\n// uniform sampler2D texture;\n// uniform float elapsed;\n//\n// varying float vAlpha;\n//\n// void main() {\n//\n// 	gl_FragColor = vec4(color, 1.0);\n//\n// }\n// ",depthTest:!1,blending:THREE.AdditiveBlending,transparent:!0,uniforms:{elapsed:{type:"f",value:n},uRange:{type:"f",value:e}},attributes:{size:{type:"f",value:[]},aOffset:{type:"f",value:[]}}});return r}function _createGeometry(n,e,r,t,o){for(var i=new THREE.BufferGeometry,a=new Float32Array(3*e),c=new Float32Array(e),s=new Float32Array(e),v=0;e>v;v++)a[3*v+0]=Random.range(-r,r),a[3*v+1]=.3*Random.range(-r,r),a[3*v+2]=Random.range(-r,r),c[v]=Random.range(t[0],t[1])*o,s[v]=Random.range(0,1);return i.addAttribute("position",new THREE.BufferAttribute(a,3)),i.addAttribute("size",new THREE.BufferAttribute(c,1)),i.addAttribute("aOffset",new THREE.BufferAttribute(s,1)),i}function _createMeshAndStart(n,e,r){var t=new THREE.PointCloud(e,r);t.frustumCulled=!1;LoadTexture("assets/images/bokeh.png",r.uniforms.texture,"value").then(function(){n.scene.add(t),n.emitter.on("update",_updateFn(n,t))});return t}function _updateFn(n,e){return function(n){e.material.uniforms.elapsed.value=n.elapsed}}var LoadTexture=require("../../../utils/loadTexture"),Random=require("../../../utils/random");module.exports=function(n,e){{var r=_.extend({count:1e3,color:new THREE.Color(7864319),range:300,sizeRange:[10,20]},e),t=_createMaterial(r.color,r.range),o=_createGeometry(t,r.count,r.range,r.sizeRange,n.ratio);_createMeshAndStart(n,o,t)}return{}};


},{"../../../utils/loadTexture":67,"../../../utils/random":68}],6:[function(require,module,exports){
"use strict";function _createMaterial(e){var n=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform float elapsed;\n\nattribute float size;\nattribute float opacity;\n\nvarying float vAlpha;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1_0(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_1_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x) {\n     return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_1_3(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D_1_4 = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_1_5 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_1_5;\n  vec3 i1 = min( g_1_5.xyz, l.zxy );\n  vec3 i2 = max( g_1_5.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D_1_4.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_1_0(i);\n  vec4 p = permute_1_1( permute_1_1( permute_1_1(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D_1_4.wyz - D_1_4.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1_1_6 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0_1_7 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1_1_6.xy,h.z);\n  vec3 p3 = vec3(a1_1_6.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(p0_1_7,p0_1_7), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1_7 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0_1_7,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n\n\n\nvoid main() {\n\n	vAlpha = opacity;\n\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n	\n	gl_PointSize = 100.0 * size / length( mvPosition.xyz );\n	\n	gl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"#define GLSLIFY 1\n\nuniform vec3 color;\nuniform sampler2D texture;\n// uniform float elapsed;\n\nvarying float vAlpha;\n\nvoid main() {\n\n	gl_FragColor = vec4(color, vAlpha) * texture2D( texture, gl_PointCoord );\n	\n}",depthTest:!1,blending:THREE.AdditiveBlending,transparent:!0,uniforms:{elapsed:{type:"f"},texture:{type:"t"},color:{type:"c",value:new THREE.Color(e)}},attributes:{size:{type:"f",value:[]},opacity:{type:"f",value:[]}}});return n}function _createGeometry(e,n){for(var t=new THREE.BufferGeometry,r=new Float32Array(3*e.segmentsCount),o=new Float32Array(e.segmentsCount),i=new Float32Array(e.segmentsCount),a=0;a<e.segmentsCount;a++){var s=a/e.segmentsCount;r[3*a+0]=0,r[3*a+1]=s*e.lightLength,r[3*a+2]=0,o[a]=10*n,i[a]=e.brightness*Math.pow(1-s,e.falloff)}return t.addAttribute("position",new THREE.BufferAttribute(r,3)),t.addAttribute("size",new THREE.BufferAttribute(o,1)),t.addAttribute("opacity",new THREE.BufferAttribute(i,1)),t}function _createMeshPromise(e,n,t,r){var o="assets/images/bokeh.png";return LoadTexture(o,r.uniforms.texture,"value").then(function(){var o=new THREE.PointCloud(t,r);return o.position.fromArray(n.position),o.frustumCulled=!1,o.name="lightBeam",e.scene.add(o),o}).then(null,function(){console.log("Could not load the texture for the lightbeam",o)})}function _sizeLightbeamFn(e,n){var t;return function(){if(n.sizeRange!==t){for(var r=0;r<e.array.length;r++){var o=r/e.array.length;e.array[r]=Lerp(n.sizeRange[0],n.sizeRange[1],o)}t=n.sizeRange,e.needsUpdate=!0}}}function _updateFn(e,n,t,r){var o=_sizeLightbeamFn(n.geometry.attributes.size,r),i=_undulateFn(n,t);return function(e){o(e),i(e),n.material.uniforms.elapsed.value=e.elapsed}}function _undulateFn(e,n){var t=n.undulation,r=Random.range(0,2*Math.PI),o=Random.range(0,2*Math.PI);return t?function(n){var i=t.xAmount*Math.sin(r+n.elapsed*t.xSpeed),a=t.zAmount*Math.sin(o+n.elapsed*t.zSpeed);e.rotation.set(i,0,a)}:function(){}}var LoadTexture=require("../../../utils/loadTexture"),Random=require("../../../utils/random"),Lerp=require("lerp");module.exports=function(e,n){var t=_.extend({position:[0,-100,0],segmentsCount:150,lightLength:200,brightness:2,color:13386769,sizeRange:[50,500],falloff:3,undulation:{xAmount:.1*Math.PI,zAmount:.1*Math.PI,xSpeed:8e-4,zSpeed:6e-4}},n),r={sizeRange:_.clone(t.sizeRange)},o=_createMaterial(t.color),i=_createGeometry(t,e.ratio);return _createMeshPromise(e,t,i,o).then(function(n){return e.emitter.on("update",_updateFn(e,n,t,r)),{mesh:n}})};


},{"../../../utils/loadTexture":67,"../../../utils/random":68,"lerp":125}],7:[function(require,module,exports){
"use strict";var LoadTexture=require("../../../utils/loadTexture"),Random=require("../../../utils/random"),internals={createMaterial:function(n,e){var t=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform float elapsed;\nuniform float uRange;\nattribute float size;\nattribute float aOffset;\nvarying float vAlpha;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1_0(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_1_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x) {\n     return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_1_3(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D_1_4 = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_1_5 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_1_5;\n  vec3 i1 = min( g_1_5.xyz, l.zxy );\n  vec3 i2 = max( g_1_5.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D_1_4.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_1_0(i);\n  vec4 p = permute_1_1( permute_1_1( permute_1_1(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D_1_4.wyz - D_1_4.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1_1_6 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0_1_7 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1_1_6.xy,h.z);\n  vec3 p3 = vec3(a1_1_6.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(p0_1_7,p0_1_7), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1_7 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0_1_7,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n\n\n\nvoid main() {\n\n	// vec3 movement = vec3(0.0, elapsed * 0.001, 0.0);\n	vec3 movement = vec3(\n		sin( elapsed * 0.002 * aOffset) * uRange * 0.003,\n		elapsed * (-uRange / 100000.0 - uRange / 100000.0 * aOffset),\n		cos( elapsed * 0.002 * aOffset ) * uRange * 0.003\n	);\n	\n	vec3 range = vec3(uRange, uRange * 0.3, uRange);\n	\n	vec3 cameraOffset = cameraPosition - range;\n	\n	vec3 moduloPosition = mod( position + movement - cameraOffset, range * 2.0 ) + cameraOffset;\n	vec4 mvPosition = modelViewMatrix * vec4( moduloPosition, 1.0 );\n	\n	gl_PointSize = size * ( uRange / (length( mvPosition.xyz ) + 1.0) );\n	\n	float flicker = mix(0.6, 1.0, snoise_1_3( moduloPosition + elapsed * 0.0001 ));\n	\n	vAlpha = 0.5 * min(1.0, max(0.0,\n		1.0 - (length( mvPosition.xyz ) / uRange)\n	)) * flicker;\n\n	gl_Position = projectionMatrix * mvPosition;\n\n}",fragmentShader:"#define GLSLIFY 1\n\nuniform vec3 color;\nuniform sampler2D texture;\nuniform float elapsed;\n\nvarying float vAlpha;\n\nvoid main() {\n\n	gl_FragColor = vec4(color, vAlpha) * texture2D( texture, gl_PointCoord );\n	\n}",blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0,uniforms:{elapsed:{type:"f"},texture:{type:"t"},color:{type:"c",value:n},uRange:{type:"f",value:e}},attributes:{position:{type:"v3"},size:{type:"f"},aOffset:{type:"f"}}});return t},createGeometry:function(n,e,t,r){for(var o=new THREE.BufferGeometry,a=new Float32Array(3*e),i=new Float32Array(e),s=new Float32Array(e),c=0;e>c;c++)a[3*c+0]=Random.range(-t,t),a[3*c+1]=.3*Random.range(-t,t),a[3*c+2]=Random.range(-t,t),i[c]=Random.range(r[0],r[1]),s[c]=Random.range(0,1);return o.addAttribute("position",new THREE.BufferAttribute(a,3)),o.addAttribute("size",new THREE.BufferAttribute(i,1)),o.addAttribute("aOffset",new THREE.BufferAttribute(s,1)),o},createMeshAndStart:function(n,e,t){var r=new THREE.PointCloud(e,t);r.frustumCulled=!1;LoadTexture("assets/images/bokeh.png",t.uniforms.texture,"value").then(function(){n.scene.add(r),n.emitter.on("update",internals.updateFn(n,r))});return r},updateFn:function(n,e){return function(n){e.material.uniforms.elapsed.value=n.elapsed}}};module.exports=function(n,e){{var t=_.extend({count:3e3,color:new THREE.Color(7864319),range:300,sizeRange:[3,8]},e),r=internals.createMaterial(t.color,t.range),o=internals.createGeometry(r,t.count,t.range,t.sizeRange);internals.createMeshAndStart(n,o,r)}return{}};


},{"../../../utils/loadTexture":67,"../../../utils/random":68}],8:[function(require,module,exports){
"use strict";var Eases=require("eases"),Lerp=require("lerp"),internals={updateObjectValue:function(e,n,t,r){var a=(e-t.start)/t.duration;r.obj[r.key]=Lerp(r.values[0],r.values[1],t.easing(a))},updateFunctionValue:function(e,n,t,r){var a=(e-t.start)/t.duration;r.obj[r.key](Lerp(r.values[0],r.values[1],t.easing(a)))},updateObjectValueOnce:function(e,n,t,r){t.start>=n&&t.start<e&&(r.obj[r.key]=r.values)},updateFunctionOnce:function(e,n,t,r){t.start>=n&&t.start<e&&r.obj[r.key](r.values)},updateFn:function(e,n,t,r){var a=0;return function(e){for(var i=e.elapsed/1e3*r%t,u=0;u<n.length;u++){var o=n[u];if(i>=o.start&&i<o.end)for(var s=0;s<o.actions.length;s++){var c=o.actions[s];c.update(i,a,o,c)}}a=i}},easingFn:function e(n){var t,e;if((!n||_.isString(n))&&(t=n||"linear",e=Eases[t]),_.isFunction(n)&&(e=n,0!==e(0)||1!==e(1)))throw new Error("poem-animator received an easing function that didn't return a 0 and 1",n);if(!_.isFunction(e))throw new Error("poem-animator was not able to find the easing function "+n);return e},createAction:function(e,n){var t,r=n[0].split("."),a=r.slice(0,r.length-1),i=_.last(r),u=n[1],o=_.reduce(a,function(e,t){var r=e[t];if(!_.isObject(r))throw new Error("poem-animator was not able to create a reference",n);return r},e);return t=_.isFunction(o[i])?_.isArray(u)?internals.updateFunctionValue:internals.updateFunctionOnce:_.isArray(u)?internals.updateObjectValue:internals.updateObjectValueOnce,{obj:o,key:i,values:u,update:t}},calculateStartEndFn:function(){var e=0;return function(n){var t,r;return _.isNumber(n.start)?(t=n.start,r=t+n.duration):(t=e,r=t+n.duration,e=r),{start:t,end:r}}},isolateFilter:function(e){var n=_.find(e,function(e){return e.isolate});return n?[n]:e},startHereFilter:function(e){var n=_.find(e,function(e){return e.startHere});if(!n)return e;var t=e.indexOf(n);return e.slice(t)},processKeyframeConfig:function(e,n){var t=internals.calculateStartEndFn(),r=_.compose(internals.isolateFilter,internals.startHereFilter);return _.map(r(n),function(n){var r=t(n);return{start:r.start,end:r.end,duration:n.duration,easing:internals.easingFn(n.easing),actions:_.map(n.actions,_.partial(internals.createAction,e))}})},calcMaxTime:function(e,n){return n?_.reduce(e,function(e,n){return Math.max(e,n.end)},0):1/0}};module.exports=function(e,n){var t=_.extend({keyframes:[],loop:!0,speed:1},n);return e.emitter.on("promises",function(){var n=internals.processKeyframeConfig(e,t.keyframes),r=internals.calcMaxTime(n,t.loop);console.log(n),e.emitter.on("update",internals.updateFn(e,n,r,t.speed))}),{}};


},{"eases":107,"lerp":125}],9:[function(require,module,exports){
"use strict";var Camera=function(e,t,i){var o=_.extend({fov:50,near:3,far:1e4,aspectRatio:window.innerWidth/window.innerHeight},e);this.object=new THREE.PerspectiveCamera(o.fov,o.aspect,o.near,o.far),this.object.position.x=_.isNumber(e.x)?e.x:0,this.object.position.y=_.isNumber(e.y)?e.y:0,this.object.position.z=_.isNumber(e.z)?e.z:500,t.add(this.object),i.on("resize",this.resize.bind(this))};module.exports=Camera,Camera.prototype={resize:function(){this.object.aspect=window.innerWidth/window.innerHeight,this.object.updateProjectionMatrix()},setAndUpdateFov:function(e){this.object.fov=e,this.object.updateProjectionMatrix()}};


},{}],10:[function(require,module,exports){
"use strict";var OrbitControls=require("../../vendor/OrbitControls"),Controls=function(t,o){this.poem=t,this.properties=o,this.controls=new OrbitControls(this.poem.camera.object,this.poem.canvas),_.extend(this.controls,o),this.poem.emitter.on("update",this.controls.update.bind(this.controls))};module.exports=Controls;


},{"../../vendor/OrbitControls":71}],11:[function(require,module,exports){
"use strict";var OrbitControls=require("../../vendor/OrbitControls"),DeviceOrientationControls=require("../../vendor/DeviceOrientationControls"),_e;$(window).one("deviceorientation",function(t){_e=t});var Orientation=function(t){this.poem=t,this.camera=this.poem.camera.object,this.controls=new OrbitControls(this.camera,this.poem.canvas),this.controls.rotateUp(Math.PI/4),this.controls.target.set(this.camera.position.x+.1,this.camera.position.y,this.camera.position.z),this.controls.noZoom=!0,this.controls.noPan=!0,this.deviceOrientationHandler=this.setOrientationControls.bind(this),$(window).on("deviceorientation",this.deviceOrientationHandler),this.poem.emitter.on("update",this.update.bind(this)),this.poem.emitter.on("destroy",this.destroy.bind(this)),_e&&this.setOrientationControls(_e)};module.exports=Orientation,Orientation.prototype={setOrientationControls:function(t){this.controls=new DeviceOrientationControls(this.camera,!0),this.controls.connect(),this.controls.update(),$(window).off("deviceorientation",this.deviceOrientationHandler)},update:function(t){this.controls.update()},destroy:function(t){$(window).off("deviceorientation",this.deviceOrientationHandler)}};


},{"../../vendor/DeviceOrientationControls":70,"../../vendor/OrbitControls":71}],12:[function(require,module,exports){
"use strict";var internals={getXRotation:function(){var e=new THREE.Vector3;return function(n,o){return e.set(0,0,1),e.applyQuaternion(n),o&&e.applyQuaternion(o),-Math.atan2(e.y,e.z)}}(),getYRotation:function(){var e=new THREE.Vector3;return function(n,o){return e.set(1,0,0),e.applyQuaternion(n),o&&e.applyQuaternion(o),-Math.atan2(e.z,e.x)}}(),getZRotation:function(){var e=new THREE.Vector3;return function(n,o){return e.set(0,1,0),e.applyQuaternion(n),o&&e.applyQuaternion(o),-Math.atan2(e.x,e.y)}}(),mouseMove:function(e,n,o,t,a){return function(r){r.preventDefault();var u=r.pageX,i=r.pageY,s=n.x-u,m=n.y-i;o.mouseRotation.y+=s*t/(e.canvas.width/e.ratio),o.mouseRotation.x+=m*a/(e.canvas.height/e.ratio),s*t/(e.canvas.width/e.ratio)>1,s*t/(e.canvas.width/e.ratio)<-1,n.x=u,n.y=i}},updateMouseQuaternion:function(){var e=new THREE.Vector3(1,0,0),n=new THREE.Vector3(0,1,0),o=new THREE.Quaternion,t=new THREE.Quaternion;return function(a,r){o.setFromAxisAngle(n,a.mouseRotation.y),t.setFromAxisAngle(e,a.mouseRotation.x),a.mouseQuaternion.copy(a.pathQuaternion),a.mouseQuaternion.multiply(o),a.mouseQuaternion.multiply(t),a.mouseRotation.multiplyScalar(.95*Math.min(1,r.unitDt))}}(),mouseUp:function(e,n){return function(){e.off("mouseleave",n.mouseUp),e.off("mouseup",n.mouseUp),e.off("mousemove",n.mouseMove)}},mouseDown:function(e,n,o){return function(t){t.preventDefault(),o.x=t.pageX,o.y=t.pageY,e.on("mouseleave",n.mouseUp),e.on("mouseup",n.mouseUp),e.on("mousemove",n.mouseMove)}},stopHandlers:function(e,n){return function(){e.off("mouseleave",n.mouseUp),e.off("mouseup",n.mouseUp),e.off("mousemove",n.mouseMove),e.off("mousedown",n.mouseDown)}},startMouseHandlers:function(e,n,o,t,a){{var r={x:0,y:0},u=$(e.canvas),i={};o.mouseQuaternion.copy(n.quaternion)}i.mouseMove=internals.mouseMove(e,r,o,t,a),i.mouseUp=internals.mouseUp(u,i),i.mouseDown=internals.mouseDown(u,i,r),u.on("mousedown",i.mouseDown),e.emitter.on("destroy",internals.stopHandlers(u,i))},updateCameraFn:function(e,n,o){var t=new THREE.Quaternion,a=e.cameraQuaternion,r=e.pathQuaternion,u=e.mouseQuaternion,i=e.rotation;return function(o){r.setFromEuler(i),internals.updateMouseQuaternion(e,o);var s=Math.max(0,THREE.Vector4.prototype.dot.call(r,u));t.copy(r).slerp(u,s),u.copy(t),a.slerp(t,n*o.unitDt)}},rotateAll:function(e,n){console.log("hello"),e.mouseRotation.set(0,0,0),e.rotation.setFromVector3(n),e.cameraQuaternion.setFromEuler(e.rotation),e.pathQuaternion.copy(e.cameraQuaternion),e.mouseQuaternion.copy(e.cameraQuaternion)}};module.exports=function(e,n){var o=_.extend({easing:.05,revertSpeed:2,speedX:1,speedY:.5},n),t={rotation:new THREE.Euler(0,0,0,"ZYX"),mouseRotation:new THREE.Vector3,pathQuaternion:new THREE.Quaternion,mouseQuaternion:new THREE.Quaternion,cameraQuaternion:e.camera.object.quaternion};return internals.startMouseHandlers(e,e.camera.object,t,o.speedX,o.speedY),e.emitter.on("update",internals.updateCameraFn(t,o.easing,o.revertSpeed)),{pathQuaternion:t.pathQuaternion,mouseQuaternion:t.mouseQuaternion,rotation:t.rotation,rotateAll:_.partial(internals.rotateAll,t)}};


},{}],13:[function(require,module,exports){
"use strict";var RotateAroundOrigin=function(o){var t=o.camera.object,i=5e-5,n=t.position.y,r=t.position.z/2;o.emitter.on("update",function(e){o.grid.grid.rotation.y+=e.dt*i,o.pointcloud.object&&(o.pointcloud.object.rotation.y+=e.dt*i),t.position.y=n+200*Math.sin(e.now*i*10),t.position.z=n+Math.sin(e.now*i*10)*r})};module.exports=RotateAroundOrigin,RotateAroundOrigin.prototype={};


},{}],14:[function(require,module,exports){
"use strict";function _generatePositionFn(e){return function(e,t){e[t+0]=.01*Math.random()+3*(Math.cos(.02*t)+.01*Math.cos(.2*t)),e[t+1]=.01*Math.random()+3*(Math.sin(.02*t)+.01*Math.sin(.2*t)),e[t+2]=.01*Math.random()+2+2e-5*-t,e[t+0]+=.1*Math.sin(e[t+2])}}function _initPositioningPass(e,t){var n,r=new THREE.ShaderMaterial({vertexShader:PASS_THROUGH_VERT,fragmentShader:"#define GLSLIFY 1\n\nuniform float textureSideLength;\n\nuniform sampler2D textureCurrPosition;\nuniform sampler2D texturePrevPosition;\n\n\nvoid main() {\n	\n	vec2 uv = gl_FragCoord.xy / textureSideLength;\n	vec4 currPosition = texture2D( textureCurrPosition, uv );\n	vec4 prevPosition = texture2D( texturePrevPosition, uv );\n\n	vec3 velocity = currPosition.xyz - prevPosition.xyz;\n	vec3 toOrigin = normalize(-1.0 * currPosition.xyz);\n	vec3 orientation = normalize( velocity );\n	vec3 newOrientation = normalize( mix( toOrigin, orientation, 0.93 ) );\n	newOrientation += vec3(0.0001, 0.0001, 0.0001);\n	float velocityLength = length( velocity );\n	float toOriginLength = length( currPosition.xyz );\n	\n	gl_FragColor = vec4(\n		currPosition.xyz + newOrientation * 0.02,\n		1.0\n	);\n}",uniforms:{elapsed:{type:"f"},textureSideLength:{type:"f"},textureCurrPosition:{type:"t"},texturePrevPosition:{type:"t"}},attributes:{}});r.name="Boids Position Shader";var i=e.addPass("position",{size:t.count,stride:3,uniformName:"textureCurrPosition",shaderMaterial:r,generateDatum:_generatePositionFn(t),preRender:function(t,r){e.copyTexture(t.outputRenderTarget,n,t.textureSideLength)}});return n=i.renderTargets[0].clone(),n.name="prevPositionTexture",r.uniforms.textureSideLength.value=i.textureSideLength,r.uniforms.texturePrevPosition.value=n,{pass:i,prevPositionTexture:n,shaderMaterial:r}}function _createRenderMaterial(e){var t=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform float elapsed;\n\nuniform float textureSideLength;\nuniform sampler2D textureCurrPosition;\nuniform sampler2D texturePrevPosition;\n\nattribute float attributeIndex;\n\nvarying float vLighting;\nvarying float vAttributeIndex;\n\nvoid main() {\n	\n	vec2 positionLookup = vec2(\n		mod(attributeIndex, textureSideLength),\n		floor(attributeIndex / textureSideLength)\n	) / textureSideLength;\n	\n	vec3 currPosition = texture2D( textureCurrPosition, positionLookup ).xyz;\n	vec3 prevPosition = texture2D( texturePrevPosition, positionLookup ).xyz;\n	\n	float theta = log(attributeIndex) * 8.0;\n	float r = attributeIndex * 2.0;\n	\n	vec4 offset = vec4( r * sin(theta), r * cos(theta), 0.0, 0.0 );\n	\n	vLighting = dot( normal, normalize(cameraPosition - position) );\n	vLighting = vLighting * 0.5 + 0.5;\n	vAttributeIndex = attributeIndex;\n	\n	gl_Position =\n		projectionMatrix *\n		modelViewMatrix * (\n			vec4( position, 1.0 ) + offset * 0.0 + vec4( currPosition * 100.0, 0 )\n		);\n}",fragmentShader:"#define GLSLIFY 1\n\nvarying float vLighting;\nvarying float vAttributeIndex;\n\nfloat hue2rgb_1_0(float f1, float f2, float hue) {\n    if (hue < 0.0)\n        hue += 1.0;\n    else if (hue > 1.0)\n        hue -= 1.0;\n    float res;\n    if ((6.0 * hue) < 1.0)\n        res = f1 + (f2 - f1) * 6.0 * hue;\n    else if ((2.0 * hue) < 1.0)\n        res = f2;\n    else if ((3.0 * hue) < 2.0)\n        res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\n    else\n        res = f1;\n    return res;\n}\n\nvec3 hsl2rgb_1_1(vec3 hsl) {\n    vec3 rgb;\n    \n    if (hsl.y == 0.0) {\n        rgb = vec3(hsl.z); // Luminance\n    } else {\n        float f2;\n        \n        if (hsl.z < 0.5)\n            f2 = hsl.z * (1.0 + hsl.y);\n        else\n            f2 = hsl.z + hsl.y - hsl.y * hsl.z;\n            \n        float f1 = 2.0 * hsl.z - f2;\n        \n        rgb.r = hue2rgb_1_0(f1, f2, hsl.x + (1.0/3.0));\n        rgb.g = hue2rgb_1_0(f1, f2, hsl.x);\n        rgb.b = hue2rgb_1_0(f1, f2, hsl.x - (1.0/3.0));\n    }   \n    return rgb;\n}\n\nvec3 hsl2rgb_1_1(float h, float s, float l) {\n    return hsl2rgb_1_1(vec3(h, s, l));\n}\n\n\n\nvoid main() {\n	\n	gl_FragColor = vec4(\n		hsl2rgb_1_1( mod(0.5 + vAttributeIndex * 0.000002, 1.0), 0.8, 0.5 ),\n		1.0\n	) * vLighting;\n}",uniforms:{elapsed:{type:"f",value:0},textureCurrPosition:{type:"t"},texturePrevPosition:{type:"t"},textureSideLength:{type:"f"}},attributes:{attributeIndex:{type:"f"}}});return t.name="Boids Render Shader",t}function _createGeometry(e){var t=new THREE.BufferGeometry;return t.fromGeometry(new THREE.OctahedronGeometry(3)),DuplicateBufferGeometry(t,e.count),t}function _initRenderingPass(e,t,n){var r=new THREE.Mesh(_createGeometry(e),_createRenderMaterial(e,n));return t.add(r),r}var GpuProcessor=require("../../utils/gpu-processor/gpu-processor"),DuplicateBufferGeometry=require("../../utils/duplicate-buffer-geometry"),CopyTexture=require("../../utils/gpu-processor/copy-texture"),PASS_THROUGH_VERT="void main() { gl_Position = vec4( position, 1.0 ); }";module.exports=function(e,t){var n=_.extend({count:2e5},t),r=GpuProcessor(e.renderer),i=_initPositioningPass(r,n),o=_initRenderingPass(n,e.scene);e.emitter.on("update",function(e){r.render(),o.material.uniforms.textureCurrPosition.value=i.pass.outputRenderTarget,o.material.uniforms.texturePrevPosition.value=i.prevPositionTexture,o.material.uniforms.textureSideLength.value=i.pass.textureSideLength,o.material.uniforms.elapsed.value=e.elapsed})};


},{"../../utils/duplicate-buffer-geometry":62,"../../utils/gpu-processor/copy-texture":63,"../../utils/gpu-processor/gpu-processor":64}],15:[function(require,module,exports){
"use strict";var Touches=require("touches"),EventEmitter=require("events").EventEmitter;module.exports=function(e,t){var n=new THREE.Vector2,o=new THREE.Vector2,i=function(t,i){t.preventDefault(),o.x=2*(i[0]/e.canvas.offsetWidth)-1,o.y=-2*(i[1]/e.canvas.offsetHeight)+1,n.x=i[0],n.y=i[1]},r=Touches(e.canvas,{filtered:!0}).on("start",i).on("move",i).on("end",function(e){n.x=null,n.y=null,o.x=null,o.y=null});return e.emitter.on("destroy",function(){r.disable()}),{emitter:r,pixelPosition:n,normalizedPosition:o}};


},{"events":196,"touches":190}],16:[function(require,module,exports){
"use strict";var TrackCameraLights=function(e,t){this.lights=[];var i=new THREE.AmbientLight(1118481,1,0);i.position.set(0,2e3,1e3);var a=(new THREE.PointLight(16777215,.3,0),new THREE.PointLight(16777215,1,0));a.position.set(3e3,2e3,5e3);var o=new THREE.PointLight(16777215,1,0);o.position.set(-1e3,-1e3,-1e3);var n=new THREE.PointLight(16777215,2,0);n.position.set(-700,500,-1e3),e.scene.add(i),e.camera.object.add(a),e.camera.object.add(o),e.camera.object.add(n)};module.exports=TrackCameraLights,TrackCameraLights.prototype={};


},{}],17:[function(require,module,exports){
"use strict";function _loadTreePromise(){return new Promise(function(e,r){if(statics.tree)return void e(statics.tree);var t=new THREE.AssimpJSONLoader,i=function(r){_updateMaterials(r),statics.tree=r,e(r)},n=function(){};t.load("./js/components/models/tree.json",i,n,r)})}function _updateMaterials(e){e.material&&(e.material.side=THREE.DoubleSide,e.material.shading=THREE.SmoothShading,e.material.specular=new THREE.Color(5592405),e.material.shininess=1);for(var r=0;r<e.children.length;r++)_updateMaterials(e.children[r])}var AssimpJSONLoader=require("../../vendor/AssimpJSONLoader"),statics={tree:null};module.exports=function(e,r){var t=_.extend({position:[0,0,0],scale:[10,10,10]},r),i=new THREE.SphereGeometry(20,32,32),n=new THREE.MeshPhongMaterial({color:16776960}),a=new THREE.Mesh(i,n);return a.position.x=20,e.scene.add(a),_loadTreePromise().then(function(r){return e.scene.add(r),r.position.fromArray(t.position),r.scale.fromArray(t.scale),window.tree=r.children[0].children[0],r})};


},{"../../vendor/AssimpJSONLoader":69}],18:[function(require,module,exports){
"use strict";var MrDoobStats=require("../../vendor/Stats"),Stats=function(t){this.poem=t,this.stats=new MrDoobStats,this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",$(this.poem.div).append(this.stats.domElement),this.poem.emitter.on("update",this.stats.update.bind(this.stats))};module.exports=Stats;


},{"../../vendor/Stats":72}],19:[function(require,module,exports){
"use strict";function _getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}var Lerp=require("lerp");module.exports=function(e,t){var n=_.extend({distance:.1,resetSpeed:.05,center:e.camera.object.position.clone()},t),r={center:n.center.clone()};e.canvas.addEventListener(_getWheelEventName(),function(e){r.center.y+=n.distance*-e.deltaY,r.center.x+=n.distance*e.deltaX*5},!1),e.emitter.on("update",function(){r.center.y=Lerp(r.center.y,n.center.y,n.resetSpeed),r.center.x=Lerp(r.center.x,n.center.x,n.resetSpeed),r.center.z=Lerp(r.center.z,n.center.z,n.resetSpeed),e.camera.object.position.copy(r.center)})};


},{"lerp":125}],20:[function(require,module,exports){
"use strict";var createManifestLoader=require("poem-manifests"),EventEmitter=require("events").EventEmitter,_emitter=new EventEmitter,_loader=null,init=function(e,t){_loader=createManifestLoader(t,{emitter:_emitter,getGraph:function(t,r){return e(t,_emitter)},globalManifest:{}}),_emitter.on("load",function(e){window.poem=e.graph})},load=function(e){return _loader.load(e)};module.exports={init:init,load:load,emitter:_emitter};


},{"events":196,"poem-manifests":149}],21:[function(require,module,exports){
"use strict";function _createFog(e,o,r){var t=_.extend({color:2236962,nearFactor:.5,farFactor:2},o);e.fog=new THREE.Fog(t.color,r*t.nearFactor,r*t.farFactor)}function _startAfterPromises(e){var o=_.map(e,function(e){return _.isObject(e)?e.promise:void 0}),r=_.filter(o,function(e){return!_.isUndefined(e)});Promise.all(r).then(function(){e.emitter.emit("promises"),e.loop.start()},console.log.bind(console))}var Camera=require("../components/cameras/Camera"),CreateLoop=require("poem-loop"),RATIO=_.isNumber(window.devicePixelRatio)?window.devicePixelRatio:1;module.exports=function(e,o){var r=_.extend({camera:null,fog:null,renderer:null},e.config),t={},n=CreateLoop(),a=n.emitter,i=new THREE.Scene,c=new Camera(r.camera,i,a);return _createFog(i,r.fog,c.object.position.z),o.once("load",_.partial(_startAfterPromises,t)),o.on("unload",function(){n.stop(),a.emit("destroy")}),_.extend(t,{emitter:a,canvas:null,scene:i,ratio:RATIO,camera:c,$div:$("#container"),loop:n,start:n.start,stop:n.stop})};


},{"../components/cameras/Camera":9,"poem-loop":135}],22:[function(require,module,exports){
"use strict";var crossroads=require("crossroads"),hasher=require("hasher"),manifestToPoem=require("./manifestToPoem"),_baseUrl="/sandbox",_defaultLevel,routing={start:function(e,a){function s(e,a){crossroads.parse(e)}_defaultLevel=_.first(_.keys(a)),manifestToPoem.init(e,a),crossroads.addRoute("/",routing.showMainTitles),crossroads.addRoute("/{name}",routing.loadUpALevel),crossroads.addRoute(/.*/,function(){hasher.replaceHash("")}),hasher.initialized.add(s),hasher.changed.add(s),hasher.init()},showMainTitles:function(){_gaq.push(["_trackPageview",_baseUrl]),manifestToPoem.load(_defaultLevel)},loadUpALevel:function(e){_gaq.push(["_trackPageview",_baseUrl+"/#level/"+e]);var a=manifestToPoem.load(e);a||manifestToPoem.load(_defaultLevel)}};module.exports=routing;


},{"./manifestToPoem":20,"crossroads":86,"hasher":123}],23:[function(require,module,exports){
"use strict";function handlers(e){var o;manifestToPoem.emitter.on("load",function(e){o=e.graph}),e.emitter.on("close",function(){o&&o.start()}),e.emitter.on("open",function(){o&&o.stop()})}var poemMenu=require("poem-menu"),routing=require("./routing"),mute=require("../sound/mute"),manifestToPoem=require("./manifestToPoem");window.mute=mute,module.exports=function(e){var o=poemMenu(e,{top:"Three.js Sandbox",bottom:mute.el});handlers(o)};


},{"../sound/mute":58,"./manifestToPoem":20,"./routing":22,"poem-menu":171}],24:[function(require,module,exports){
"use strict";var random=require("../utils/random"),loadTexture=require("../utils/loadTexture"),destroyMesh=require("../utils/destroyMesh"),mute=require("../sound/mute"),Earth=function(t,e){this.poem=t,this.geometry=null,this.material=null,this.mesh=null,this.texture=null,$("#LevelSelect").hide(),this.radius=e.radius>0?e.radius:250,this.$a=$("<a href='http://svs.gsfc.nasa.gov/cgi-bin/details.cgi?aid=11719'></a>"),this.$a.append($("<img class='nasa-logo wide' src='assets/images/nasa-goddard.png' />")),this.$a.attr("title","Map visualization credit to NASA's Goddard Space Flight Center"),this.poem.$div.append(this.$a),this.poem.emitter.on("destroy",this.destroy.bind(this)),this.start()};module.exports=Earth,Earth.prototype={start:function(){this.createTexture(),this.geometry=new THREE.SphereGeometry(this.radius,64,64),this.material=new THREE.MeshPhongMaterial({map:this.texture,shininess:25,specular:1118481}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.poem.scene.add(this.mesh),this.poem.emitter.on("update",this.update.bind(this))},createTexture:function(){this.video=document.createElement("video"),this.$video=$(this.video),this.video.controls=!0,this.video.loop=!0,this.video.muted=mute.muted(),mute.emitter.on("change",function(t){this.video.muted=t}.bind(this)),this.video.src=this.video.canPlayType("video/mp4")?"assets/video/earthco2-large.mp4":"assets/video/earthco2.webm",this.video.load(),this.video.play(),this.canvas=document.createElement("canvas"),this.canvas.width=1920,this.canvas.height=960,this.ctx2d=this.canvas.getContext("2d"),this.ctx2d.fillStyle="#000000",this.ctx2d.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new THREE.Texture(this.canvas),this.texture.minFilter=THREE.LinearFilter,this.texture.magFilter=THREE.LinearFilter},error:function(){},update:function(t){this.video.readyState===this.video.HAVE_ENOUGH_DATA&&(this.ctx2d.drawImage(this.video,0,0),this.texture&&(this.texture.needsUpdate=!0)),this.mesh.rotation.y+=5e-5*t.dt},destroy:function(){this.$a.remove(),this.video.pause(),destroyMesh(this.mesh),this.texture.dispose()}};


},{"../sound/mute":58,"../utils/destroyMesh":61,"../utils/loadTexture":67,"../utils/random":68}],25:[function(require,module,exports){
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(c){a=!0,o=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(a)throw o}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},LoadImage=require("../../utils/loadImage"),internals={createTexture:function(e){var t=document.createElement("canvas");t.width=1024,t.height=256;var r=t.getContext("2d"),n=new THREE.Texture(t);return n.minFilter=THREE.LinearFilter,n.magFilter=THREE.LinearFilter,[t,r,n]},createVideo:function(){return new Promise(function(e,t){{var r=document.createElement("video");$(r)}r.controls=!1,r.loop=!1,r.src=r.canPlayType("video/mp4")?"assets/video/gene.sys.mp4":"assets/video/gene.sys.webm",r.load(),$(r).on("canplaythrough",function(){e(r)}),$(r).on("error, stalled, abort",function(e){t(e.originalEvent)})})},createMesh:function(e,t,r){var n=new THREE.Mesh(new THREE.PlaneGeometry(r.width,r.height),new THREE.MeshBasicMaterial({color:16777215,transparent:!0,side:THREE.DoubleSide,alphaMap:t}));return n},updateFn:function(e,t,r,n){return function(){r.readyState===r.HAVE_ENOUGH_DATA&&r.ended===!1&&(t.drawImage(r,0,0),n.needsUpdate=!0)}},add:function(e,t,r,n){t.scale.set(.005,.005,.005),t.position.z=-10,t.position.y=.2,e.add(t),setTimeout(function(){console.warn("TODO: remove setTimeout"),r.currentTime=0,r.play(),poem.emitter.on("update",n)},2e3)},remove:function(e,t,r,n){e.remove(t),r.pause(0),poem.emitter.removeListener("update",n)}};module.exports=function(e){var t={promise:internals.createVideo()};return t.promise.then(function(r){var n=internals.createTexture(r),a=_slicedToArray(n,3),o=a[0],i=a[1],s=a[2],c=internals.createMesh(e,s,o),u=internals.updateFn(c,i,r,s);_.extend(t,{mesh:c,canvas:o,ctx2d:i,texture:s,video:r,add:_.partial(internals.add,e.camera.object,c,r,u),remove:_.partial(internals.remove,e.camera.object,c,r,u)})}),t};


},{"../../utils/loadImage":65}],26:[function(require,module,exports){
"use strict";function createGeometry(e,n){var t=new THREE.PlaneGeometry(e,e,n,n);return t.applyMatrix((new THREE.Matrix4).makeRotationX(.5*Math.PI)),t}function createTexture(e,n){var t=new Image,i=new THREE.Texture(t);return t.src="assets/images/cloud1024.png",i.wrapT=THREE.RepeatWrapping,i.wrapS=THREE.RepeatWrapping,$(t).on("load",function(){i.needsUpdate=!0,n.add(e)}),i}function updateShader(){}function createMeshGrid(e,n,t,i){for(var o,r=createGeometry(n/t,Math.floor(i/t)),a=new THREE.Object3D,h=n/t,c=0;t>c;c++)for(var s=0;t>s;s++)o=new THREE.Mesh(r,e),o.frustumCulled=!1,a.add(o),o.position.set(c*h,0,s*h);return a}function updateModuloMeshGrid(e,n,t,i){var o=n.length,r=t/2;return function(){for(var i,a=0;o>a;a++)i=n[a].position,i.set((i.x-e.x+r)%t+e.x-r,i.y,(i.z-e.z+r)%t+e.z-r)}}var EndlessTerrain=function(e,n){var t=_.extend({width:4e3,heightScale:200,gridLength:16,totalPolygonDensity:1024,positionY:0,height:1},n),i={height:t.height},o=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform sampler2D terrain;\nuniform float heightFactor;\nuniform float width;\n\nvarying float height;\nvarying vec2 vUv;\nvarying float vCameraDistance;\n\nvoid main() {\n\n	vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n	\n	vUv = vec2( modelPosition.x, modelPosition.z ) / width;\n\n	height = texture2D( terrain, vUv * 0.3 ).w;\n	\n	vCameraDistance = distance( modelPosition.xyz, cameraPosition );\n	\n	\n	vec4 modifiedPosition = vec4(\n		position.x,\n		position.y + height * width / 20.0 * heightFactor,\n		position.z,\n		1.0\n	);\n	\n	gl_Position = projectionMatrix * modelViewMatrix * modifiedPosition;\n	\n}",fragmentShader:"#define GLSLIFY 1\n\nvec3 hsv2rgb_1_0(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n\n\nuniform float width;\nuniform float heightFactor;\n\nvarying float height;\nvarying vec2 vUv;\nvarying float vCameraDistance;\n\nvoid main() {\n	\n	float hueX = abs(0.5 - fract(vUv.x * 0.8)) * 2.0;\n	float hueY = abs(0.5 - fract(vUv.y * 0.63)) * 2.0;\n	\n    gl_FragColor = vec4(\n		hsv2rgb_1_0(\n			vec3(\n				// mod(xHue, 1.0),\n				(hueX + hueY) * 0.2 + 0.3,\n				mix(heightFactor, mix(height, 0.5, 0.8), 0.8),\n				mix(heightFactor, mix(height, 1.2, 0.35), 0.35)\n			)\n		),\n		1.0\n	);\n	\n	float fogFactor = smoothstep( 0.0, 1.0, vCameraDistance / width );\n	vec3 fogColor = vec3( 0.14, 0.14, 0.14 );\n\n	gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n	\n}",side:THREE.DoubleSide,uniforms:{terrain:{type:"t"},heightFactor:{type:"f"},width:{type:"f"}},attributes:{}});o.side=THREE.DoubleSide;var r=createMeshGrid(o,t.width,t.gridLength,t.totalPolygonDensity);return r.position.y=t.positionY,o.uniforms.terrain.value=createTexture(r,e.scene),o.uniforms.width.value=t.width/2,o.uniforms.height=i.height,e.emitter.on("update",function(){o.uniforms.heightFactor.value=i.height}),e.emitter.on("update",updateModuloMeshGrid(e.camera.object.position,r.children,t.width,i)),i};module.exports=EndlessTerrain;


},{}],27:[function(require,module,exports){
"use strict";var CubicBezier=require("cubic-bezier"),QuickIn=CubicBezier(.12,.51,.8,.85,32),Pi=Math.PI,HalfPi=Math.PI/2;module.exports={loop:!0,speed:1,keyframes:[{duration:15,easing:QuickIn,actions:[["camera.object.position.x",[0,0]],["camera.object.position.y",[-250,0]],["camera.object.position.z",[0,-5e3]],["camera.setAndUpdateFov",[5,30]],["endlessTerrain.height",[0,1]],["restrictedCamera.rotation.x",[-.3,0]],["restrictedCamera.rotation.y",[-.3,.1]],["restrictedCamera.rotateAll",{x:-.3,y:-.3,z:0}],["credits.mesh.position.z",[-30,-10]],["credits.add",{}]]},{duration:10,easing:"linear",isolate:!1,startHere:!1,actions:[["credits.remove",{}],["camera.object.position.x",[0,0]],["camera.object.position.y",[0,0]],["camera.object.position.z",[-5e3,-5700]],["camera.setAndUpdateFov",[70,40]],["restrictedCamera.rotateAll",{x:-.1,y:HalfPi,z:0}]]},{duration:13,easing:"linear",isolate:!1,actions:[["camera.object.position.x",600],["camera.object.position.y",[0,0]],["camera.object.position.z",[-5700,-6e3]],["camera.setAndUpdateFov",[100,50]],["restrictedCamera.rotateAll",{x:.5*-Pi,y:0,z:0}],["restrictedCamera.rotation.x",[.5*-Pi,0]]]},{duration:10,easing:"linear",isolate:!1,actions:[["camera.object.position.x",600],["camera.object.position.y",[0,0]],["camera.object.position.z",[-5700,-6400]],["restrictedCamera.rotateAll",{x:0,y:Pi,z:0}]]}]};


},{"cubic-bezier":88}],28:[function(require,module,exports){
"use strict";var random=require("../utils/random"),Grid=function(e,r){this.poem=e;for(var i=new THREE.LineBasicMaterial({color:3158064}),s=new THREE.Geometry,t=-75,E=25,n=0;40>=n;n++)s.vertices.push(new THREE.Vector3(-500,t,n*E-500)),s.vertices.push(new THREE.Vector3(500,t,n*E-500)),s.vertices.push(new THREE.Vector3(n*E-500,t,-500)),s.vertices.push(new THREE.Vector3(n*E-500,t,500));this.grid=new THREE.Line(s,i,THREE.LinePieces),this.poem.scene.add(this.grid)};module.exports=Grid;


},{"../utils/random":68}],29:[function(require,module,exports){
"use strict";var calculateSquaredTextureWidth=require("../../utils/calculateSquaredTextureWidth"),loadTexture=require("../../utils/loadTexture"),loadText=require("../../utils/loadText"),MeshGroup=function(e){THREE.Object3D.call(this),this.poem=e,this.type="MeshGroup",this.bufferGeometry=new THREE.BufferGeometry,this.matricesTextureWidth=null,this.matricesData=null,this.matrixIndices=null,this.texture=null,this.vertexShader=null,this.fragmentShader=null,this.loaded=Promise.all([loadTexture("assets/images/sinegravitycloud.png",this,"texture"),loadText("js/demos/MeshGroupBoxDemo/shader.vert",this,"vertexShader"),loadText("js/demos/MeshGroupBoxDemo/shader.frag",this,"fragmentShader")])["catch"](function(e){throw new Error("Could not load assets for the MeshGroup",e)})};MeshGroup.prototype=_.extend(Object.create(THREE.Object3D.prototype),{build:function(e){this.loaded.then(function(){this.buildGeometry(),this.buildMatrices(),this.buildMaterial(),this.object=new THREE.PointCloud(this.bufferGeometry,this.material),e.add(this.object),this.poem.emitter.on("update",this.update.bind(this))}.bind(this))},buildGeometry:function(){var e,t,r,i,s,a=new THREE.Geometry,h=[];for(t=0,r=this.children.length;r>t;t++)if(e=this.children[t].geometry)for(a.merge(e),i=a.vertices.length-e.vertices.length,s=a.vertices.length;s>i;i++)h[i]=t;this.bufferGeometry.fromGeometry(a)},generateTransformMatrixIndices:function(e){var t,r,i,s,a,h,u=[],n=0;for(i=0,s=e.length;s>i;i++)if(r=e[i].geometry)for(t=3*r.faces.length,n+=t,a=n-t,h=n;h>a;a++)u[a]=i;return new Float32Array(u)},buildMatrices:function(){this.matricesTextureWidth=calculateSquaredTextureWidth(16*this.children.length),this.matricesData=new Float32Array(this.matricesTextureWidth*this.matricesTextureWidth*4),this.matricesTexture=new THREE.DataTexture(this.matricesData,this.matricesTextureWidth,this.matricesTextureWidth,THREE.RGBAFormat,THREE.FloatType),this.matricesTexture.minFilter=THREE.NearestFilter,this.matricesTexture.magFilter=THREE.NearestFilter,this.matricesTexture.generateMipmaps=!1,this.matricesTexture.flipY=!1,this.matricesTexture.needsUpdate=!0},buildMaterial:function(){this.attributes={transformMatrixIndex:{type:"f",value:null}},this.matrixIndices=this.generateTransformMatrixIndices(this.children),this.bufferGeometry.addAttribute("transformMatrixIndex",new THREE.BufferAttribute(this.matrixIndices,1)),this.uniforms={color:{type:"c",value:new THREE.Color(16711680)},matricesTexture:{type:"t",value:this.matricesTexture},time:{type:"f",value:Date.now()},texture:{type:"t",value:this.texture},matricesTextureWidth:{type:"f",value:this.matricesTextureWidth}},this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,attributes:this.attributes,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0})},update:function(){for(var e=0,t=this.children.length;t>e;e++)this.children[e].matrix.flattenToArrayOffset(this.matricesData,16*e),this.matricesTexture.needsUpdate=!0}}),module.exports=MeshGroup;


},{"../../utils/calculateSquaredTextureWidth":60,"../../utils/loadText":66,"../../utils/loadTexture":67}],30:[function(require,module,exports){
"use strict";var MeshGroup=require("./MeshGroup"),random=require("../../utils/random"),twoPi=2*Math.PI,MeshGroupBoxDemo=function(o,t){this.poem=o,this.count=1e4,this.poem.emitter.on("update",this.update.bind(this)),this.group=new MeshGroup(o),this.boxes=this.generateBoxes(this.group),this.group.build(o.scene)};module.exports=MeshGroupBoxDemo,MeshGroupBoxDemo.prototype={generateBoxes:function(o){for(var t,e=[],r=(new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:65280}),this.count);r--;)t=new THREE.Mesh(new THREE.BoxGeometry(1,1,1)),t.position.x=random.range(-100,100),t.position.y=random.range(-100,100),t.position.z=random.range(-100,100),t.rotation.x=random.range(-twoPi,twoPi),t.rotation.y=random.range(-twoPi,twoPi),t.rotation.z=random.range(-twoPi,twoPi),t.velocity=new THREE.Vector3(random.range(-1,1),random.range(-1,1),random.range(-1,1)).multiplyScalar(.1),t.spin=new THREE.Vector3(random.range(-twoPi,twoPi),random.range(-twoPi,twoPi),random.range(-twoPi,twoPi)).multiplyScalar(.01),t.scale.multiplyScalar(random.range(1,2)),t.updateMatrix(),e.push(t),o.add(t);return e},update:function(o){for(var t,e=0;e<this.count;e++)t=this.boxes[e],t.position.add(t.velocity),t.rotation.x+=t.spin.x,t.rotation.y+=t.spin.y,t.rotation.z+=t.spin.z,t.updateMatrix()}};


},{"../../utils/random":68,"./MeshGroup":29}],31:[function(require,module,exports){
"use strict";var random=require("../utils/random"),loadTexture=require("../utils/loadTexture"),loadText=require("../utils/loadText"),SineGravityCloud=function(t,i){this.poem=t,this.object=null,this.material=null,this.attributes=null,this.uniforms=null,this.texture=null,this.vertexShader=null,this.fragmentShader=null,this.count=2e5,this.radius=200,this.pointSize=7,_.extend(this,i),Promise.all([loadTexture("assets/images/sinegravitycloud.png",this,"texture"),loadText("assets/shaders/sinegravitycloud.vert",this,"vertexShader"),loadText("assets/shaders/sinegravitycloud.frag",this,"fragmentShader")]).then(this.start.bind(this),this.error.bind(this))};module.exports=SineGravityCloud,SineGravityCloud.prototype={start:function(){this.attributes={size:{type:"f",value:null},customColor:{type:"c",value:null}},this.uniforms={color:{type:"c",value:new THREE.Color(16777215)},texture:{type:"t",value:this.texture}},this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,attributes:this.attributes,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0}),this.geometry=new THREE.BufferGeometry,this.positions=new Float32Array(3*this.count),this.velocity=new Float32Array(3*this.count),this.colors=new Float32Array(3*this.count),this.sizes=new Float32Array(this.count);for(var t,i,s=new THREE.Color(0),e=0;e<this.count;e++)this.sizes[e]=this.pointSize,i=random.range(-1,1),this.positions[3*e+0]=i*this.radius,this.positions[3*e+1]=Math.sin(i*Math.PI*10)*this.radius,this.positions[3*e+2]=this.radius*-.5,this.velocity[3*e+0]=0*random.range(-.01,.01),this.velocity[3*e+1]=10*random.range(-.01,.01),this.velocity[3*e+2]=0*random.range(-.01,.01),t=.3*i+.65,s.setHSL(t,1,.55),this.colors[3*e+0]=s.r,this.colors[3*e+1]=s.g,this.colors[3*e+2]=s.b;this.geometry.addAttribute("position",new THREE.BufferAttribute(this.positions,3)),this.geometry.addAttribute("customColor",new THREE.BufferAttribute(this.colors,3)),this.geometry.addAttribute("size",new THREE.BufferAttribute(this.sizes,1)),this.object=new THREE.PointCloud(this.geometry,this.material),this.object.position.y-=.2*this.radius,this.poem.scene.add(this.object),this.object.scale.multiplyScalar(1.5),this.poem.emitter.on("update",this.update.bind(this))},error:function(t){function i(i){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(t){throw new Error("Could not load assets for the SineGravityCloud",t)}),update:function(t){for(var i,s=Math.cos(5e-5*t.now*1),e=Math.cos(5e-5*t.now*2),o=Math.cos(5e-5*t.now*3),r=0;r<this.count;r++)i=this.positions[3*r+0]*this.positions[3*r+0]+this.positions[3*r+1]*this.positions[3*r+1]+this.positions[3*r+2]*this.positions[3*r+2],this.velocity[3*r+0]-=s*this.positions[3*r+0]/i,this.velocity[3*r+1]-=e*this.positions[3*r+1]/i,this.velocity[3*r+2]-=o*this.positions[3*r+2]/i,this.positions[3*r+0]+=s*this.velocity[3*r+0],this.positions[3*r+1]+=e*this.velocity[3*r+1],this.positions[3*r+2]+=o*this.velocity[3*r+2];this.geometry.attributes.position.needsUpdate=!0}};


},{"../utils/loadText":66,"../utils/loadTexture":67,"../utils/random":68}],32:[function(require,module,exports){
"use strict";var Random=require("../utils/random"),lerp=require("lerp"),internals={createMeshes:function(e,n,o,t){for(var i=[],r=0;r<t.count;r++){var a=new THREE.Mesh(n,o);a.position.x=Random.range(-t.dispersion,t.dispersion),a.position.y=Random.range(-t.dispersion,t.dispersion),a.position.z=Random.range(-t.dispersion,t.dispersion),a.rotation.x=Random.range(-Math.PI,Math.PI),a.rotation.y=Random.range(-Math.PI,Math.PI),a.rotation.z=Random.range(-Math.PI,Math.PI),a.velocity=t.velocity,a.flee=1,a.direction=new THREE.Vector3(Random.range(-1,1),Random.range(-1,1),Random.range(-1,1)),a.direction.normalize(),r>0&&(a.target=i[r-1].position),e.add(a),i.push(a)}return i[0].target=i[i.length-1].position,i},physicsMotionFn:function(e,n){var o=new THREE.Vector3;return function(t){for(var i=0;i<e.length;i++){var r=e[i];o.subVectors(r.target,r.position),o.normalize(),r.direction.lerp(o,n.turnSpeed*t.unitDt),r.flee=lerp(r.flee,1,n.fleeSlowdown),r.position.x+=r.direction.x*r.velocity*r.flee*t.unitDt,r.position.y+=r.direction.y*r.velocity*r.flee*t.unitDt,r.position.z+=r.direction.z*r.velocity*r.flee*t.unitDt}}},brownianMotionFn:function(e,n){return function(o){for(var t=0;t<e.length;t++)e[t].position.x+=Random.range(-5e-4,5e-4)*n*o.dt,e[t].position.y+=Random.range(-5e-4,5e-4)*n*o.dt,e[t].position.z+=Random.range(-5e-4,5e-4)*n*o.dt}},raycastFn:function(e,n,o,t){var i=new THREE.Raycaster;return function(r){i.setFromCamera(n,o);for(var a=0;a<e.length;a++){var s=e[a],d=i.ray.distanceToPoint(s.position);d<t.mouseRange&&(s.flee+=t.fleeSpeed*(t.mouseRange-d)/t.mouseRange)}}}};module.exports=function(e,n){var o=_.extend({count:10,dispersion:10,radius:1,mouseRef:"mouse",velocity:5,turnSpeed:.025,fleeSlowdown:.1,mouseRange:50,fleeSpeed:1},n),t=new THREE.TetrahedronGeometry(o.radius,0),i=new THREE.MeshLambertMaterial({color:52275,shading:THREE.FlatShading,fog:!1}),r=internals.createMeshes(e.scene,t,i,o),a=e[o.mouseRef];e.emitter.on("update",internals.physicsMotionFn(r,o)),e.emitter.on("update",internals.raycastFn(r,a.normalizedPosition,e.camera.object,o))};


},{"../utils/random":68,"lerp":125}],33:[function(require,module,exports){
"use strict";function _createGeometry(n,e){var t=new THREE.PlaneGeometry(n,n,e,e);return t.applyMatrix((new THREE.Matrix4).makeRotationX(.5*Math.PI)),t}function _createTexture(n,e){var t=new Image,o=new THREE.Texture(t);return t.src="assets/images/cloud1024.png",o.wrapT=THREE.RepeatWrapping,o.wrapS=THREE.RepeatWrapping,$(t).on("load",function(){o.needsUpdate=!0,e.add(n)}),o}function _createMeshGrid(n,e,t,o){for(var i,a=_createGeometry(e/t,Math.floor(o/t)),r=new THREE.Object3D,s=e/t,c=0;t>c;c++)for(var v=0;t>v;v++)i=new THREE.Mesh(a,n),i.frustumCulled=!1,r.add(i),i.position.set(c*s,0,v*s);return r}function _updateModuloMeshGrid(n,e,t,o){var i=e.length,a=t/2;return function(){for(var o,r=0;i>r;r++)o=e[r].position,o.set((o.x-n.x+a)%t+n.x-a,o.y,(o.z-n.z+a)%t+n.z-a)}}module.exports=function(n,e){var t=_.extend({width:8e3,heightScale:200,gridLength:16,totalPolygonDensity:256,positionY:0,height:1},e),o={height:t.height},i=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nuniform sampler2D terrain;\nuniform float heightFactor;\nuniform float width;\nuniform float elapsed;\n\nvarying float height;\nvarying vec2 vUv;\nvarying float vCameraDistance;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1_0(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_1_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x) {\n     return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_1_3(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D_1_4 = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_1_5 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_1_5;\n  vec3 i1 = min( g_1_5.xyz, l.zxy );\n  vec3 i2 = max( g_1_5.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D_1_4.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_1_0(i);\n  vec4 p = permute_1_1( permute_1_1( permute_1_1(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D_1_4.wyz - D_1_4.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1_1_6 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0_1_7 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1_1_6.xy,h.z);\n  vec3 p3 = vec3(a1_1_6.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(p0_1_7,p0_1_7), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1_7 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0_1_7,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n\n\n\nvoid main() {\n\n	vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n	\n	vUv = vec2( modelPosition.x, modelPosition.z + elapsed * 0.05 ) / width;\n		\n	float mainHeightShape = texture2D( terrain, vUv * 0.3 ).w;\n	float smallNoiseySurface = texture2D( terrain, vUv * 5.0 ).w;\n	float amountOfSmallNoise = snoise_1_3(vec3(\n		modelPosition.x * 0.001 * sin( elapsed * 0.001 ),\n		modelPosition.z * 0.001 * sin( elapsed * 0.001 ),\n		elapsed * 0.0001\n	));\n	\n	height = mainHeightShape + (\n		smallNoiseySurface * smallNoiseySurface * amountOfSmallNoise\n	);\n	\n	vCameraDistance = distance( modelPosition.xyz, cameraPosition );\n	\n	vec4 modifiedPosition = vec4(\n		position.x,\n		position.y + height * width / 20.0 * heightFactor,\n		position.z,\n		1.0\n	);\n	\n	gl_Position = projectionMatrix * modelViewMatrix * modifiedPosition;\n	\n}",fragmentShader:"#define GLSLIFY 1\n\nvec3 hsv2rgb_1_0(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n\n\nuniform float width;\nuniform float heightFactor;\nuniform float elapsed;\n\nvarying float height;\nvarying vec2 vUv;\nvarying float vCameraDistance;\n\nvoid main() {\n	\n	float hueX = abs(0.5 - fract(vUv.x * 2.0)) * 2.0;\n	float hueY = abs(0.5 - fract(vUv.y * 2.0)) * 2.0;\n	\n	float waveSpeed = 0.0005;\n	float waveLength = 0.0001;\n	float wave = mod((vCameraDistance * waveLength + elapsed * waveSpeed), 1.0);\n	\n    gl_FragColor = vec4(\n		hsv2rgb_1_0(\n			vec3(\n				// mod(xHue, 1.0),\n				(hueX + hueY) * 0.1 + 0.25,\n				mix(heightFactor, mix(height, 0.5, 0.8), 0.8),\n				mix(heightFactor, mix(height, 1.2, 0.35), 0.35)\n			)\n		),\n		1.0 - wave + 0.2\n	);\n	\n	float fogFactor = smoothstep( 0.0, 1.0, vCameraDistance / width );\n	vec3 fogColor = vec3( 0.14, 0.14, 0.14 );\n\n	gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n	\n}",side:THREE.DoubleSide,wireframe:!0,transparent:!0,uniforms:{terrain:{type:"t"},heightFactor:{type:"f"},width:{type:"f"},elapsed:{type:"f"}},attributes:{}}),a=_createMeshGrid(i,t.width,t.gridLength,t.totalPolygonDensity);return a.position.y=t.positionY,i.uniforms.terrain.value=_createTexture(a,n.scene),i.uniforms.width.value=t.width/2,i.uniforms.height=o.height,n.emitter.on("update",function(n){i.uniforms.heightFactor.value=o.height,i.uniforms.elapsed.value=n.elapsed}),n.emitter.on("update",_updateModuloMeshGrid(n.camera.object.position,a.children,t.width,o)),o};


},{}],34:[function(require,module,exports){
"use strict";require("./utils/ThreeConsole"),require("es6-promise").polyfill();var manifests=require("../manifests"),routing=require("./core/routing"),ui=require("./core/ui")(manifests);routing.start(require("./core/poem"),manifests);


},{"../manifests":79,"./core/poem":21,"./core/routing":22,"./core/ui":23,"./utils/ThreeConsole":59,"es6-promise":121}],35:[function(require,module,exports){
"use strict";THREE.BloomPass=function(e,r,o,n){e=void 0!==e?e:1,r=void 0!==r?r:25,o=void 0!==o?o:4,n=void 0!==n?n:256;var t={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat};this.renderTargetX=new THREE.WebGLRenderTarget(n,n,t),this.renderTargetY=new THREE.WebGLRenderTarget(n,n,t),void 0===THREE.CopyShader&&console.error("THREE.BloomPass relies on THREE.CopyShader");var i=THREE.CopyShader;this.copyUniforms=THREE.UniformsUtils.clone(i.uniforms),this.copyUniforms.opacity.value=e,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,blending:THREE.AdditiveBlending,transparent:!0}),void 0===THREE.ConvolutionShader&&console.error("THREE.BloomPass relies on THREE.ConvolutionShader");var a=THREE.ConvolutionShader;this.convolutionUniforms=THREE.UniformsUtils.clone(a.uniforms),this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurx,this.convolutionUniforms.cKernel.value=THREE.ConvolutionShader.buildKernel(o),this.materialConvolution=new THREE.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}}),this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),this.scene.add(this.quad)},THREE.BloomPass.prototype={render:function(e,r,o,n,t){t&&e.context.disable(e.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=o,this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurX,e.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX,this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurY,e.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY,t&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,o,this.clear)}},THREE.BloomPass.blurX=new THREE.Vector2(.001953125,0),THREE.BloomPass.blurY=new THREE.Vector2(0,.001953125);


},{}],36:[function(require,module,exports){
"use strict";THREE.EffectComposer=function(e,r){if(this.renderer=e,void 0===r){var t=window.innerWidth||1,i=window.innerHeight||1,s={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1};r=new THREE.WebGLRenderTarget(t,i,s)}this.renderTarget1=r,this.renderTarget2=r.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},THREE.EffectComposer.prototype={swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e)},insertPass:function(e,r){this.passes.splice(r,0,e)},render:function(e){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var r,t,i=!1,s=this.passes.length;for(t=0;s>t;t++)if(r=this.passes[t],r.enabled){if(r.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),r.needsSwap){if(i){var n=this.renderer.context;n.stencilFunc(n.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.stencilFunc(n.EQUAL,1,4294967295)}this.swapBuffers()}r instanceof THREE.MaskPass?i=!0:r instanceof THREE.ClearMaskPass&&(i=!1)}},reset:function(e){void 0===e&&(e=this.renderTarget1.clone(),e.width=window.innerWidth,e.height=window.innerHeight),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,r){var t=this.renderTarget1.clone();t.width=e,t.height=r,this.reset(t)}};


},{}],37:[function(require,module,exports){
"use strict";THREE.FilmPass=function(e,i,s,r){void 0===THREE.FilmShader&&console.error("THREE.FilmPass relies on THREE.FilmShader");var t=THREE.FilmShader;this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==i&&(this.uniforms.sIntensity.value=i),void 0!==s&&(this.uniforms.sCount.value=s),this.enabled=!0,this.renderToScreen=!1,this.needsSwap=!0,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),this.scene.add(this.quad)},THREE.FilmPass.prototype={render:function(e,i,s,r){this.uniforms.tDiffuse.value=s,this.uniforms.time.value+=r,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,i,!1)}};


},{}],38:[function(require,module,exports){
"use strict";THREE.MaskPass=function(e,s){this.scene=e,this.camera=s,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype={render:function(e,s,t,a){var n=e.context;n.colorMask(!1,!1,!1,!1),n.depthMask(!1);var i,r;this.inverse?(i=0,r=1):(i=1,r=0),n.enable(n.STENCIL_TEST),n.stencilOp(n.REPLACE,n.REPLACE,n.REPLACE),n.stencilFunc(n.ALWAYS,i,4294967295),n.clearStencil(r),e.render(this.scene,this.camera,t,this.clear),e.render(this.scene,this.camera,s,this.clear),n.colorMask(!0,!0,!0,!0),n.depthMask(!0),n.stencilFunc(n.EQUAL,1,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)}},THREE.ClearMaskPass=function(){this.enabled=!0},THREE.ClearMaskPass.prototype={render:function(e,s,t,a){var n=e.context;n.disable(n.STENCIL_TEST)}};


},{}],39:[function(require,module,exports){
"use strict";THREE.RenderPass=function(e,r,l,a,o){this.scene=e,this.camera=r,this.overrideMaterial=l,this.clearColor=a,this.clearAlpha=void 0!==o?o:1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype={render:function(e,r,l,a){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.render(this.scene,this.camera,l,this.clear),this.clearColor&&e.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}};


},{}],40:[function(require,module,exports){
"use strict";THREE.SSAOShader={uniforms:{tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},onlyAO:{type:"i",value:0},aoClamp:{type:"f",value:.5},lumInfluence:{type:"f",value:.5}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cameraNear;","uniform float cameraFar;","uniform bool onlyAO;","uniform vec2 size;","uniform float aoClamp;","uniform float lumInfluence;","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","varying vec2 vUv;","#define DL 2.399963229728653","#define EULER 2.718281828459045","float width = size.x;","float height = size.y;","float cameraFarPlusNear = cameraFar + cameraNear;","float cameraFarMinusNear = cameraFar - cameraNear;","float cameraCoef = 2.0 * cameraNear;","const int samples = 8;","const float radius = 5.0;","const bool useNoise = false;","const float noiseAmount = 0.0003;","const float diffArea = 0.4;","const float gDisplace = 0.4;","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","vec2 rand( const vec2 coord ) {","vec2 noise;","if ( useNoise ) {","float nx = dot ( coord, vec2( 12.9898, 78.233 ) );","float ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );","noise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );","} else {","float ff = fract( 1.0 - coord.s * ( width / 2.0 ) );","float gg = fract( coord.t * ( height / 2.0 ) );","noise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;","}","return ( noise * 2.0  - 1.0 ) * noiseAmount;","}","float readDepth( const in vec2 coord ) {","return cameraCoef / ( cameraFarPlusNear - unpackDepth( texture2D( tDepth, coord ) ) * cameraFarMinusNear );","}","float compareDepths( const in float depth1, const in float depth2, inout int far ) {","float garea = 2.0;","float diff = ( depth1 - depth2 ) * 100.0;","if ( diff < gDisplace ) {","garea = diffArea;","} else {","far = 1;","}","float dd = diff - gDisplace;","float gauss = pow( EULER, -2.0 * dd * dd / ( garea * garea ) );","return gauss;","}","float calcAO( float depth, float dw, float dh ) {","float dd = radius - depth * radius;","vec2 vv = vec2( dw, dh );","vec2 coord1 = vUv + dd * vv;","vec2 coord2 = vUv - dd * vv;","float temp1 = 0.0;","float temp2 = 0.0;","int far = 0;","temp1 = compareDepths( depth, readDepth( coord1 ), far );","if ( far > 0 ) {","temp2 = compareDepths( readDepth( coord2 ), depth, far );","temp1 += ( 1.0 - temp1 ) * temp2;","}","return temp1;","}","void main() {","vec2 noise = rand( vUv );","float depth = readDepth( vUv );","float tt = clamp( depth, aoClamp, 1.0 );","float w = ( 1.0 / width )  / tt + ( noise.x * ( 1.0 - noise.x ) );","float h = ( 1.0 / height ) / tt + ( noise.y * ( 1.0 - noise.y ) );","float ao = 0.0;","float dz = 1.0 / float( samples );","float z = 1.0 - dz / 2.0;","float l = 0.0;","for ( int i = 0; i <= samples; i ++ ) {","float r = sqrt( 1.0 - z );","float pw = cos( l ) * r;","float ph = sin( l ) * r;","ao += calcAO( depth, pw * w, ph * h );","z = z - dz;","l = l + DL;","}","ao /= float( samples );","ao = 1.0 - ao;","vec3 color = texture2D( tDiffuse, vUv ).rgb;","vec3 lumcoeff = vec3( 0.299, 0.587, 0.114 );","float lum = dot( color.rgb, lumcoeff );","vec3 luminance = vec3( lum );","vec3 final = vec3( color * mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","if ( onlyAO ) {","final = vec3( mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","}","gl_FragColor = vec4( final, 1.0 );","}"].join("\n")},module.exports=THREE.SSAOShader;


},{}],41:[function(require,module,exports){
"use strict";THREE.ShaderPass=function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),this.scene.add(this.quad)},THREE.ShaderPass.prototype={render:function(e,t,r,s){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}};


},{}],42:[function(require,module,exports){
"use strict";var chromaticAberrationShader=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nvarying vec2 vUv;\n\nvoid main() {\n\n	vUv = uv;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}",fragmentShader:"#define GLSLIFY 1\n\nhighp float random_1_0(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\n\n\nuniform float opacity;\n\nuniform sampler2D tDiffuse;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n	vec2 unitI_ToSide = (vUv * 2.0 - 1.0);\n	\n	unitI_ToSide = pow(unitI_ToSide, vec2(3.0, 5.0)) * random_1_0(vUv) * -0.01;\n\n	vec4 texel = texture2D( tDiffuse, vUv );\n	vec4 smallshift = texture2D( tDiffuse, vUv + unitI_ToSide * 0.5 );\n	vec4 bigshift = texture2D( tDiffuse, vUv + unitI_ToSide );\n	\n	gl_FragColor = opacity * vec4( bigshift.x,  texel.y,  smallshift.z,  texel.w );\n\n}",uniforms:{opacity:{type:"f",value:1}}});module.exports=chromaticAberrationShader;


},{}],43:[function(require,module,exports){
"use strict";require("./EffectComposer"),require("./MaskPass"),require("./BloomPass"),require("./RenderPass"),require("./ShaderPass"),require("./FilmPass");


},{"./BloomPass":35,"./EffectComposer":36,"./FilmPass":37,"./MaskPass":38,"./RenderPass":39,"./ShaderPass":41}],44:[function(require,module,exports){
"use strict";var playground=new THREE.ShaderMaterial({vertexShader:"#define GLSLIFY 1\n\nvarying vec2 vUv;\n\nvoid main() {\n\n	vUv = uv;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}",fragmentShader:"#define GLSLIFY 1\n\nhighp float random_1_0(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\n\n\nuniform float opacity;\n\nuniform sampler2D tDiffuse;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\n	vec4 texel = texture2D( tDiffuse, vUv );\n	\n	gl_FragColor = opacity * vec4( texel.x, texel.y, texel.z, texel.w );\n\n}",uniforms:{opacity:{type:"f",value:1},tDepth:{type:"t",value:null}}});module.exports=playground;


},{}],45:[function(require,module,exports){
"use strict";function handleNewPoem(e,r){var n=_.extend({},r),t=CreateRenderer(e,n);return ResizeHandler(e,ResizeRendererFn(t,e.camera.object)),e.emitter.on("draw",function(){t.render(e.scene,e.camera.object)}),t}var ResizeRendererFn=require("./utils/resize-renderer-fn"),ResizeHandler=require("./utils/resize-handler"),CreateRenderer=require("./utils/create-renderer");module.exports=handleNewPoem;


},{"./utils/create-renderer":49,"./utils/resize-handler":51,"./utils/resize-renderer-fn":52}],46:[function(require,module,exports){
"use strict";var ResizeRendererFn=require("./utils/resize-renderer-fn"),ResizeHandler=require("./utils/resize-handler"),CreateRenderer=require("./utils/create-renderer"),StereoEffect=require("../vendor/StereoEffect"),ResizeHandler=require("./utils/resize-handler"),FadeOutUi=require("./utils/fade-out-ui");module.exports=function(e,r){var i=_.extend({},r),n=CreateRenderer(e,i),t=new StereoEffect(n);return t.separation=10,ResizeHandler(e,ResizeRendererFn(n,e.camera.object)),ResizeHandler(e,function(){t.setSize(window.innerWidth,window.innerHeight)}),e.emitter.on("draw",function(){t.render(e.scene,e.camera.object)}),FadeOutUi(e),n};


},{"../vendor/StereoEffect":73,"./utils/create-renderer":49,"./utils/fade-out-ui":50,"./utils/resize-handler":51,"./utils/resize-renderer-fn":52}],47:[function(require,module,exports){
"use strict";function _createEffectComposer(e,r,n,a){var i=new THREE.RenderPass(n,a),t=new THREE.ShaderPass(THREE.FXAAShader),o=new THREE.BloomPass(1.5,15,16,512),s=new THREE.ShaderPass(THREE.CopyShader);s.renderToScreen=!0;var d=new THREE.EffectComposer(r);d.addPass(i),d.addPass(t),d.addPass(o),d.addPass(s);var u=function(){t.uniforms.resolution.value.set(1/(window.innerWidth*e),1/(window.innerHeight*e)),d.renderTarget1.setSize(window.innerWidth*e,window.innerHeight*e),d.renderTarget2.setSize(window.innerWidth*e,window.innerHeight*e)};return u(),[d,u]}function handleNewPoem(e,r){var n=CreateRenderer(e,r);n.autoClear=!1,ResizeHandler(e,ResizeRendererFn(n,e.camera.object));{var a=_createEffectComposer(e.ratio,n,e.scene,e.camera.object),i=_slicedToArray(a,2),t=i[0];i[1]}return e.emitter.on("draw",function(){t.render(e.scene,e.camera.object)}),n}var _slicedToArray=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=[],a=!0,i=!1,t=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);a=!0);}catch(d){i=!0,t=d}finally{try{!a&&s["return"]&&s["return"]()}finally{if(i)throw t}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},ResizeRendererFn=require("./utils/resize-renderer-fn"),ResizeHandler=require("./utils/resize-handler"),CreateRenderer=require("./utils/create-renderer"),ChromaticAberrationShader=require("../postprocessing/chromaticAberration");require("../postprocessing"),require("../shaders/CopyShader"),require("../shaders/FilmShader"),require("../shaders/ConvolutionShader"),require("../shaders/FXAAShader"),module.exports=handleNewPoem;


},{"../postprocessing":43,"../postprocessing/chromaticAberration":42,"../shaders/ConvolutionShader":53,"../shaders/CopyShader":54,"../shaders/FXAAShader":55,"../shaders/FilmShader":56,"./utils/create-renderer":49,"./utils/resize-handler":51,"./utils/resize-renderer-fn":52}],48:[function(require,module,exports){
"use strict";function _createSsao(e,r,n,a){var i=new THREE.ShaderPass(SSAOShader);i.uniforms.tDepth.value=depthTarget,i.uniforms.cameraNear.value=a.near,i.uniforms.cameraFar.value=a.far,i.uniforms.fogEnabled.value=1,i.uniforms.aoClamp.value=.5,i.uniforms.size.value.set(window.innerWidth*e,window.innerHeight*e)}function _createDepthRender(e,r,n,a){var i=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,renderTargetParametersRGBA),t=new THREE.MeshDepthMaterial;return{render:function(){n.overrideMaterial=t,r(n,a,i,!0),n.overrideMaterial=null}}}function _createEffectComposer(e,r,n,a){var i=new THREE.RenderPass(n,a),t=new THREE.ShaderPass(THREE.FXAAShader),o=new THREE.ShaderPass(Playground),d=new THREE.ShaderPass(THREE.CopyShader);d.renderToScreen=!0;{var s=new THREE.EffectComposer(r);({minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat})}s.addPass(i),s.addPass(o),s.addPass(t),s.addPass(d);var u=function(){t.uniforms.resolution.value.set(1/(window.innerWidth*e),1/(window.innerHeight*e)),s.renderTarget1.setSize(window.innerWidth*e,window.innerHeight*e),s.renderTarget2.setSize(window.innerWidth*e,window.innerHeight*e)};return u(),[s,u]}function handleNewPoem(e,r){var n=CreateRenderer(e,r);n.autoClear=!1,ResizeHandler(e,ResizeRendererFn(n,e.camera.object));{var a=_createEffectComposer(e.ratio,n,e.scene,e.camera.object),i=_slicedToArray(a,2),t=i[0];i[1]}return e.emitter.on("draw",function(){t.render(e.scene,e.camera.object)}),n}var _slicedToArray=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=[],a=!0,i=!1,t=void 0;try{for(var o,d=e[Symbol.iterator]();!(a=(o=d.next()).done)&&(n.push(o.value),!r||n.length!==r);a=!0);}catch(s){i=!0,t=s}finally{try{!a&&d["return"]&&d["return"]()}finally{if(i)throw t}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},ResizeRendererFn=require("./utils/resize-renderer-fn"),ResizeHandler=require("./utils/resize-handler"),CreateRenderer=require("./utils/create-renderer"),SSAOShader=require("../postprocessing/SSAOShader"),Playground=require("../postprocessing/playground/playground");require("../postprocessing"),require("../shaders/CopyShader"),require("../shaders/FilmShader"),require("../shaders/ConvolutionShader"),require("../shaders/FXAAShader"),module.exports=handleNewPoem;


},{"../postprocessing":43,"../postprocessing/SSAOShader":40,"../postprocessing/playground/playground":44,"../shaders/ConvolutionShader":53,"../shaders/CopyShader":54,"../shaders/FXAAShader":55,"../shaders/FilmShader":56,"./utils/create-renderer":49,"./utils/resize-handler":51,"./utils/resize-renderer-fn":52}],49:[function(require,module,exports){
"use strict";module.exports=function(e,o){var t=_.extend({clearColor:2236962,addToDom:!0},o),n=new THREE.WebGLRenderer;return n.setPixelRatio(e.ratio),n.setClearColor(t.clearColor),t.addToDom&&(document.getElementById("container").appendChild(n.domElement),e.canvas=n.domElement,e.emitter.on("destroy",function(){n.domElement.remove()})),n};


},{}],50:[function(require,module,exports){
"use strict";module.exports=function(o){var e=!1,n=$("body"),t=$(o.canvas),u="mousemove touchmove",i=_.debounce(function(){e||(e=!0,n.addClass("hide-ui"))},1500),s=function(){e=!1,n.removeClass("hide-ui")},c=function(){e&&s(),i()};n.on(u,c),t.on(u,c),i(),o.emitter.on("destroy",function(){n.off(u,c),t.off(u,c)})};


},{}],51:[function(require,module,exports){
"use strict";module.exports=function(e,o){$(window).on("resize",o),e.emitter.on("destroy",function(){$(window).off("resize",o)}),o()};


},{}],52:[function(require,module,exports){
"use strict";module.exports=function(i,n){return function(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)}};


},{}],53:[function(require,module,exports){
"use strict";THREE.ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{type:"t",value:null},uImageIncrement:{type:"v2",value:new THREE.Vector2(.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(e){function n(e,n){return Math.exp(-(e*e)/(2*n*n))}var r,i,o,t,u=25,v=2*Math.ceil(3*e)+1;for(v>u&&(v=u),t=.5*(v-1),i=new Array(v),o=0,r=0;v>r;++r)i[r]=n(r-t,e),o+=i[r];for(r=0;v>r;++r)i[r]/=o;return i}};


},{}],54:[function(require,module,exports){
"use strict";THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};


},{}],55:[function(require,module,exports){
"use strict";THREE.FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","void main() {","vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;","vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;","vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;","vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;","vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );","vec3 rgbM  = rgbaM.xyz;","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float lumaNW = dot( rgbNW, luma );","float lumaNE = dot( rgbNE, luma );","float lumaSW = dot( rgbSW, luma );","float lumaSE = dot( rgbSE, luma );","float lumaM  = dot( rgbM,  luma );","float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","vec2 dir;","dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),","max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),","dir * rcpDirMin)) * resolution;","vec4 rgbA = (1.0/2.0) * (","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));","vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));","float lumaB = dot(rgbB, vec4(luma, 0.0));","if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {","gl_FragColor = rgbA;","} else {","gl_FragColor = rgbB;","}","}"].join("\n")};


},{}],56:[function(require,module,exports){
"use strict";THREE.FilmShader={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},nIntensity:{type:"f",value:.5},sIntensity:{type:"f",value:.05},sCount:{type:"f",value:4096},grayscale:{type:"i",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float x = vUv.x * vUv.y * time *  1000.0;","x = mod( x, 13.0 ) * mod( x, 123.0 );","float dx = mod( x, 0.01 );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};


},{}],57:[function(require,module,exports){
"use strict";var soundcloud=require("soundcloud-badge"),mute=require("./mute"),soundOff=!1,audio=null,fetchAndPlaySong=null,timesCalledSoundcloud=0,Music=function(u,o){fetchAndPlaySong=function(){var e=++timesCalledSoundcloud;soundcloud({client_id:"6057c9af862bf245d4c402179e317f52",song:o.url,dark:!1,getFonts:!1},function(u,n,d,t){if(e===timesCalledSoundcloud){if(mute.muted())return void $(".npm-scb-white").hide();if($(".npm-scb-white").show(),u)throw u;audio=new Audio,audio.src=n,audio.play(),audio.loop=!0,audio.volume=o.volume||.6,$(audio).on("loadedmetadata",function(){audio&&(audio.currentTime=o.startTime||0)})}}),u.emitter.on("destroy",function(){audio&&(audio.pause(),audio=null),$(".npm-scb-white").remove()})},mute.muted()||(fetchAndPlaySong(),fetchAndPlaySong=null)};Music.prototype.muted=!1,mute.emitter.on("mute",function(u){audio&&audio.pause(),$(".npm-scb-white").hide()}),mute.emitter.on("unmute",function(u){audio&&audio.play(),fetchAndPlaySong&&(fetchAndPlaySong(),fetchAndPlaySong=null),$(".npm-scb-white").show()}),module.exports=Music;


},{"./mute":58,"soundcloud-badge":182}],58:[function(require,module,exports){
"use strict";var poemMute=require("poem-mute"),mute=poemMute();window.mutePrime=mute,window.mutePrimeEmitter=mute.emitter,module.exports=mute;


},{"poem-mute":176}],59:[function(require,module,exports){
"use strict";function roundTo(n,o){return"number"==typeof o?Math.round(Math.pow(10,o)*n)/Math.pow(10,o):n}THREE.Console={vector:function(n,o){var e;e=n instanceof THREE.Vector2||n instanceof THREE.Vector3||n instanceof THREE.Vector4?[n]:n,console.table(_.map(e,function(n){return _.map(n.toArray(),function(n){return roundTo(n,o)})}))},face:function(n){var o;o=n instanceof THREE.Face3?[n]:n,console.table(_.map(o,function(n){return[n.a,n.b,n.c]}))},matrix:function(n,o){var e,r,t,a,u;for(u=[],r=0,a=n instanceof THREE.Matrix4?n.elements:n,e=0;e<a.length;e++)0===r&&u.push([]),t=roundTo(a[e],o),u[Math.floor(e/4)%4].push(t),r++,r%=4,e%16===15&&(console.table(u),u=[])},quaternion:function(){var n=new THREE.Euler,o=function(n){return n/Math.PI},e=function(n){return function(o){return roundTo(o,n)}};return function(r,t){n.setFromQuaternion(r);var a=e(t),u=n.toArray().slice(0,3);console.table({quaternion:_.map(r.toArray(),a),eulerRad:_.map(u,a),eulerUnitPi:_.map(_.map(u,o),a)})}}(),euler:function(){var n=new THREE.Quaternion,o=function(n){return n/Math.PI},e=function(n){return function(o){return roundTo(o,n)}};return function(r,t){n.setFromEuler(r);var a=e(t),u=r.toArray().slice(0,3);console.table({quaternion:_.map(n.toArray(),a),eulerRad:_.map(u,a),eulerUnitPi:_.map(_.map(u,o),a)})}}()},window.consoleMatrix=THREE.Console.matrix,window.consoleVector=THREE.Console.vector,window.consoleFace=THREE.Console.face,window.consoleQuaternion=THREE.Console.quaternion,window.consoleEuler=THREE.Console.euler,module.exports=THREE.Console;


},{}],60:[function(require,module,exports){
"use strict";var calculateSquaredTextureWidth=function(e){for(var t=1,r=0;e/4>t*t;)r++,t=Math.pow(2,r);return t};module.exports=calculateSquaredTextureWidth;


},{}],61:[function(require,module,exports){
"use strict";module.exports=function(e){return function(){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}};


},{}],62:[function(require,module,exports){
"use strict";function _newBuffer(t,r){var e=new Float32Array(t*r);return new THREE.BufferAttribute(e,r)}function _duplicateBuffer(t,r,e,a){for(var u=e*t.itemSize,i=0;a>i;i++)for(var f=i*u,n=0;u>n;n++)r.array[f+n]=t.array[n]}function _addIndices(t,r,e){for(var a=new Float32Array(e*r),u=0;e>u;u++)for(var i=u*r,f=0;r>f;f++)a[i+f]=u;var n=new THREE.BufferAttribute(a,1);t.addAttribute("attributeIndex",n),t.attributes.attributeIndex.needsUpdate=!0}module.exports=function(t,r){var e=t.attributes.position,a=t.attributes.normal,u=t.attributes.uv,i=e.array.length/3,f=i*r,n=_newBuffer(f,3),o=_newBuffer(f,3),d=_newBuffer(f,2);return _duplicateBuffer(e,n,i,r),_duplicateBuffer(a,o,i,r),_duplicateBuffer(u,d,i,r),t.attributes.position=n,t.attributes.normal=o,t.attributes.uv=d,_addIndices(t,i,r),t};


},{}],63:[function(require,module,exports){
"use strict";module.exports=function(e){var n=new THREE.Camera;n.position.z=1;var r=new THREE.Scene,o=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),new THREE.ShaderMaterial({uniforms:{resolution:{type:"v2",value:new THREE.Vector2},texture:{type:"t",value:null}},vertexShader:"\n				void main()	{\n					gl_Position = vec4( position, 1.0 );\n				}\n			",fragmentShader:"\n				uniform vec2 resolution;\n				uniform sampler2D texture;\n\n				void main()	{\n\n					vec2 uv = gl_FragCoord.xy / resolution.xy;\n\n					vec4 color = texture2D( texture, uv );\n\n					gl_FragColor = vec4( color.xyz, 1.0 );\n\n				}\n			"}));r.add(o);var t=o.material.uniforms;return function(o,u,a){t.resolution.value.set(a,a),t.texture.value=o,e.render(r,n,u)}};


},{}],64:[function(require,module,exports){
"use strict";function _nextPowerOfTwo(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}function _createRenderTarget(e,r){return new THREE.WebGLRenderTarget(e,e,{wrapS:THREE.RepeatWrapping,wrapT:THREE.RepeatWrapping,minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:r,type:THREE.FloatType,stencilBuffer:!1})}function _renderFn(e){var r=new THREE.Scene,t=new THREE.Camera,n=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2));return t.position.z=1,r.add(n),function(a,s){n.material=a,e.render(r,t,s)}}function _flipFn(e){var r=0,t=1;return function(){r=(r+1)%2,t=(t+1)%2,e.inputRenderTarget=e.renderTargets[r],e.outputRenderTarget=e.renderTargets[t]}}function _addPassFn(e,r,t){return function(r,n){var a=_.extend({size:100,stride:4,generateDatum:function(){},preRender:function(){},postRender:function(){},uniformName:"texture",autoUpdateUniform:!0,shaderMaterial:null,textureSideLength:null,active:!0},n);if(3===a.stride)var s=THREE.RGBFormat;else{if(4!==a.stride)throw new Error("Stride must be 3 or 4 to work with the RGB and RGBA formats.");var s=THREE.RGBAFormat}var i=_nextPowerOfTwo(Math.sqrt(a.size));a.textureSideLength=i;for(var o=new Float32Array(i*i*a.stride),u=0;u<o.length;u+=a.stride)a.generateDatum(o,u);var d=_createRenderTarget(i,s),p=_createRenderTarget(i,s);d.name="renderTargetA",p.name="renderTargetB";var f=new THREE.DataTexture(o,i,i);_.extend(f,{format:s,type:THREE.FloatType,minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,needsUpdate:!0,flipY:!1}),t(f,d,i),t(f,p,i),f.dispose();var R={active:a.active,size:a.size,stride:a.stride,preRender:a.preRender,postRender:a.postRender,shaderMaterial:a.shaderMaterial,uniformName:a.uniformName,autoUpdateUniform:a.autoUpdateUniform,textureSideLength:a.textureSideLength,inputRenderTarget:null,outputRenderTarget:null,renderTargets:[d,p]};return R.flip=_flipFn(R),e.passes[r]=R,R}}function _renderAllFn(e,r){return function(){_.each(e.passes,function(e,r){e.active&&(e.flip(),e.autoUpdateUniform&&(e.shaderMaterial.uniforms[e.uniformName].value=e.inputRenderTarget))}),_.each(e.passes,function(r){r.active&&r.preRender(r,e.passes)}),_.each(e.passes,function(e){e.active&&r(e.shaderMaterial,e.outputRenderTarget)}),_.each(e.passes,function(r){r.active&&r.postRender(r,e.passes)})}}function _renderPassFn(e,r){return function(t){var n=_.isString(t)?e.passes[t]:t;n.flip(),n.autoUpdateUniform&&(n.shaderMaterial.uniforms[n.uniformName].value=n.inputRenderTarget),n.preRender(n,e.passes),r(n.shaderMaterial,n.outputRenderTarget),post.postRender(n,e.passes)}}var CopyTexture=require("./copy-texture");module.exports=function(e,r){var t={passes:{}},n=new THREE.Camera;n.position.z=1;var a=(new THREE.Scene,CopyTexture(e)),s=_renderFn(e),i=_addPassFn(t,e,a),o=_renderAllFn(t,s),u=_renderPassFn(t,s);return{passes:t.passes,addPass:i,renderer:e,render:o,renderPass:u,copyTexture:a}};


},{"./copy-texture":63}],65:[function(require,module,exports){
"use strict";var loadImage=function(e,o,r){return new Promise(function(n,t){var a=($.Deferred(),$("<img />")),i=a[0];a.load(function(){_.isObject(o)&&(o[r]=i),n(i)}),a.error(function(){t("Could not load image: "+e)}),i.src=e})};module.exports=loadImage;


},{}],66:[function(require,module,exports){
"use strict";var loadText=function(t,e,n){var o=new Promise(function(o,a){$.ajax(t,{dataType:"text"}).then(function(t){_.isObject(e)&&(e[n]=t),o(t)},function(t){a(t)})});return o};module.exports=loadText;


},{}],67:[function(require,module,exports){
"use strict";var loadTexture=function(e,t,o){return new Promise(function(r,u){THREE.ImageUtils.loadTexture(e,void 0,function(e){_.isObject(t)&&(t[o]=e),r(e)},u)})};module.exports=loadTexture;


},{}],68:[function(require,module,exports){
"use strict";var random={flip:function(){return Math.random()>.5?!0:!1},range:function(n,r){return Math.random()*(r-n)+n},rangeInt:function(n,r){return Math.floor(this.range(n,r+1))},rangeLow:function(n,r){return Math.random()*Math.random()*(r-n)+n},rangeHigh:function(n,r){return(1-Math.random()*Math.random())*(r-n)+n}};module.exports=random;


},{}],69:[function(require,module,exports){
"use strict";THREE.AssimpJSONLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.AssimpJSONLoader.prototype={constructor:THREE.AssimpJSONLoader,texturePath:"",load:function(e,r,t,a,s){var n=this;this.texturePath=s&&"string"==typeof s?s:this.extractUrlBase(e);var o=new THREE.XHRLoader(this.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,function(e){var t,s,o=JSON.parse(e);if(s=o.__metadata__,"undefined"!=typeof s){if("assimp2json"!==s.format)return void a("Not an assimp2json scene");if(s.version<100&&s.version>=200)return void a("Unsupported assimp2json file format version")}t=n.parse(o),r(t)},t,a)},setCrossOrigin:function(e){this.crossOrigin=e},extractUrlBase:function(e){var r=e.split("/");return r.pop(),(r.length<1?".":r.join("/"))+"/"},parse:function(e){var r=this.parseList(e.meshes,this.parseMesh),t=this.parseList(e.materials,this.parseMaterial);return this.parseObject(e,e.rootnode,r,t)},parseList:function(e,r){for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=r.call(this,e[a]);return t},parseMesh:function(e){var r,t,a,s,n;for(r=new THREE.Geometry,s=e.vertices,t=0,a=s.length;a>t;)r.vertices.push(new THREE.Vector3(s[t++],s[t++],s[t++]));for(s=e.faces,t=0,a=s.length;a>t;++t){n=s[t];var o=new THREE.Face3(n[0],n[1],n[2]);r.faces.push(o)}for(e.texturecoords=e.texturecoords||[],t=0,a=e.texturecoords.length;a>t;++t){var i=function(e,r,t){var a,s,n,o,i,c;for(a=0,s=r.length;s>a;++a)n=r[a],o=2*n.a,i=2*n.b,c=2*n.c,t.push([new THREE.Vector2(e[o],e[o+1]),new THREE.Vector2(e[i],e[i+1]),new THREE.Vector2(e[c],e[c+1])])};i(e.texturecoords[t],r.faces,r.faceVertexUvs[t])}if(e.normals){var c=function(e,r){var t,a,s,n,o,i;for(t=0,a=r.length;a>t;++t)s=r[t],n=3*s.a,o=3*s.b,i=3*s.c,s.vertexNormals=[new THREE.Vector3(e[n],e[n+1],e[n+2]),new THREE.Vector3(e[o],e[o+1],e[o+2]),new THREE.Vector3(e[i],e[i+1],e[i+2])]};c(e.normals,r.faces)}if(e.colors&&e.colors[0]){var u=function(e,r){function t(e){var r=new THREE.Color;return r.setRGB(arr[0],arr[1],arr[2]),r}var a,s,n,o,i,c;for(a=0,s=r.length;s>a;++a)n=r[a],o=4*n.a,i=4*n.b,c=4*n.c,n.vertexColors=[t(o),t(i),t(c)]};u(e.colors[0],r.faces)}return r.computeBoundingSphere(),r},parseMaterial:function(e){function r(e){var r=new THREE.Color;return r.setRGB(e[0],e[1],e[2]),r}function t(){var e=new Image;return e.width=1,e.height=1,new THREE.Texture(e)}var a,s,n=null,o=this,i=[],c={shading:THREE.SmoothShading};for(var a in e.properties)s=e.properties[a],"$tex.file"===s.key?(1===s.semantic||5===s.semantic||6===s.semantic||2===s.semantic)&&!function(e){var r,t=new THREE.TextureLoader(o.manager);1===e?r="map":5===e?r="bumpMap":6===e?r="normalMap":2===e&&(r="specularMap"),i.push(r),t.setCrossOrigin(this.crossOrigin);var a=o.texturePath+"/"+s.value;a=a.replace(/\\/g,"/"),t.load(a,function(e){e&&(e.wrapS=e.wrapT=THREE.RepeatWrapping,n[r]=e,n.needsUpdate=!0)})}(s.semantic):"?mat.name"===s.key?c.name=s.value:"$clr.diffuse"===s.key?c.color=r(s.value):"$clr.specular"===s.key?c.specular=r(s.value):"$clr.emissive"===s.key?c.emissive=r(s.value):"$mat.shadingm"===s.key?1===s.value&&(c.shading=THREE.FlatShading):"$mat.shininess"===s.key&&(c.shininess=s.value);if(i.length)for(a=i.length-1;a>=0;--a)c[i[a]]=t();return n=new THREE.MeshPhongMaterial(c)},parseObject:function(e,r,t,a){var s,n,o=new THREE.Object3D;for(o.name=r.name||"",o.matrix=(new THREE.Matrix4).fromArray(r.transformation).transpose(),o.matrix.decompose(o.position,o.quaternion,o.scale),s=0;r.meshes&&s<r.meshes.length;++s)n=r.meshes[s],o.add(new THREE.Mesh(t[n],a[e.meshes[n].materialindex]));for(s=0;r.children&&s<r.children.length;++s)o.add(this.parseObject(e,r.children[s],t,a));return o}},module.exports=THREE.AssimpJSONLoader;


},{}],70:[function(require,module,exports){
"use strict";function onDeviceOrientationChangeEvent(t){deviceOrientation=t}function getOrientation(){switch(window.screen.orientation||window.screen.mozOrientation){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0}return window.orientation||0}function onScreenOrientationChangeEvent(){screenOrientation=getOrientation()}var deviceOrientation={},screenOrientation=window.orientation||0;window.addEventListener("deviceorientation",onDeviceOrientationChangeEvent,!1),window.addEventListener("orientationchange",onScreenOrientationChangeEvent,!1),THREE.DeviceOrientationControls=function(t){this.object=t,this.object.rotation.reorder("YXZ"),this.freeze=!0,this.movementSpeed=1,this.rollSpeed=.005,this.autoAlign=!0,this.autoForward=!1,this.alpha=0,this.beta=0,this.gamma=0,this.orient=0,this.alignQuaternion=new THREE.Quaternion,this.orientationQuaternion=new THREE.Quaternion;var e=new THREE.Quaternion,n=new THREE.Quaternion,i=new THREE.Vector3,o=new THREE.Matrix4,a=new THREE.Euler(0,0,0,"YXZ"),r=new THREE.Quaternion,s=new THREE.Vector3(0,0,1),h=new THREE.Vector3(0,1,0),c=new THREE.Vector3(0,0,0),u=new THREE.Euler,E=new THREE.Quaternion,d=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));this.update=function(t){return function(t){this.freeze||(this.alpha=deviceOrientation.gamma?THREE.Math.degToRad(deviceOrientation.alpha):0,this.beta=deviceOrientation.beta?THREE.Math.degToRad(deviceOrientation.beta):0,this.gamma=deviceOrientation.gamma?THREE.Math.degToRad(deviceOrientation.gamma):0,this.orient=screenOrientation?THREE.Math.degToRad(screenOrientation):0,u.set(this.beta,this.alpha,-this.gamma,"YXZ"),e.setFromEuler(u),n.slerp(e,.5),this.orientationQuaternion.copy(this.autoAlign?e:n),this.orientationQuaternion.multiply(d),this.orientationQuaternion.multiply(E.setFromAxisAngle(s,-this.orient)),this.object.quaternion.copy(this.alignQuaternion),this.object.quaternion.multiply(this.orientationQuaternion),this.autoForward&&(i.set(0,0,-1).applyQuaternion(this.object.quaternion,"ZXY").setLength(this.movementSpeed/50),this.object.position.add(i)),this.autoAlign&&0!==this.alpha&&(this.autoAlign=!1,this.align()))}}(),this.align=function(){i.set(0,0,-1).applyQuaternion(r.copy(this.orientationQuaternion).inverse(),"ZXY"),a.setFromQuaternion(r.setFromRotationMatrix(o.lookAt(i,c,h))),a.set(0,a.y,0),this.alignQuaternion.setFromEuler(a)},this.connect=function(){this.freeze=!1},this.disconnect=function(){this.freze=!0}},module.exports=THREE.DeviceOrientationControls;


},{}],71:[function(require,module,exports){
"use strict";THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*E.autoRotateSpeed}function o(){return Math.pow(.95,E.zoomSpeed)}function i(t){if(E.enabled!==!1){if(t.preventDefault(),t.button===E.mouseButtons.ORBIT){if(E.noRotate===!0)return;j=V.ROTATE,f.set(t.clientX,t.clientY)}else if(t.button===E.mouseButtons.ZOOM){if(E.noZoom===!0)return;j=V.DOLLY,H.set(t.clientX,t.clientY)}else if(t.button===E.mouseButtons.PAN){if(E.noPan===!0)return;j=V.PAN,O.set(t.clientX,t.clientY)}j!==V.NONE&&(document.addEventListener("mousemove",a,!1),document.addEventListener("mouseup",s,!1),E.dispatchEvent(Y))}}function a(t){if(E.enabled!==!1){t.preventDefault();var e=E.domElement===document?E.domElement.body:E.domElement;if(j===V.ROTATE){if(E.noRotate===!0)return;b.set(t.clientX,t.clientY),T.subVectors(b,f),E.rotateLeft(2*Math.PI*T.x/e.clientWidth*E.rotateSpeed),E.rotateUp(2*Math.PI*T.y/e.clientHeight*E.rotateSpeed),f.copy(b)}else if(j===V.DOLLY){if(E.noZoom===!0)return;M.set(t.clientX,t.clientY),P.subVectors(M,H),P.y>0?E.dollyIn():E.dollyOut(),H.copy(M)}else if(j===V.PAN){if(E.noPan===!0)return;y.set(t.clientX,t.clientY),v.subVectors(y,O),E.pan(v.x,v.y),O.copy(y)}j!==V.NONE&&E.update()}}function s(){E.enabled!==!1&&(document.removeEventListener("mousemove",a,!1),document.removeEventListener("mouseup",s,!1),E.dispatchEvent(I),j=V.NONE)}function r(t){if(E.enabled!==!1&&E.noZoom!==!0&&j===V.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?E.dollyOut():E.dollyIn(),E.update(),E.dispatchEvent(Y),E.dispatchEvent(I)}}function c(t){if(E.enabled!==!1&&E.noKeys!==!0&&E.noPan!==!0)switch(t.keyCode){case E.keys.UP:E.pan(0,E.keyPanSpeed),E.update();break;case E.keys.BOTTOM:E.pan(0,-E.keyPanSpeed),E.update();break;case E.keys.LEFT:E.pan(E.keyPanSpeed,0),E.update();break;case E.keys.RIGHT:E.pan(-E.keyPanSpeed,0),E.update()}}function h(t){if(E.enabled!==!1){switch(t.touches.length){case 1:if(E.noRotate===!0)return;j=V.TOUCH_ROTATE,f.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(E.noZoom===!0)return;j=V.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(e*e+n*n);H.set(0,o);break;case 3:if(E.noPan===!0)return;j=V.TOUCH_PAN,O.set(t.touches[0].pageX,t.touches[0].pageY);break;default:j=V.NONE}j!==V.NONE&&E.dispatchEvent(Y)}}function u(t){if(E.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=E.domElement===document?E.domElement.body:E.domElement;switch(t.touches.length){case 1:if(E.noRotate===!0)return;if(j!==V.TOUCH_ROTATE)return;b.set(t.touches[0].pageX,t.touches[0].pageY),T.subVectors(b,f),E.rotateLeft(2*Math.PI*T.x/e.clientWidth*E.rotateSpeed),E.rotateUp(2*Math.PI*T.y/e.clientHeight*E.rotateSpeed),f.copy(b),E.update();break;case 2:if(E.noZoom===!0)return;if(j!==V.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(n*n+o*o);M.set(0,i),P.subVectors(M,H),P.y>0?E.dollyOut():E.dollyIn(),H.copy(M),E.update();break;case 3:if(E.noPan===!0)return;if(j!==V.TOUCH_PAN)return;y.set(t.touches[0].pageX,t.touches[0].pageY),v.subVectors(y,O),E.pan(v.x,v.y),O.copy(y),E.update();break;default:j=V.NONE}}}function d(){E.enabled!==!1&&(E.dispatchEvent(I),j=V.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var l,p,E=this,m=1e-6,f=new THREE.Vector2,b=new THREE.Vector2,T=new THREE.Vector2,O=new THREE.Vector2,y=new THREE.Vector2,v=new THREE.Vector2,g=new THREE.Vector3,R=new THREE.Vector3,H=new THREE.Vector2,M=new THREE.Vector2,P=new THREE.Vector2,L=0,N=0,A=1,w=new THREE.Vector3,k=new THREE.Vector3,x=new THREE.Quaternion,V={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},j=V.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var D=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),S=D.clone().inverse(),U={type:"change"},Y={type:"start"},I={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=n()),N-=t},this.rotateUp=function(t){void 0===t&&(t=n()),L-=t},this.panLeft=function(t){var e=this.object.matrix.elements;g.set(e[0],e[1],e[2]),g.multiplyScalar(-t),w.add(g)},this.panUp=function(t){var e=this.object.matrix.elements;g.set(e[4],e[5],e[6]),g.multiplyScalar(t),w.add(g)},this.pan=function(t,e){var n=E.domElement===document?E.domElement.body:E.domElement;if(void 0!==E.object.fov){var o=E.object.position,i=o.clone().sub(E.target),a=i.length();a*=Math.tan(E.object.fov/2*Math.PI/180),E.panLeft(2*t*a/n.clientHeight),E.panUp(2*e*a/n.clientHeight)}else void 0!==E.object.top?(E.panLeft(t*(E.object.right-E.object.left)/n.clientWidth),E.panUp(e*(E.object.top-E.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=o()),A/=t},this.dollyOut=function(t){void 0===t&&(t=o()),A*=t},this.update=function(){var t=this.object.position;R.copy(t).sub(this.target),R.applyQuaternion(D),l=Math.atan2(R.x,R.z),p=Math.atan2(Math.sqrt(R.x*R.x+R.z*R.z),R.y),this.autoRotate&&j===V.NONE&&this.rotateLeft(n()),l+=N,p+=L,l=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,l)),p=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,p)),p=Math.max(m,Math.min(Math.PI-m,p));var e=R.length()*A;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(w),R.x=e*Math.sin(p)*Math.sin(l),R.y=e*Math.cos(p),R.z=e*Math.sin(p)*Math.cos(l),R.applyQuaternion(S),t.copy(this.target).add(R),this.object.lookAt(this.target),N=0,L=0,A=1,w.set(0,0,0),(k.distanceToSquared(this.object.position)>m||8*(1-x.dot(this.object.quaternion))>m)&&(this.dispatchEvent(U),k.copy(this.object.position),x.copy(this.object.quaternion))},this.reset=function(){j=V.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.getPolarAngle=function(){return p},this.getAzimuthalAngle=function(){return l},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",r,!1),this.domElement.addEventListener("DOMMouseScroll",r,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",u,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,module.exports=THREE.OrbitControls;


},{}],72:[function(require,module,exports){
"use strict";var Stats=function(){var e=Date.now(),t=e,n=0,i=1/0,a=0,d=0,o=1/0,l=0,s=0,r=0,c=document.createElement("div");c.id="stats",c.addEventListener("mousedown",function(e){e.preventDefault(),g(++r%2)},!1),c.style.cssText="width:80px;opacity:0.9;cursor:pointer";var p=document.createElement("div");p.id="fps",p.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",c.appendChild(p);var h=document.createElement("div");h.id="fpsText",h.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",h.innerHTML="FPS",p.appendChild(h);var f=document.createElement("div");for(f.id="fpsGraph",f.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",p.appendChild(f);f.children.length<74;){var x=document.createElement("span");x.style.cssText="width:1px;height:30px;float:left;background-color:#113",f.appendChild(x)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",c.appendChild(m);var u=document.createElement("div");u.id="msText",u.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",u.innerHTML="MS",m.appendChild(u);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(v);v.children.length<74;){var y=document.createElement("span");y.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(y)}var g=function(e){switch(r=e){case 0:p.style.display="block",m.style.display="none";break;case 1:p.style.display="none",m.style.display="block"}},b=function(e,t){var n=e.appendChild(e.firstChild);n.style.height=t+"px"};return{REVISION:12,domElement:c,setMode:g,begin:function(){e=Date.now()},end:function(){var r=Date.now();return n=r-e,i=Math.min(i,n),a=Math.max(a,n),u.textContent=n+" MS ("+i+"-"+a+")",b(v,Math.min(30,30-n/200*30)),s++,r>t+1e3&&(d=Math.round(1e3*s/(r-t)),o=Math.min(o,d),l=Math.max(l,d),h.textContent=d+" FPS ("+o+"-"+l+")",b(f,Math.min(30,30-d/100*30)),t=r,s=0),r},update:function(){e=this.end()}}};"object"==typeof module&&(module.exports=Stats);


},{}],73:[function(require,module,exports){
"use strict";THREE.StereoEffect=function(e){this.separation=3;var t,r,a=new THREE.Vector3,o=new THREE.Quaternion,i=new THREE.Vector3,n=new THREE.PerspectiveCamera,s=new THREE.PerspectiveCamera;e.autoClear=!1,this.setSize=function(a,o){t=a/2,r=o,e.setSize(a,o)},this.render=function(p,c){p.updateMatrixWorld(),void 0===c.parent&&c.updateMatrixWorld(),c.matrixWorld.decompose(a,o,i),n.fov=c.fov,n.aspect=.5*c.aspect,n.near=c.near,n.far=c.far,n.updateProjectionMatrix(),n.position.copy(a),n.quaternion.copy(o),n.translateX(-this.separation),s.near=c.near,s.far=c.far,s.projectionMatrix=n.projectionMatrix,s.position.copy(a),s.quaternion.copy(o),s.translateX(this.separation),e.setViewport(0,0,2*t,r),e.clear(),e.setViewport(0,0,t,r),e.render(p,n),e.setViewport(t,0,t,r),e.render(p,s)}},module.exports=THREE.StereoEffect;


},{}],74:[function(require,module,exports){
"use strict";module.exports={name:"Blobs",description:"Raycasting",order:3,config:{camera:{}},components:{renderer:{"function":require("../js/renderers/basic-renderer")},controls:{construct:require("../js/components/cameras/Controls")},mouse:{"function":require("../js/components/hids/mouse-tracker")},grid:{construct:require("../js/demos/Grid")},blobs:{"function":require("../js/components/ambiance/blobs/blobs")}}};


},{"../js/components/ambiance/blobs/blobs":5,"../js/components/cameras/Controls":10,"../js/components/hids/mouse-tracker":15,"../js/demos/Grid":28,"../js/renderers/basic-renderer":45}],75:[function(require,module,exports){
"use strict";module.exports={name:"Carbon Dioxide Earth",description:"Mapping NASA Data",order:0,config:{camera:{x:-400,far:3e3}},components:{renderer:{"function":require("../js/renderers/basic-renderer")},sphere:{construct:require("../js/demos/Earth"),properties:{}},controls:{construct:require("../js/components/cameras/Controls"),properties:{minDistance:500,maxDistance:1e3,zoomSpeed:.1,autoRotate:!0,autoRotateSpeed:.2}},info:{construct:require("../js/components/Info"),properties:{documentTitle:"Earth's CO2 – a Three.js Visualization adapted by Greg Tatum",title:"Earth's CO2",subtitle:"3d Visualisation of a map from NASA",appendCredits:"<br/> Map visualization by <a href='http://svs.gsfc.nasa.gov/cgi-bin/details.cgi?aid=11719'>NASA's Goddard Space Flight Center</a>",titleCss:{"font-size":"3.35em"},subtitleCss:{"font-size":"0.7em"},showArrowNext:!0}},stars:{construct:require("../js/components/Stars")},lights:{construct:require("../js/components/lights/TrackCameraLights")}}};


},{"../js/components/Info":1,"../js/components/Stars":2,"../js/components/cameras/Controls":10,"../js/components/lights/TrackCameraLights":16,"../js/demos/Earth":24,"../js/renderers/basic-renderer":45}],76:[function(require,module,exports){
"use strict";module.exports={name:"Cubic",description:"An Cubican Experiment",order:0,config:{camera:{x:0,z:500,near:.1,fov:40}},components:{renderer:{"function":require("../js/renderers/effects-renderer")},restrictedCamera:{construct:require("../js/components/cameras/RestrictedCamera")},wireTerrain:{construct:require("../js/demos/wire-terrain/terrain"),properties:{positionY:-250}},particles:{"function":require("../js/components/ambiance/particles/particles")},music:{construct:require("../js/sound/Music"),properties:{url:"https://soundcloud.com/cabbibo/that-was-just-stupidly"}},dragScroll:{"function":require("../js/components/utils/drag-scroll")},sky:{"function":require("../js/components/ambiance/Sky"),properties:{width:50}}}};


},{"../js/components/ambiance/Sky":4,"../js/components/ambiance/particles/particles":7,"../js/components/cameras/RestrictedCamera":12,"../js/components/utils/drag-scroll":19,"../js/demos/wire-terrain/terrain":33,"../js/renderers/effects-renderer":47,"../js/sound/Music":57}],77:[function(require,module,exports){
"use strict";module.exports={name:"Endless Terrain",description:"An ever-repeating environment",order:0,config:{camera:{x:0,z:500,near:.1,fov:40}},components:{renderer:{"function":require("../js/renderers/effects-renderer")},restrictedCamera:{construct:require("../js/components/cameras/RestrictedCamera")},endlessTerrain:{construct:require("../js/demos/EndlessTerrain/endless"),properties:{positionY:-250}},credits:{"function":require("../js/demos/EndlessTerrain/credits")},particles:{"function":require("../js/components/ambiance/particles/particles")},cloudsTop:{construct:require("../js/components/ambiance/Clouds"),properties:{height:200,rotation:Math.PI/2}},animator:{"function":require("../js/components/animator"),properties:require("../js/demos/EndlessTerrain/keyframes.js")}}};


},{"../js/components/ambiance/Clouds":3,"../js/components/ambiance/particles/particles":7,"../js/components/animator":8,"../js/components/cameras/RestrictedCamera":12,"../js/demos/EndlessTerrain/credits":25,"../js/demos/EndlessTerrain/endless":26,"../js/demos/EndlessTerrain/keyframes.js":27,"../js/renderers/effects-renderer":47}],78:[function(require,module,exports){
"use strict";module.exports={name:"Gpu Processor Example",description:"Positioning stored in a frame buffer",order:0,config:{camera:{x:-300,near:.1,far:5e3,fov:40}},components:{renderer:{"function":require("../js/renderers/basic-renderer")},controls:{construct:require("../js/components/cameras/Controls")},fboPositioning:{"function":require("../js/components/fbo-positioning/fbo")}}};


},{"../js/components/cameras/Controls":10,"../js/components/fbo-positioning/fbo":14,"../js/renderers/basic-renderer":45}],79:[function(require,module,exports){
"use strict";module.exports={"light-beams":require("./light-beams"),cubic:require("./cubic"),postprocessing:require("./postprocessing"),blobs:require("./blobs"),meshGroupBoxDemo:require("./meshGroupBoxDemo"),carbonDioxideEarth:require("./carbonDioxideEarth"),endlessTerrain:require("./endlessTerrain"),tetrahedra:require("./tetrahedra"),sineGravityCloud:require("./sineGravityCloud"),vr:require("./vr"),"fbo-positioning":require("./fbo-positioning")};


},{"./blobs":74,"./carbonDioxideEarth":75,"./cubic":76,"./endlessTerrain":77,"./fbo-positioning":78,"./light-beams":80,"./meshGroupBoxDemo":81,"./postprocessing":82,"./sineGravityCloud":83,"./tetrahedra":84,"./vr":85}],80:[function(require,module,exports){
"use strict";var LightBeam=require("../js/components/ambiance/light-beam/light-beam");module.exports={name:"Light Beams",description:"Atmospheric Lighting",order:0,config:{camera:{x:0,z:500,near:.1,fov:40}},components:{renderer:{"function":require("../js/renderers/basic-renderer")},controls:{construct:require("../js/components/cameras/Controls")},lightBeam1:{"function":LightBeam,properties:{position:[100,-150,0],color:11167249,lightLength:200}},lightBeam2:{"function":LightBeam,properties:{position:[100,-150,0],color:13386769,lightLength:300}},lightBeam4:{"function":LightBeam,properties:{position:[100,-150,0],color:16716049,lightLength:250}},lightBeam3:{"function":LightBeam,properties:{position:[100,-150,0],color:15606289,lightLength:200}},lightLeftBeam1:{"function":LightBeam,properties:{position:[-100,-150,0],color:1157734,lightLength:200}},lightLeftBeam2:{"function":LightBeam,properties:{position:[-100,-150,0],color:1166404,lightLength:300}},lightLeftBeam4:{"function":LightBeam,properties:{position:[-100,-150,0],color:1179409,lightLength:250}},lightLeftBeam3:{"function":LightBeam,properties:{position:[-100,-150,0],color:1175074,lightLength:200}},sky:{"function":require("../js/components/ambiance/Sky"),properties:{width:50}}}};


},{"../js/components/ambiance/Sky":4,"../js/components/ambiance/light-beam/light-beam":6,"../js/components/cameras/Controls":10,"../js/renderers/basic-renderer":45}],81:[function(require,module,exports){
"use strict";module.exports={name:"MeshGroup() Proof of Concept",description:"Batching multiple Three.js meshes into one draw call",order:50,config:{camera:{x:-400}},components:{renderer:{"function":require("../js/renderers/basic-renderer")},demo:{construct:require("../js/demos/MeshGroupBoxDemo"),properties:{}},controls:{construct:require("../js/components/cameras/Controls")},grid:{construct:require("../js/demos/Grid")},stats:{construct:require("../js/components/utils/Stats")}}};


},{"../js/components/cameras/Controls":10,"../js/components/utils/Stats":18,"../js/demos/Grid":28,"../js/demos/MeshGroupBoxDemo":30,"../js/renderers/basic-renderer":45}],82:[function(require,module,exports){
"use strict";module.exports={name:"Post Processing",description:"",order:0,config:{camera:{x:-400}},components:{renderer:{"function":require("../js/renderers/postprocess-renderer")},controls:{construct:require("../js/components/cameras/Controls")},grid:{construct:require("../js/demos/Grid")},tree:{"function":require("../js/components/models/tree"),properties:{position:[0,-50,0],scale:[20,20,20]}},lights:{construct:require("../js/components/lights/TrackCameraLights")}}};


},{"../js/components/cameras/Controls":10,"../js/components/lights/TrackCameraLights":16,"../js/components/models/tree":17,"../js/demos/Grid":28,"../js/renderers/postprocess-renderer":48}],83:[function(require,module,exports){
"use strict";module.exports={name:"Sine Gravity Cloud",description:"An evolving cloud of movement",order:0,config:{camera:{x:-400}},components:{renderer:{"function":require("../js/renderers/basic-renderer")},controls:{construct:require("../js/components/cameras/Controls")},pointcloud:{construct:require("../js/demos/SineGravityCloud")},grid:{construct:require("../js/demos/Grid")}}};


},{"../js/components/cameras/Controls":10,"../js/demos/Grid":28,"../js/demos/SineGravityCloud":31,"../js/renderers/basic-renderer":45}],84:[function(require,module,exports){
"use strict";module.exports={name:"Tetrahedra",description:"Live coding demo",order:0,config:{camera:{x:-300,near:.1,far:1e4,fov:40}},components:{renderer:{"function":require("../js/renderers/effects-renderer")},controls:{construct:require("../js/components/cameras/Controls")},mouse:{"function":require("../js/components/hids/mouse-tracker")},tetrahedra:{"function":require("../js/demos/tetrahedra"),properties:{dispersion:150,radius:10,count:100,mouseRef:"mouse"}},lights:{construct:require("../js/components/lights/TrackCameraLights")},cloudsTop:{construct:require("../js/components/ambiance/Clouds"),properties:{width:2e3,height:1e3,rotation:-Math.PI/2}},cloudsBottom:{construct:require("../js/components/ambiance/Clouds"),properties:{width:2e3,height:-1e3,rotation:-Math.PI/2,offset:new THREE.Vector2(-.3,.8)}}}};


},{"../js/components/ambiance/Clouds":3,"../js/components/cameras/Controls":10,"../js/components/hids/mouse-tracker":15,"../js/components/lights/TrackCameraLights":16,"../js/demos/tetrahedra":32,"../js/renderers/effects-renderer":47}],85:[function(require,module,exports){
"use strict";module.exports={name:"VR Demo",description:"The Sine Gravity wave as a VR demo",order:0,config:{camera:{x:-300,fov:70}},components:{renderer:{"function":require("../js/renderers/cardboard-renderer"),properties:{}},pointcloud:{construct:require("../js/demos/SineGravityCloud"),properties:{count:5e4,pointSize:4}},controls:{construct:require("../js/components/cameras/Orientation")},cameraRotation:{construct:require("../js/components/cameras/RotateAroundOrigin")},grid:{construct:require("../js/demos/Grid")}}};


},{"../js/components/cameras/Orientation":11,"../js/components/cameras/RotateAroundOrigin":13,"../js/demos/Grid":28,"../js/demos/SineGravityCloud":31,"../js/renderers/cardboard-renderer":46}],86:[function(require,module,exports){
!function(){var e=function(e){function t(e,t){if(e.indexOf)return e.indexOf(t);for(var r=e.length;r--;)if(e[r]===t)return r;return-1}function r(e,r){var n=t(e,r);-1!==n&&e.splice(n,1)}function n(e,t){return"[object "+t+"]"===Object.prototype.toString.call(e)}function i(e){return n(e,"RegExp")}function s(e){return n(e,"Array")}function a(e){return"function"==typeof e}function o(e){var t;return t=null===e||"null"===e?null:"true"===e?!0:"false"===e?!1:e===f||"undefined"===e?f:""===e||isNaN(e)?e:parseFloat(e)}function u(e){for(var t=e.length,r=[];t--;)r[t]=o(e[t]);return r}function h(e,t){for(var r,n,i=(e||"").replace("?","").split("&"),s=i.length,a={};s--;)r=i[s].split("="),n=t?o(r[1]):r[1],a[r[0]]="string"==typeof n?decodeURIComponent(n):n;return a}function p(){this.bypassed=new e.Signal,this.routed=new e.Signal,this._routes=[],this._prevRoutes=[],this._piped=[],this.resetState()}function c(t,r,n,s){var a=i(t),o=s.patternLexer;this._router=s,this._pattern=t,this._paramsIds=a?null:o.getParamIds(t),this._optionalParamsIds=a?null:o.getOptionalParamsIds(t),this._matchRegexp=a?t:o.compilePattern(t,s.ignoreCase),this.matched=new e.Signal,this.switched=new e.Signal,r&&this.matched.add(r),this._priority=n||0}var l,d,f;return d=""===/t(.+)?/.exec("t")[1],p.prototype={greedy:!1,greedyEnabled:!0,ignoreCase:!0,ignoreState:!1,shouldTypecast:!1,normalizeFn:null,resetState:function(){this._prevRoutes.length=0,this._prevMatchedRequest=null,this._prevBypassedRequest=null},create:function(){return new p},addRoute:function(e,t,r){var n=new c(e,t,r,this);return this._sortedInsert(n),n},removeRoute:function(e){r(this._routes,e),e._destroy()},removeAllRoutes:function(){for(var e=this.getNumRoutes();e--;)this._routes[e]._destroy();this._routes.length=0},parse:function(e,t){if(e=e||"",t=t||[],this.ignoreState||e!==this._prevMatchedRequest&&e!==this._prevBypassedRequest){var r,n=this._getMatchedRoutes(e),i=0,s=n.length;if(s)for(this._prevMatchedRequest=e,this._notifyPrevRoutes(n,e),this._prevRoutes=n;s>i;)r=n[i],r.route.matched.dispatch.apply(r.route.matched,t.concat(r.params)),r.isFirst=!i,this.routed.dispatch.apply(this.routed,t.concat([e,r])),i+=1;else this._prevBypassedRequest=e,this.bypassed.dispatch.apply(this.bypassed,t.concat([e]));this._pipeParse(e,t)}},_notifyPrevRoutes:function(e,t){for(var r,n=0;r=this._prevRoutes[n++];)r.route.switched&&this._didSwitch(r.route,e)&&r.route.switched.dispatch(t)},_didSwitch:function(e,t){for(var r,n=0;r=t[n++];)if(r.route===e)return!1;return!0},_pipeParse:function(e,t){for(var r,n=0;r=this._piped[n++];)r.parse(e,t)},getNumRoutes:function(){return this._routes.length},_sortedInsert:function(e){var t=this._routes,r=t.length;do--r;while(t[r]&&e._priority<=t[r]._priority);t.splice(r+1,0,e)},_getMatchedRoutes:function(e){for(var t,r=[],n=this._routes,i=n.length;(t=n[--i])&&((!r.length||this.greedy||t.greedy)&&t.match(e)&&r.push({route:t,params:t._getParamsArray(e)}),this.greedyEnabled||!r.length););return r},pipe:function(e){this._piped.push(e)},unpipe:function(e){r(this._piped,e)},toString:function(){return"[crossroads numRoutes:"+this.getNumRoutes()+"]"}},l=new p,l.VERSION="0.12.0",l.NORM_AS_ARRAY=function(e,t){return[t.vals_]},l.NORM_AS_OBJECT=function(e,t){return[t]},c.prototype={greedy:!1,rules:void 0,match:function(e){return e=e||"",this._matchRegexp.test(e)&&this._validateParams(e)},_validateParams:function(e){var t,r=this.rules,n=this._getParamsObject(e);for(t in r)if("normalize_"!==t&&r.hasOwnProperty(t)&&!this._isValidParam(e,t,n))return!1;return!0},_isValidParam:function(e,r,n){var o=this.rules[r],u=n[r],h=!1,p=0===r.indexOf("?");return null==u&&this._optionalParamsIds&&-1!==t(this._optionalParamsIds,r)?h=!0:i(o)?(p&&(u=n[r+"_"]),h=o.test(u)):s(o)?(p&&(u=n[r+"_"]),h=this._isValidArrayRule(o,u)):a(o)&&(h=o(u,e,n)),h},_isValidArrayRule:function(e,r){if(!this._router.ignoreCase)return-1!==t(e,r);"string"==typeof r&&(r=r.toLowerCase());for(var n,i,s=e.length;s--;)if(n=e[s],i="string"==typeof n?n.toLowerCase():n,i===r)return!0;return!1},_getParamsObject:function(e){for(var r,n,i=this._router.shouldTypecast,s=this._router.patternLexer.getParamValues(e,this._matchRegexp,i),a={},u=s.length;u--;)n=s[u],this._paramsIds&&(r=this._paramsIds[u],0===r.indexOf("?")&&n&&(a[r+"_"]=n,n=h(n,i),s[u]=n),d&&""===n&&-1!==t(this._optionalParamsIds,r)&&(n=void 0,s[u]=n),a[r]=n),a[u]=n;return a.request_=i?o(e):e,a.vals_=s,a},_getParamsArray:function(e){var t,r=this.rules?this.rules.normalize_:null;return r=r||this._router.normalizeFn,t=r&&a(r)?r(e,this._getParamsObject(e)):this._getParamsObject(e).vals_},interpolate:function(e){var t=this._router.patternLexer.interpolate(this._pattern,e);if(!this._validateParams(t))throw new Error("Generated string doesn't validate against `Route.rules`.");return t},dispose:function(){this._router.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.switched.dispose(),this.matched=this.switched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},p.prototype.patternLexer=function(){function e(){var e,t;for(e in d)d.hasOwnProperty(e)&&(t=d[e],t.id="__CR_"+e+"__",t.save="save"in t?t.save.replace("{{id}}",t.id):t.id,t.rRestore=new RegExp(t.id,"g"))}function t(e,t){var r,n=[];for(e.lastIndex=0;r=e.exec(t);)n.push(r[1]);return n}function r(e){return t(l,e)}function n(e){return t(d.OP.rgx,e)}function i(e,t){return e=e||"",e&&(v===f?e=e.replace(p,""):v===_&&(e=e.replace(c,"")),e=s(e,"rgx","save"),e=e.replace(h,"\\$&"),e=s(e,"rRestore","res"),v===f&&(e="\\/?"+e)),v!==g&&(e+="\\/?"),new RegExp("^"+e+"$",t?"i":"")}function s(e,t,r){var n,i;for(i in d)d.hasOwnProperty(i)&&(n=d[i],e=e.replace(n[t],n[r]));return e}function a(e,t,r){var n=t.exec(e);return n&&(n.shift(),r&&(n=u(n))),n}function o(e,t){if("string"!=typeof e)throw new Error("Route pattern should be a string.");var r=function(e,r){var n;if(r="?"===r.substr(0,1)?r.substr(1):r,null!=t[r]){if("object"==typeof t[r]){var i=[];for(var s in t[r])i.push(encodeURI(s+"="+t[r][s]));n="?"+i.join("&")}else n=String(t[r]);if(-1===e.indexOf("*")&&-1!==n.indexOf("/"))throw new Error('Invalid value "'+n+'" for segment "'+e+'".')}else{if(-1!==e.indexOf("{"))throw new Error("The segment "+e+" is required.");n=""}return n};return d.OS.trail||(d.OS.trail=new RegExp("(?:"+d.OS.id+")+$")),e.replace(d.OS.rgx,d.OS.save).replace(l,r).replace(d.OS.trail,"").replace(d.OS.rRestore,"/")}var h=/[\\.+*?\^$\[\](){}\/'#]/g,p=/^\/|\/$/g,c=/\/$/g,l=/(?:\{|:)([^}:]+)(?:\}|:)/g,d={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},f=1,g=2,_=3,v=f;return e(),{strict:function(){v=g},loose:function(){v=f},legacy:function(){v=_},getParamIds:r,getOptionalParamsIds:n,getParamValues:a,compilePattern:i,interpolate:o}}(),l};"function"==typeof define&&define.amd?define(["signals"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("signals")):window.crossroads=e(window.signals)}();


},{"signals":87}],87:[function(require,module,exports){
!function(i){function t(i,t,n,e,s){this._listener=t,this._isOnce=n,this.context=e,this._signal=i,this._priority=s||0}function n(i,t){if("function"!=typeof i)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function e(){this._bindings=[],this._prevParams=null;var i=this;this.dispatch=function(){e.prototype.dispatch.apply(i,arguments)}}t.prototype={active:!0,params:null,execute:function(i){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(i):i,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},e.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(i,n,e,s){var r,o=this._indexOfListener(i,e);if(-1!==o){if(r=this._bindings[o],r.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else r=new t(this,i,n,e,s),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(i){var t=this._bindings.length;do--t;while(this._bindings[t]&&i._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,i)},_indexOfListener:function(i,t){for(var n,e=this._bindings.length;e--;)if(n=this._bindings[e],n._listener===i&&n.context===t)return e;return-1},has:function(i,t){return-1!==this._indexOfListener(i,t)},add:function(i,t,e){return n(i,"add"),this._registerListener(i,!1,t,e)},addOnce:function(i,t,e){return n(i,"addOnce"),this._registerListener(i,!0,t,e)},remove:function(i,t){n(i,"remove");var e=this._indexOfListener(i,t);return-1!==e&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)),i},removeAll:function(){for(var i=this._bindings.length;i--;)this._bindings[i]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(i){if(this.active){var t,n=Array.prototype.slice.call(arguments),e=this._bindings.length;if(this.memorize&&(this._prevParams=n),e){t=this._bindings.slice(),this._shouldPropagate=!0;do e--;while(t[e]&&this._shouldPropagate&&t[e].execute(n)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=e;s.Signal=e,"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:i.signals=s}(this);


},{}],88:[function(require,module,exports){
module.exports=function(r,n,t,u,e){var a=function(n){var u=1-n;return 3*u*u*n*r+3*u*n*n*t+n*n*n},f=function(r){var t=1-r;return 3*t*t*r*n+3*t*r*r*u+r*r*r},i=function(n){var u=1-n;return 3*(2*(n-1)*n+u*u)*r+3*(-n*n*n+2*u*n)*t};return function(r){var n,t,u,o,c,v,b=r;for(u=b,v=0;8>v;v++){if(o=a(u)-b,Math.abs(o)<e)return f(u);if(c=i(u),Math.abs(c)<1e-6)break;u-=o/c}if(n=0,t=1,u=b,n>u)return f(n);if(u>t)return f(t);for(;t>n;){if(o=a(u),Math.abs(o-b)<e)return f(u);b>o?n=u:t=u,u=.5*(t-n)+n}return f(u)}};


},{}],89:[function(require,module,exports){
function backInOut(n){var t=2.5949095;return(n*=2)<1?.5*n*n*((t+1)*n-t):.5*((n-=2)*n*((t+1)*n+t)+2)}module.exports=backInOut;


},{}],90:[function(require,module,exports){
function backIn(n){var r=1.70158;return n*n*((r+1)*n-r)}module.exports=backIn;


},{}],91:[function(require,module,exports){
function backOut(t){var u=1.70158;return--t*t*((u+1)*t+u)+1}module.exports=backOut;


},{}],92:[function(require,module,exports){
function bounceInOut(u){return.5>u?.5*(1-bounceOut(1-2*u)):.5*bounceOut(2*u-1)+.5}var bounceOut=require("./bounce-out");module.exports=bounceInOut;


},{"./bounce-out":94}],93:[function(require,module,exports){
function bounceIn(u){return 1-bounceOut(1-u)}var bounceOut=require("./bounce-out");module.exports=bounceIn;


},{"./bounce-out":94}],94:[function(require,module,exports){
function bounceOut(u){var e=4/11,n=8/11,o=.9,t=4356/361,r=35442/1805,c=16061/1805,b=u*u;return e>u?7.5625*b:n>u?9.075*b-9.9*u+3.4:o>u?t*b-r*u+c:10.8*u*u-20.52*u+10.72}module.exports=bounceOut;


},{}],95:[function(require,module,exports){
function circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}module.exports=circInOut;


},{}],96:[function(require,module,exports){
function circIn(r){return 1-Math.sqrt(1-r*r)}module.exports=circIn;


},{}],97:[function(require,module,exports){
function circOut(t){return Math.sqrt(1- --t*t)}module.exports=circOut;


},{}],98:[function(require,module,exports){
function cubicInOut(u){return.5>u?4*u*u*u:.5*Math.pow(2*u-2,3)+1}module.exports=cubicInOut;


},{}],99:[function(require,module,exports){
function cubicIn(c){return c*c*c}module.exports=cubicIn;


},{}],100:[function(require,module,exports){
function cubicOut(u){var c=u-1;return c*c*c+1}module.exports=cubicOut;


},{}],101:[function(require,module,exports){
function elasticInOut(t){return.5>t?.5*Math.sin(13*Math.PI/2*2*t)*Math.pow(2,10*(2*t-1)):.5*Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+1}module.exports=elasticInOut;


},{}],102:[function(require,module,exports){
function elasticIn(t){return Math.sin(13*t*Math.PI/2)*Math.pow(2,10*(t-1))}module.exports=elasticIn;


},{}],103:[function(require,module,exports){
function elasticOut(t){return Math.sin(-13*(t+1)*Math.PI/2)*Math.pow(2,-10*t)+1}module.exports=elasticOut;


},{}],104:[function(require,module,exports){
function expoInOut(o){return 0===o||1===o?o:.5>o?.5*Math.pow(2,20*o-10):-.5*Math.pow(2,10-20*o)+1}module.exports=expoInOut;


},{}],105:[function(require,module,exports){
function expoIn(o){return 0===o?o:Math.pow(2,10*(o-1))}module.exports=expoIn;


},{}],106:[function(require,module,exports){
function expoOut(o){return 1===o?o:1-Math.pow(2,-10*o)}module.exports=expoOut;


},{}],107:[function(require,module,exports){
module.exports={backInOut:require("./back-in-out"),backIn:require("./back-in"),backOut:require("./back-out"),bounceInOut:require("./bounce-in-out"),bounceIn:require("./bounce-in"),bounceOut:require("./bounce-out"),circInOut:require("./circ-in-out"),circIn:require("./circ-in"),circOut:require("./circ-out"),cubicInOut:require("./cubic-in-out"),cubicIn:require("./cubic-in"),cubicOut:require("./cubic-out"),elasticInOut:require("./elastic-in-out"),elasticIn:require("./elastic-in"),elasticOut:require("./elastic-out"),expoInOut:require("./expo-in-out"),expoIn:require("./expo-in"),expoOut:require("./expo-out"),linear:require("./linear"),quadInOut:require("./quad-in-out"),quadIn:require("./quad-in"),quadOut:require("./quad-out"),quartInOut:require("./quart-in-out"),quartIn:require("./quart-in"),quartOut:require("./quart-out"),quintInOut:require("./quint-in-out"),quintIn:require("./quint-in"),quintOut:require("./quint-out"),sineInOut:require("./sine-in-out"),sineIn:require("./sine-in"),sineOut:require("./sine-out")};


},{"./back-in":90,"./back-in-out":89,"./back-out":91,"./bounce-in":93,"./bounce-in-out":92,"./bounce-out":94,"./circ-in":96,"./circ-in-out":95,"./circ-out":97,"./cubic-in":99,"./cubic-in-out":98,"./cubic-out":100,"./elastic-in":102,"./elastic-in-out":101,"./elastic-out":103,"./expo-in":105,"./expo-in-out":104,"./expo-out":106,"./linear":108,"./quad-in":110,"./quad-in-out":109,"./quad-out":111,"./quart-in":113,"./quart-in-out":112,"./quart-out":114,"./quint-in":116,"./quint-in-out":115,"./quint-out":117,"./sine-in":119,"./sine-in-out":118,"./sine-out":120}],108:[function(require,module,exports){
function linear(e){return e}module.exports=linear;


},{}],109:[function(require,module,exports){
function quadInOut(u){return u/=.5,1>u?.5*u*u:(u--,-.5*(u*(u-2)-1))}module.exports=quadInOut;


},{}],110:[function(require,module,exports){
function quadIn(n){return n*n}module.exports=quadIn;


},{}],111:[function(require,module,exports){
function quadOut(u){return-u*(u-2)}module.exports=quadOut;


},{}],112:[function(require,module,exports){
function quarticInOut(t){return.5>t?8*Math.pow(t,4):-8*Math.pow(t-1,4)+1}module.exports=quarticInOut;


},{}],113:[function(require,module,exports){
function quarticIn(t){return Math.pow(t,4)}module.exports=quarticIn;


},{}],114:[function(require,module,exports){
function quarticOut(t){return Math.pow(t-1,3)*(1-t)+1}module.exports=quarticOut;


},{}],115:[function(require,module,exports){
function qinticInOut(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}module.exports=qinticInOut;


},{}],116:[function(require,module,exports){
function qinticIn(n){return n*n*n*n*n}module.exports=qinticIn;


},{}],117:[function(require,module,exports){
function qinticOut(t){return--t*t*t*t*t+1}module.exports=qinticOut;


},{}],118:[function(require,module,exports){
function sineInOut(n){return-.5*(Math.cos(Math.PI*n)-1)}module.exports=sineInOut;


},{}],119:[function(require,module,exports){
function sineIn(n){return 1-Math.cos(n*Math.PI/2)}module.exports=sineIn;


},{}],120:[function(require,module,exports){
function sineOut(t){return Math.sin(t*Math.PI/2)}module.exports=sineOut;


},{}],121:[function(require,module,exports){
(function (process,global){
(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function r(t){U=t}function o(t){B=t}function i(){var t=process.nextTick,e=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(f)}}function u(){return function(){N(f)}}function s(){var t=0,e=new J(f),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=f,function(){t.port2.postMessage(0)}}function a(){return function(){setTimeout(f,1)}}function f(){for(var t=0;z>t;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}z=0}function l(){try{var t=require,e=t("vertx");return N=e.runOnLoop||e.runOnContext,u()}catch(n){return a()}}function p(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function d(t){try{return t.then}catch(e){return et.error=e,et}}function v(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function y(t,e,n){B(function(t){var r=!1,o=v(n,e,function(n){r||(r=!0,e!==n?g(t,n):A(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function m(t,e){e._state===Z?A(t,e._result):e._state===tt?E(t,e._result):j(e,void 0,function(e){g(t,e)},function(e){E(t,e)})}function b(t,n){if(n.constructor===t.constructor)m(t,n);else{var r=d(n);r===et?E(t,et.error):void 0===r?A(t,n):e(r)?y(t,n,r):A(t,n)}}function g(e,n){e===n?E(e,_()):t(n)?b(e,n):A(e,n)}function w(t){t._onerror&&t._onerror(t._result),S(t)}function A(t,e){t._state===X&&(t._result=e,t._state=Z,0!==t._subscribers.length&&B(S,t))}function E(t,e){t._state===X&&(t._state=tt,t._result=e,B(w,t))}function j(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+Z]=n,o[i+tt]=r,0===i&&t._state&&B(S,t)}function S(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,u=0;u<e.length;u+=3)r=e[u],o=e[u+n],r?x(n,r,o,i):o(i);t._subscribers.length=0}}function T(){this.error=null}function P(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function x(t,n,r,o){var i,u,s,c,a=e(r);if(a){if(i=P(r,o),i===nt?(c=!0,u=i.error,i=null):s=!0,n===i)return void E(n,h())}else i=o,s=!0;n._state!==X||(a&&s?g(n,i):c?E(n,u):t===Z?A(n,i):t===tt&&E(n,i))}function C(t,e){try{e(function(e){g(t,e)},function(e){E(t,e)})}catch(n){E(t,n)}}function M(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(p),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?A(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&A(n.promise,n._result))):E(n.promise,n._validationError())}function O(t){return new rt(this,t).promise}function k(t){function e(t){g(o,t)}function n(t){E(o,t)}var r=this,o=new r(p);if(!$(t))return E(o,new TypeError("You must pass an array to race.")),o;for(var i=t.length,u=0;o._state===X&&i>u;u++)j(r.resolve(t[u]),void 0,e,n);return o}function I(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function Y(t){var e=this,n=new e(p);return E(n,t),n}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(t){this._id=ct++,this._state=void 0,this._result=void 0,this._subscribers=[],p!==t&&(e(t)||q(),this instanceof D||F(),C(this,t))}function K(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=at)}var L;L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var N,U,W,$=L,z=0,B=({}.toString,function(t,e){V[z]=t,V[z+1]=e,z+=2,2===z&&(U?U(f):W())}),G="undefined"!=typeof window?window:void 0,H=G||{},J=H.MutationObserver||H.WebKitMutationObserver,Q="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),R="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3);W=Q?i():J?s():R?c():void 0===G&&"function"==typeof require?l():a();var X=void 0,Z=1,tt=2,et=new T,nt=new T;M.prototype._validateInput=function(t){return $(t)},M.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},M.prototype._init=function(){this._result=new Array(this.length)};var rt=M;M.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===X&&e>o;o++)t._eachEntry(r[o],o)},M.prototype._eachEntry=function(t,e){var r=this,o=r._instanceConstructor;n(t)?t.constructor===o&&t._state!==X?(t._onerror=null,r._settledAt(t._state,e,t._result)):r._willSettleAt(o.resolve(t),e):(r._remaining--,r._result[e]=t)},M.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===X&&(r._remaining--,t===tt?E(o,n):r._result[e]=n),0===r._remaining&&A(o,r._result)},M.prototype._willSettleAt=function(t,e){var n=this;j(t,void 0,function(t){n._settledAt(Z,e,t)},function(t){n._settledAt(tt,e,t)})};var ot=O,it=k,ut=I,st=Y,ct=0,at=D;D.all=ot,D.race=it,D.resolve=ut,D.reject=st,D._setScheduler=r,D._setAsap=o,D._asap=B,D.prototype={constructor:D,then:function(t,e){var n=this,r=n._state;if(r===Z&&!t||r===tt&&!e)return this;var o=new this.constructor(p),i=n._result;if(r){var u=arguments[r-1];B(function(){x(r,o,u,i)})}else j(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var ft=K,lt={Promise:at,polyfill:ft};"function"==typeof define&&define.amd?define(function(){return lt}):"undefined"!=typeof module&&module.exports?module.exports=lt:"undefined"!=typeof this&&(this.ES6Promise=lt),ft()}).call(this);


}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":197}],122:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,s,i,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];n.apply(this,i)}else if(isObject(n)){for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(o=n.slice(),s=o.length,r=0;s>r;r++)o[r].apply(this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,s,i,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=i;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){s=r;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};


},{}],123:[function(require,module,exports){
!function(){var e=function(e){var n=function(n){function t(e){return String(e||"").replace(/\W/g,"\\$&")}function a(e){if(!e)return"";var n=new RegExp("^"+t(l.prependHash)+"|"+t(l.appendHash)+"$","g");return e.replace(n,"")}function r(){var e=R.exec(l.getURL()),n=e&&e[1]||"";try{return l.raw?n:decodeURIComponent(n)}catch(t){return n}}function i(){return m?m.contentWindow.frameHash:null}function o(){m=y.createElement("iframe"),m.src="about:blank",m.style.display="none",y.body.appendChild(m)}function s(){if(m&&f!==i()){var e=m.contentWindow.document;e.open(),e.write("<html><head><title>"+y.title+'</title><script type="text/javascript">var frameHash="'+f+'";</script></head><body>&nbsp;</body></html>'),e.close()}}function c(e,n){if(f!==e){var t=f;f=e,x&&(n?m.contentWindow.frameHash=e:s()),l.changed.dispatch(a(e),a(t))}}function p(e,n,t){e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent&&e.attachEvent("on"+n,t)}function u(e,n,t){e.removeEventListener?e.removeEventListener(n,t,!1):e.detachEvent&&e.detachEvent("on"+n,t)}function d(e){e=Array.prototype.slice.call(arguments);var n=e.join(l.separator);return n=n?l.prependHash+n.replace(b,"")+l.appendHash:n}function h(e){return e=encodeURI(e),I&&z&&(e=e.replace(/\?/,"%3F")),e}var l,f,g,v,m,w,H=25,y=n.document,E=(n.history,e.Signal),R=/#(.*)$/,L=/(\?.*)|(\#.*)/,b=/^\#/,I=!1,U="onhashchange"in n&&7!==y.documentMode,x=I&&!U,z="file:"===location.protocol;return w=x?function(){var e=r(),n=i();n!==f&&n!==e?l.setHash(a(n)):e!==f&&c(e)}:function(){var e=r();e!==f&&c(e)},l={VERSION:"1.2.0",raw:!1,appendHash:"",prependHash:"/",separator:"/",changed:new E,stopped:new E,initialized:new E,init:function(){v||(f=r(),U?p(n,"hashchange",w):(x&&(m||o(),s()),g=setInterval(w,H)),v=!0,l.initialized.dispatch(a(f)))},stop:function(){v&&(U?u(n,"hashchange",w):(clearInterval(g),g=null),v=!1,l.stopped.dispatch(a(f)))},isActive:function(){return v},getURL:function(){return n.location.href},getBaseURL:function(){return l.getURL().replace(L,"")},setHash:function(e){e=d.apply(null,arguments),e!==f&&(c(e),e===f&&(l.raw||(e=h(e)),n.location.hash="#"+e))},replaceHash:function(e){e=d.apply(null,arguments),e!==f&&(c(e,!0),e===f&&(l.raw||(e=h(e)),n.location.replace("#"+e)))},getHash:function(){return a(f)},getHashAsArray:function(){return l.getHash().split(l.separator)},dispose:function(){l.stop(),l.initialized.dispose(),l.stopped.dispose(),l.changed.dispose(),m=l=n.hasher=null},toString:function(){return'[hasher version="'+l.VERSION+'" hash="'+l.getHash()+'"]'}},l.initialized.memorize=!0,l}(window);return n};"function"==typeof define&&define.amd?define(["signals"],e):"object"==typeof exports?module.exports=e(require("signals")):window.hasher=e(window.signals)}();


},{"signals":124}],124:[function(require,module,exports){
!function(i){function t(i,t,n,e,s){this._listener=t,this._isOnce=n,this.context=e,this._signal=i,this._priority=s||0}function n(i,t){if("function"!=typeof i)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function e(){this._bindings=[],this._prevParams=null;var i=this;this.dispatch=function(){e.prototype.dispatch.apply(i,arguments)}}t.prototype={active:!0,params:null,execute:function(i){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(i):i,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},e.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(i,n,e,s){var r,o=this._indexOfListener(i,e);if(-1!==o){if(r=this._bindings[o],r.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else r=new t(this,i,n,e,s),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(i){var t=this._bindings.length;do--t;while(this._bindings[t]&&i._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,i)},_indexOfListener:function(i,t){for(var n,e=this._bindings.length;e--;)if(n=this._bindings[e],n._listener===i&&n.context===t)return e;return-1},has:function(i,t){return-1!==this._indexOfListener(i,t)},add:function(i,t,e){return n(i,"add"),this._registerListener(i,!1,t,e)},addOnce:function(i,t,e){return n(i,"addOnce"),this._registerListener(i,!0,t,e)},remove:function(i,t){n(i,"remove");var e=this._indexOfListener(i,t);return-1!==e&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)),i},removeAll:function(){for(var i=this._bindings.length;i--;)this._bindings[i]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(i){if(this.active){var t,n=Array.prototype.slice.call(arguments),e=this._bindings.length;if(this.memorize&&(this._prevParams=n),e){t=this._bindings.slice(),this._shouldPropagate=!0;do e--;while(t[e]&&this._shouldPropagate&&t[e].execute(n)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=e;s.Signal=e,"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:i.signals=s}(this);


},{}],125:[function(require,module,exports){
function lerp(e,r,l){return e*(1-l)+r*l}module.exports=lerp;


},{}],126:[function(require,module,exports){
"use strict";function Promise(e){function n(e){return null===i?void f.push(e):void asap(function(){var n=i?e.onFulfilled:e.onRejected;if(null===n)return void(i?e.resolve:e.reject)(u);var t;try{t=n(u)}catch(o){return void e.reject(o)}e.resolve(t)})}function t(e){try{if(e===c)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void doResolve(n.bind(e),t,o)}i=!0,u=e,r()}catch(f){o(f)}}function o(e){i=!1,u=e,r()}function r(){for(var e=0,t=f.length;t>e;e++)n(f[e]);f=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var i=null,u=null,f=[],c=this;this.then=function(e,t){return new Promise(function(o,r){n(new Handler(e,t,o,r))})},doResolve(e,t,o)}function Handler(e,n,t,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.resolve=t,this.reject=o}function doResolve(e,n,t){var o=!1;try{e(function(e){o||(o=!0,n(e))},function(e){o||(o=!0,t(e))})}catch(r){if(o)return;o=!0,t(r)}}var asap=require("asap");module.exports=Promise;


},{"asap":128}],127:[function(require,module,exports){
"use strict";function ValuePromise(e){this.then=function(n){return"function"!=typeof n?this:new Promise(function(r,t){asap(function(){try{r(n(e))}catch(o){t(o)}})})}}var Promise=require("./core.js"),asap=require("asap");module.exports=Promise,ValuePromise.prototype=Object.create(Promise.prototype);var TRUE=new ValuePromise(!0),FALSE=new ValuePromise(!1),NULL=new ValuePromise(null),UNDEFINED=new ValuePromise(void 0),ZERO=new ValuePromise(0),EMPTYSTRING=new ValuePromise("");Promise.resolve=function(e){if(e instanceof Promise)return e;if(null===e)return NULL;if(void 0===e)return UNDEFINED;if(e===!0)return TRUE;if(e===!1)return FALSE;if(0===e)return ZERO;if(""===e)return EMPTYSTRING;if("object"==typeof e||"function"==typeof e)try{var n=e.then;if("function"==typeof n)return new Promise(n.bind(e))}catch(r){return new Promise(function(e,n){n(r)})}return new ValuePromise(e)},Promise.from=Promise.cast=function(e){var n=new Error("Promise.from and Promise.cast are deprecated, use Promise.resolve instead");return n.name="Warning",console.warn(n.stack),Promise.resolve(e)},Promise.denodeify=function(e,n){return n=n||1/0,function(){var r=this,t=Array.prototype.slice.call(arguments);return new Promise(function(o,i){for(;t.length&&t.length>n;)t.pop();t.push(function(e,n){e?i(e):o(n)}),e.apply(r,t)})}},Promise.nodeify=function(e){return function(){var n=Array.prototype.slice.call(arguments),r="function"==typeof n[n.length-1]?n.pop():null;try{return e.apply(this,arguments).nodeify(r)}catch(t){if(null===r||"undefined"==typeof r)return new Promise(function(e,n){n(t)});asap(function(){r(t)})}}},Promise.all=function(){var e=1===arguments.length&&Array.isArray(arguments[0]),n=Array.prototype.slice.call(e?arguments[0]:arguments);if(!e){var r=new Error("Promise.all should be called with a single array, calling it with multiple arguments is deprecated");r.name="Warning",console.warn(r.stack)}return new Promise(function(e,r){function t(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var s=u.then;if("function"==typeof s)return void s.call(u,function(e){t(i,e)},r)}n[i]=u,0===--o&&e(n)}catch(a){r(a)}}if(0===n.length)return e([]);for(var o=n.length,i=0;i<n.length;i++)t(i,n[i])})},Promise.reject=function(e){return new Promise(function(n,r){r(e)})},Promise.race=function(e){return new Promise(function(n,r){e.forEach(function(e){Promise.resolve(e).then(n,r)})})},Promise.prototype.done=function(e,n){var r=arguments.length?this.then.apply(this,arguments):this;r.then(null,function(e){asap(function(){throw e})})},Promise.prototype.nodeify=function(e){return"function"!=typeof e?this:void this.then(function(n){asap(function(){e(null,n)})},function(n){asap(function(){e(n)})})},Promise.prototype["catch"]=function(e){return this.then(null,e)};


},{"./core.js":126,"asap":128}],128:[function(require,module,exports){
(function (process){
function flush(){for(;head.next;){head=head.next;var e=head.task;head.task=void 0;var s=head.domain;s&&(head.domain=void 0,s.enter());try{e()}catch(n){if(isNodeJS)throw s&&s.exit(),setTimeout(flush,0),s&&s.enter(),n;setTimeout(function(){throw n},0)}s&&s.exit()}flushing=!1}function asap(e){tail=tail.next={task:e,domain:isNodeJS&&process.domain,next:null},flushing||(flushing=!0,requestFlush())}var head={task:void 0,next:null},tail=head,flushing=!1,requestFlush=void 0,isNodeJS=!1;if("undefined"!=typeof process&&process.nextTick)isNodeJS=!0,requestFlush=function(){process.nextTick(flush)};else if("function"==typeof setImmediate)requestFlush="undefined"!=typeof window?setImmediate.bind(window,flush):function(){setImmediate(flush)};else if("undefined"!=typeof MessageChannel){var channel=new MessageChannel;channel.port1.onmessage=flush,requestFlush=function(){channel.port2.postMessage(0)}}else requestFlush=function(){setTimeout(flush,0)};module.exports=asap;


}).call(this,require('_process'))

},{"_process":197}],129:[function(require,module,exports){
(function(){"use strict";function n(n){var e=this,t={db:null};if(n)for(var r in n)t[r]=n[r];return new l(function(n,r){var o=v.open(t.name,t.version);o.onerror=function(){r(o.error)},o.onupgradeneeded=function(){o.result.createObjectStore(t.storeName)},o.onsuccess=function(){t.db=o.result,e._dbInfo=t,n()}})}function e(n,e){var t=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var r=new l(function(e,r){t.ready().then(function(){var o=t._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.get(n);a.onsuccess=function(){var n=a.result;void 0===n&&(n=null),e(n)},a.onerror=function(){r(a.error)}})["catch"](r)});return d(r,e),r}function t(n,e){var t=this,r=new l(function(e,r){t.ready().then(function(){var o=t._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.openCursor(),c=1;a.onsuccess=function(){var t=a.result;if(t){var r=n(t.value,t.key,c++);void 0!==r?e(r):t["continue"]()}else e()},a.onerror=function(){r(a.error)}})["catch"](r)});return d(r,e),r}function r(n,e,t){var r=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var o=new l(function(t,o){r.ready().then(function(){var i=r._dbInfo,a=i.db.transaction(i.storeName,"readwrite"),c=a.objectStore(i.storeName);null===e&&(e=void 0);var u=c.put(e,n);a.oncomplete=function(){void 0===e&&(e=null),t(e)},a.onabort=a.onerror=function(){o(u.error)}})["catch"](o)});return d(o,t),o}function o(n,e){var t=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var r=new l(function(e,r){t.ready().then(function(){var o=t._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName),c=a["delete"](n);i.oncomplete=function(){e()},i.onerror=function(){r(c.error)},i.onabort=function(n){var e=n.target.error;"QuotaExceededError"===e&&r(e)}})["catch"](r)});return d(r,e),r}function i(n){var e=this,t=new l(function(n,t){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readwrite"),i=o.objectStore(r.storeName),a=i.clear();o.oncomplete=function(){n()},o.onabort=o.onerror=function(){t(a.error)}})["catch"](t)});return d(t,n),t}function a(n){var e=this,t=new l(function(n,t){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.count();i.onsuccess=function(){n(i.result)},i.onerror=function(){t(i.error)}})["catch"](t)});return s(t,n),t}function c(n,e){var t=this,r=new l(function(e,r){return 0>n?void e(null):void t.ready().then(function(){var o=t._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=!1,c=i.openCursor();c.onsuccess=function(){var t=c.result;return t?void(0===n?e(t.key):a?e(t.key):(a=!0,t.advance(n))):void e(null)},c.onerror=function(){r(c.error)}})["catch"](r)});return s(r,e),r}function u(n){var e=this,t=new l(function(n,t){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.openCursor(),a=[];i.onsuccess=function(){var e=i.result;return e?(a.push(e.key),void e["continue"]()):void n(a)},i.onerror=function(){t(i.error)}})["catch"](t)});return s(t,n),t}function s(n,e){e&&n.then(function(n){e(null,n)},function(n){e(n)})}function d(n,e){e&&n.then(function(n){f(e,n)},function(n){e(n)})}function f(n,e){return n?setTimeout(function(){return n(null,e)},0):void 0}var l="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,v=v||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(v){var h={_driver:"asyncStorage",_initStorage:n,iterate:t,getItem:e,setItem:r,removeItem:o,clear:i,length:a,key:c,keys:u};"undefined"!=typeof module&&module.exports?module.exports=h:"function"==typeof define&&define.amd?define("asyncStorage",function(){return h}):this.asyncStorage=h}}).call(window);


},{"promise":127}],130:[function(require,module,exports){
(function(){"use strict";function e(e){var r=this,n={};if(e)for(var t in e)n[t]=e[t];n.keyPrefix=n.name+"/",r._dbInfo=n;var i=new l(function(e){g===v.DEFINE?require(["localforageSerializer"],e):e(g===v.EXPORT?require("./../utils/serializer"):c.localforageSerializer)});return i.then(function(e){return d=e,l.resolve()})}function r(e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo.keyPrefix,n=h.length-1;n>=0;n--){var t=h.key(n);0===t.indexOf(e)&&h.removeItem(t)}});return s(n,e),n}function n(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=n.ready().then(function(){var r=n._dbInfo,t=h.getItem(r.keyPrefix+e);return t&&(t=d.deserialize(t)),t});return s(t,r),t}function t(e,r){var n=this,t=n.ready().then(function(){for(var r=n._dbInfo.keyPrefix,t=r.length,i=h.length,o=0;i>o;o++){var a=h.key(o),u=h.getItem(a);if(u&&(u=d.deserialize(u)),u=e(u,a.substring(t),o+1),void 0!==u)return u}});return s(t,r),t}function i(e,r){var n=this,t=n.ready().then(function(){var r,t=n._dbInfo;try{r=h.key(e)}catch(i){r=null}return r&&(r=r.substring(t.keyPrefix.length)),r});return s(t,r),t}function o(e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo,n=h.length,t=[],i=0;n>i;i++)0===h.key(i).indexOf(e.keyPrefix)&&t.push(h.key(i).substring(e.keyPrefix.length));return t});return s(n,e),n}function a(e){var r=this,n=r.keys().then(function(e){return e.length});return s(n,e),n}function u(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=n.ready().then(function(){var r=n._dbInfo;h.removeItem(r.keyPrefix+e)});return s(t,r),t}function f(e,r,n){var t=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=t.ready().then(function(){void 0===r&&(r=null);var n=r;return new l(function(i,o){d.serialize(r,function(r,a){if(a)o(a);else try{var u=t._dbInfo;h.setItem(u.keyPrefix+e,r),i(n)}catch(f){("QuotaExceededError"===f.name||"NS_ERROR_DOM_QUOTA_REACHED"===f.name)&&o(f),o(f)}})})});return s(i,n),i}function s(e,r){r&&e.then(function(e){r(null,e)},function(e){r(e)})}var l="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,c=this,d=null,h=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;h=this.localStorage}catch(y){return}var v={DEFINE:1,EXPORT:2,WINDOW:3},g=v.WINDOW;"undefined"!=typeof module&&module.exports?g=v.EXPORT:"function"==typeof define&&define.amd&&(g=v.DEFINE);var m={_driver:"localStorageWrapper",_initStorage:e,iterate:t,getItem:n,setItem:f,removeItem:u,clear:r,length:a,key:i,keys:o};g===v.EXPORT?module.exports=m:g===v.DEFINE?define("localStorageWrapper",function(){return m}):this.localStorageWrapper=m}).call(window);


},{"./../utils/serializer":133,"promise":127}],131:[function(require,module,exports){
(function(){"use strict";function n(n){var t=this,e={db:null};if(n)for(var i in n)e[i]="string"!=typeof n[i]?n[i].toString():n[i];var o=new s(function(n){h===v.DEFINE?require(["localforageSerializer"],n):n(h===v.EXPORT?require("./../utils/serializer"):d.localforageSerializer)}),r=new s(function(i,o){try{e.db=E(e.name,String(e.version),e.description,e.size)}catch(r){return t.setDriver(t.LOCALSTORAGE).then(function(){return t._initStorage(n)}).then(i)["catch"](o)}e.db.transaction(function(n){n.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=e,i()},function(n,t){o(t)})})});return o.then(function(n){return l=n,r})}function t(n,t){var e=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var i=new s(function(t,i){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[n],function(n,e){var i=e.rows.length?e.rows.item(0).value:null;i&&(i=l.deserialize(i)),t(i)},function(n,t){i(t)})})})["catch"](i)});return f(i,t),i}function e(n,t){var e=this,i=new s(function(t,i){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("SELECT * FROM "+o.storeName,[],function(e,i){for(var o=i.rows,r=o.length,u=0;r>u;u++){var a=o.item(u),c=a.value;if(c&&(c=l.deserialize(c)),c=n(c,a.key,u+1),void 0!==c)return void t(c)}t()},function(n,t){i(t)})})})["catch"](i)});return f(i,t),i}function i(n,t,e){var i=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var o=new s(function(e,o){i.ready().then(function(){void 0===t&&(t=null);var r=t;l.serialize(t,function(t,u){if(u)o(u);else{var a=i._dbInfo;a.db.transaction(function(i){i.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[n,t],function(){e(r)},function(n,t){o(t)})},function(n){n.code===n.QUOTA_ERR&&o(n)})}})})["catch"](o)});return f(o,e),o}function o(n,t){var e=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var i=new s(function(t,i){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[n],function(){t()},function(n,t){i(t)})})})["catch"](i)});return f(i,t),i}function r(n){var t=this,e=new s(function(n,e){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(t){t.executeSql("DELETE FROM "+i.storeName,[],function(){n()},function(n,t){e(t)})})})["catch"](e)});return f(e,n),e}function u(n){var t=this,e=new s(function(n,e){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+i.storeName,[],function(t,e){var i=e.rows.item(0).c;n(i)},function(n,t){e(t)})})})["catch"](e)});return f(e,n),e}function a(n,t){var e=this,i=new s(function(t,i){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[n+1],function(n,e){var i=e.rows.length?e.rows.item(0).key:null;t(i)},function(n,t){i(t)})})})["catch"](i)});return f(i,t),i}function c(n){var t=this,e=new s(function(n,e){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(t){t.executeSql("SELECT key FROM "+i.storeName,[],function(t,e){for(var i=[],o=0;o<e.rows.length;o++)i.push(e.rows.item(o).key);n(i)},function(n,t){e(t)})})})["catch"](e)});return f(e,n),e}function f(n,t){t&&n.then(function(n){t(null,n)},function(n){t(n)})}var s="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,d=this,l=null,E=this.openDatabase;if(E){var v={DEFINE:1,EXPORT:2,WINDOW:3},h=v.WINDOW;"undefined"!=typeof module&&module.exports?h=v.EXPORT:"function"==typeof define&&define.amd&&(h=v.DEFINE);var S={_driver:"webSQLStorage",_initStorage:n,iterate:e,getItem:t,setItem:i,removeItem:o,clear:r,length:u,key:a,keys:c};h===v.DEFINE?define("webSQLStorage",function(){return S}):h===v.EXPORT?module.exports=S:this.webSQLStorage=S}}).call(window);


},{"./../utils/serializer":133,"promise":127}],132:[function(require,module,exports){
(function(){"use strict";function e(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}function r(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var t in r)r.hasOwnProperty(t)&&(arguments[0][t]=v(r[t])?r[t].slice():r[t])}return arguments[0]}function t(e){for(var r in a)if(a.hasOwnProperty(r)&&a[r]===e)return!0;return!1}function n(t){this._config=r({},d,t),this._driverSet=null,this._ready=!1,this._dbInfo=null;for(var n=0;n<s.length;n++)e(this,s[n]);this.setDriver(this._config.driver)}var i="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,o={},a={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},u=[a.INDEXEDDB,a.WEBSQL,a.LOCALSTORAGE],s=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],f={DEFINE:1,EXPORT:2,WINDOW:3},d={description:"",driver:u.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},c=f.WINDOW;"undefined"!=typeof module&&module.exports?c=f.EXPORT:"function"==typeof define&&define.amd&&(c=f.DEFINE);var p=function(e){var r=r||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB,t={};return t[a.WEBSQL]=!!e.openDatabase,t[a.INDEXEDDB]=!!function(){if("undefined"!=typeof e.openDatabase&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent))return!1;try{return r&&"function"==typeof r.open&&"undefined"!=typeof e.IDBKeyRange}catch(t){return!1}}(),t[a.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(r){return!1}}(),t}(this),v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=this;n.prototype.INDEXEDDB=a.INDEXEDDB,n.prototype.LOCALSTORAGE=a.LOCALSTORAGE,n.prototype.WEBSQL=a.WEBSQL,n.prototype.config=function(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var r in e)"storeName"===r&&(e[r]=e[r].replace(/\W/g,"_")),this._config[r]=e[r];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},n.prototype.defineDriver=function(e,r,n){var a=new i(function(r,n){try{var a=e._driver,u=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),f=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(u);if(t(e._driver))return void n(f);for(var d=s.concat("_initStorage"),c=0;c<d.length;c++){var v=d[c];if(!v||!e[v]||"function"!=typeof e[v])return void n(u)}var l=i.resolve(!0);"_support"in e&&(l=e._support&&"function"==typeof e._support?e._support():i.resolve(!!e._support)),l.then(function(t){p[a]=t,o[a]=e,r()},n)}catch(g){n(g)}});return a.then(r,n),a},n.prototype.driver=function(){return this._driver||null},n.prototype.ready=function(e){var r=this,t=new i(function(e,t){r._driverSet.then(function(){null===r._ready&&(r._ready=r._initStorage(r._config)),r._ready.then(e,t)})["catch"](t)});return t.then(e,e),t},n.prototype.setDriver=function(e,r,n){function a(){u._config.driver=u.driver()}var u=this;return"string"==typeof e&&(e=[e]),this._driverSet=new i(function(r,n){var a=u._getFirstSupportedDriver(e),s=new Error("No available storage method found.");if(!a)return u._driverSet=i.reject(s),void n(s);if(u._dbInfo=null,u._ready=null,t(a)){if(c===f.DEFINE)return void require([a],function(e){u._extend(e),r()});if(c===f.EXPORT){var d;switch(a){case u.INDEXEDDB:d=require("./drivers/indexeddb");break;case u.LOCALSTORAGE:d=require("./drivers/localstorage");break;case u.WEBSQL:d=require("./drivers/websql")}u._extend(d)}else u._extend(l[a])}else{if(!o[a])return u._driverSet=i.reject(s),void n(s);u._extend(o[a])}r()}),this._driverSet.then(a,a),this._driverSet.then(r,n),this._driverSet},n.prototype.supports=function(e){return!!p[e]},n.prototype._extend=function(e){r(this,e)},n.prototype._getFirstSupportedDriver=function(e){if(e&&v(e))for(var r=0;r<e.length;r++){var t=e[r];if(this.supports(t))return t}return null},n.prototype.createInstance=function(e){return new n(e)};var g=new n;c===f.DEFINE?define("localforage",function(){return g}):c===f.EXPORT?module.exports=g:this.localforage=g}).call(window);


},{"./drivers/indexeddb":129,"./drivers/localstorage":130,"./drivers/websql":131,"promise":127}],133:[function(require,module,exports){
(function(){"use strict";function r(r,e){var n="";if(r&&(n=r.toString()),r&&("[object ArrayBuffer]"===r.toString()||r.buffer&&"[object ArrayBuffer]"===r.buffer.toString())){var a,o=i;r instanceof ArrayBuffer?(a=r,o+=f):(a=r.buffer,"[object Int8Array]"===n?o+=l:"[object Uint8Array]"===n?o+=s:"[object Uint8ClampedArray]"===n?o+=c:"[object Int16Array]"===n?o+=y:"[object Uint16Array]"===n?o+=b:"[object Int32Array]"===n?o+=A:"[object Uint32Array]"===n?o+=g:"[object Float32Array]"===n?o+=d:"[object Float64Array]"===n?o+=w:e(new Error("Failed to get type for BinaryArray"))),e(o+t(a))}else if("[object Blob]"===n){var h=new FileReader;h.onload=function(){var r=t(this.result);e(i+u+r)},h.readAsArrayBuffer(r)}else try{e(JSON.stringify(r))}catch(j){window.console.error("Couldn't convert value into a JSON string: ",r),e(null,j)}}function e(r){if(r.substring(0,o)!==i)return JSON.parse(r);var e=r.substring(h),t=r.substring(o,h),a=n(e);switch(t){case f:return a;case u:return new Blob([a]);case l:return new Int8Array(a);case s:return new Uint8Array(a);case c:return new Uint8ClampedArray(a);case y:return new Int16Array(a);case b:return new Uint16Array(a);case A:return new Int32Array(a);case g:return new Uint32Array(a);case d:return new Float32Array(a);case w:return new Float64Array(a);default:throw new Error("Unkown type: "+t)}}function n(r){var e,n,t,i,o,f=.75*r.length,u=r.length,l=0;"="===r[r.length-1]&&(f--,"="===r[r.length-2]&&f--);var s=new ArrayBuffer(f),c=new Uint8Array(s);for(e=0;u>e;e+=4)n=a.indexOf(r[e]),t=a.indexOf(r[e+1]),i=a.indexOf(r[e+2]),o=a.indexOf(r[e+3]),c[l++]=n<<2|t>>4,c[l++]=(15&t)<<4|i>>2,c[l++]=(3&i)<<6|63&o;return s}function t(r){var e,n=new Uint8Array(r),t="";for(e=0;e<n.length;e+=3)t+=a[n[e]>>2],t+=a[(3&n[e])<<4|n[e+1]>>4],t+=a[(15&n[e+1])<<2|n[e+2]>>6],t+=a[63&n[e+2]];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="__lfsc__:",o=i.length,f="arbf",u="blob",l="si08",s="ui08",c="uic8",y="si16",A="si32",b="ur16",g="ui32",d="fl32",w="fl64",h=o+f.length,j={serialize:r,deserialize:e,stringToBuffer:n,bufferToString:t};"undefined"!=typeof module&&module.exports?module.exports=j:"function"==typeof define&&define.amd?define("localforageSerializer",function(){return j}):this.localforageSerializer=j}).call(window);


},{}],134:[function(require,module,exports){
var Extend=require("lodash.assign"),delta=function(t,n){return function(){var e,a;return e=Date.now(),a=e-this.now,a=Math.min(a,t),a=Math.max(a,n),this.elapsed+=a,this.now=e,a}},start=function(){this.now=Date.now()},reset=function(){this.now=0,this.elapsed=0},getValue=function(t){return function(){return this[t]}},clock=function(t){var n=Extend({maxDt:60,minDt:16.66666667,autostart:!1},t),e=Object.preventExtensions({now:0,elapsed:0});return n.autostart!==!1&&start.bind(e)(),{start:start.bind(e),reset:reset.bind(e),now:getValue("now").bind(e),elapsed:getValue("elapsed").bind(e),delta:delta(n.maxDt,n.minDt).bind(e)}};module.exports=clock;


},{"lodash.assign":136}],135:[function(require,module,exports){
var raf=require("raf"),EventEmitter=require("events").EventEmitter,Extend=require("lodash.assign"),clock=require("./clock")(),start=function(t,e){return function(){this.started||(this.clockStarted||e.start(),t(),this.started=!0)}},stop=function(){raf.cancel(this.rafHandle),this.started=!1},createLoop=function(t,e,r){return function n(){this.rafHandle=raf(n.bind(this));var i=e.delta(),a=r({dt:i,unitDt:i/16.66666667,now:e.now(),elapsed:e.elapsed()});t.emit("update",a),t.emit("draw",a)}},passThrough=function(t){return t};module.exports=function(t){var e=Extend({emitter:new EventEmitter,customizeEvent:passThrough},t),r=Object.preventExtensions({clockStarted:!1,started:!1,rafHandle:null}),n=createLoop(e.emitter,clock,e.customizeEvent).bind(r);return{start:start(n,clock).bind(r),stop:stop.bind(r),reset:clock.reset,emitter:e.emitter}};


},{"./clock":134,"events":196,"lodash.assign":136,"raf":147}],136:[function(require,module,exports){
function assignWith(e,t,r){var s=keys(t);push.apply(s,getSymbols(t));for(var n=-1,o=s.length;++n<o;){var i=s[n],a=e[i],u=r(a,t[i],i,e,t);(u===u?u===a:a!==a)&&(void 0!==a||i in e)||(e[i]=u)}return e}function toObject(e){return isObject(e)?e:Object(e)}function isObject(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function constant(e){return function(){return e}}var baseAssign=require("lodash._baseassign"),createAssigner=require("lodash._createassigner"),isNative=require("lodash.isnative"),keys=require("lodash.keys"),arrayProto=Array.prototype,getOwnPropertySymbols=isNative(getOwnPropertySymbols=Object.getOwnPropertySymbols)&&getOwnPropertySymbols,push=arrayProto.push,getSymbols=getOwnPropertySymbols?function(e){return getOwnPropertySymbols(toObject(e))}:constant([]),assign=createAssigner(function(e,t,r){return r?assignWith(e,t,r):baseAssign(e,t)});module.exports=assign;


},{"lodash._baseassign":137,"lodash._createassigner":139,"lodash.isnative":143,"lodash.keys":144}],137:[function(require,module,exports){
function toObject(e){return isObject(e)?e:Object(e)}function isObject(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function constant(e){return function(){return e}}var baseCopy=require("lodash._basecopy"),isNative=require("lodash.isnative"),keys=require("lodash.keys"),getOwnPropertySymbols=isNative(getOwnPropertySymbols=Object.getOwnPropertySymbols)&&getOwnPropertySymbols,baseAssign=function(e,t){return null==t?e:baseCopy(t,getSymbols(t),baseCopy(t,keys(t),e))},getSymbols=getOwnPropertySymbols?function(e){return getOwnPropertySymbols(toObject(e))}:constant([]);module.exports=baseAssign;


},{"lodash._basecopy":138,"lodash.isnative":143,"lodash.keys":144}],138:[function(require,module,exports){
function baseCopy(e,o,r){r||(r={});for(var a=-1,n=o.length;++a<n;){var t=o[a];r[t]=e[t]}return r}module.exports=baseCopy;


},{}],139:[function(require,module,exports){
function createAssigner(e){return restParam(function(r,a){var l=-1,t=null==r?0:a.length,n=t>2&&a[t-2],i=t>2&&a[2],s=t>1&&a[t-1];for("function"==typeof n?(n=bindCallback(n,s,5),t-=2):(n="function"==typeof s?s:null,t-=n?1:0),i&&isIterateeCall(a[0],a[1],i)&&(n=3>t?null:n,t=1);++l<t;){var u=a[l];u&&e(r,u,n)}return r})}var bindCallback=require("lodash._bindcallback"),isIterateeCall=require("lodash._isiterateecall"),restParam=require("lodash.restparam");module.exports=createAssigner;


},{"lodash._bindcallback":140,"lodash._isiterateecall":141,"lodash.restparam":142}],140:[function(require,module,exports){
function bindCallback(n,t,r){if("function"!=typeof n)return identity;if(void 0===t)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,c){return n.call(t,r,e,u,c)};case 5:return function(r,e,u,c,i){return n.call(t,r,e,u,c,i)}}return function(){return n.apply(t,arguments)}}function identity(n){return n}module.exports=bindCallback;


},{}],141:[function(require,module,exports){
function baseProperty(e){return function(n){return null==n?void 0:n[e]}}function isArrayLike(e){return null!=e&&isLength(getLength(e))}function isIndex(e,n){return e=+e,n=null==n?MAX_SAFE_INTEGER:n,e>-1&&e%1==0&&n>e}function isIterateeCall(e,n,t){if(!isObject(t))return!1;var r=typeof n;if("number"==r?isArrayLike(t)&&isIndex(n,t.length):"string"==r&&n in t){var i=t[n];return e===e?e===i:i!==i}return!1}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&MAX_SAFE_INTEGER>=e}function isObject(e){var n=typeof e;return"function"==n||!!e&&"object"==n}var MAX_SAFE_INTEGER=Math.pow(2,53)-1,getLength=baseProperty("length");module.exports=isIterateeCall;


},{}],142:[function(require,module,exports){
function restParam(r,t){if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT);return t=nativeMax(void 0===t?r.length-1:+t||0,0),function(){for(var a=arguments,e=-1,n=nativeMax(a.length-t,0),i=Array(n);++e<n;)i[e]=a[t+e];switch(t){case 0:return r.call(this,i);case 1:return r.call(this,a[0],i);case 2:return r.call(this,a[0],a[1],i)}var c=Array(t+1);for(e=-1;++e<t;)c[e]=a[e];return c[t]=i,r.apply(this,c)}}var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=restParam;


},{}],143:[function(require,module,exports){
function baseToString(t){return"string"==typeof t?t:null==t?"":t+""}function isObjectLike(t){return!!t&&"object"==typeof t}function isNative(t){return null==t?!1:objToString.call(t)==funcTag?reIsNative.test(fnToString.call(t)):isObjectLike(t)&&reIsHostCtor.test(t)}function escapeRegExp(t){return t=baseToString(t),t&&reHasRegExpChars.test(t)?t.replace(reRegExpChars,"\\$&"):t}var funcTag="[object Function]",reRegExpChars=/[.*+?^${}()|[\]\/\\]/g,reHasRegExpChars=RegExp(reRegExpChars.source),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,objToString=objectProto.toString,reIsNative=RegExp("^"+escapeRegExp(objToString).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=isNative;


},{}],144:[function(require,module,exports){
function baseProperty(r){return function(t){return null==t?void 0:t[r]}}function isArrayLike(r){return null!=r&&isLength(getLength(r))}function isIndex(r,t){return r=+r,t=null==t?MAX_SAFE_INTEGER:t,r>-1&&r%1==0&&t>r}function isLength(r){return"number"==typeof r&&r>-1&&r%1==0&&MAX_SAFE_INTEGER>=r}function shimKeys(r){for(var t=keysIn(r),e=t.length,n=e&&r.length,o=n&&isLength(n)&&(isArray(r)||support.nonEnumArgs&&isArguments(r)),s=-1,i=[];++s<e;){var u=t[s];(o&&isIndex(u,n)||hasOwnProperty.call(r,u))&&i.push(u)}return i}function isObject(r){var t=typeof r;return"function"==t||!!r&&"object"==t}function keysIn(r){if(null==r)return[];isObject(r)||(r=Object(r));var t=r.length;t=t&&isLength(t)&&(isArray(r)||support.nonEnumArgs&&isArguments(r))&&t||0;for(var e=r.constructor,n=-1,o="function"==typeof e&&e.prototype===r,s=Array(t),i=t>0;++n<t;)s[n]=n+"";for(var u in r)i&&isIndex(u,t)||"constructor"==u&&(o||!hasOwnProperty.call(r,u))||s.push(u);return s}var isArguments=require("lodash.isarguments"),isArray=require("lodash.isarray"),isNative=require("lodash.isnative"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,MAX_SAFE_INTEGER=Math.pow(2,53)-1,support={};!function(r){var t=function(){this.x=r},e=arguments,n=[];t.prototype={valueOf:r,y:r};for(var o in new t)n.push(o);try{support.nonEnumArgs=!propertyIsEnumerable.call(e,1)}catch(s){support.nonEnumArgs=!0}}(1,0);var getLength=baseProperty("length"),keys=nativeKeys?function(r){var t=null!=r&&r.constructor;return"function"==typeof t&&t.prototype===r||"function"!=typeof r&&isArrayLike(r)?shimKeys(r):isObject(r)?nativeKeys(r):[]}:shimKeys;module.exports=keys;


},{"lodash.isarguments":145,"lodash.isarray":146,"lodash.isnative":143}],145:[function(require,module,exports){
function isObjectLike(t){return!!t&&"object"==typeof t}function baseProperty(t){return function(e){return null==e?void 0:e[t]}}function isArrayLike(t){return null!=t&&isLength(getLength(t))}function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&MAX_SAFE_INTEGER>=t}function isArguments(t){return isObjectLike(t)&&isArrayLike(t)&&objToString.call(t)==argsTag}var argsTag="[object Arguments]",objectProto=Object.prototype,objToString=objectProto.toString,MAX_SAFE_INTEGER=Math.pow(2,53)-1,getLength=baseProperty("length");module.exports=isArguments;


},{}],146:[function(require,module,exports){
function baseToString(r){return"string"==typeof r?r:null==r?"":r+""}function isObjectLike(r){return!!r&&"object"==typeof r}function isLength(r){return"number"==typeof r&&r>-1&&r%1==0&&MAX_SAFE_INTEGER>=r}function isNative(r){return null==r?!1:objToString.call(r)==funcTag?reIsNative.test(fnToString.call(r)):isObjectLike(r)&&reIsHostCtor.test(r)}function escapeRegExp(r){return r=baseToString(r),r&&reHasRegExpChars.test(r)?r.replace(reRegExpChars,"\\$&"):r}var arrayTag="[object Array]",funcTag="[object Function]",reRegExpChars=/[.*+?^${}()|[\]\/\\]/g,reHasRegExpChars=RegExp(reRegExpChars.source),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,objToString=objectProto.toString,reIsNative=RegExp("^"+escapeRegExp(objToString).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,MAX_SAFE_INTEGER=Math.pow(2,53)-1,isArray=nativeIsArray||function(r){return isObjectLike(r)&&isLength(r.length)&&objToString.call(r)==arrayTag};module.exports=isArray;


},{}],147:[function(require,module,exports){
for(var now=require("performance-now"),global="undefined"==typeof window?{}:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=global["request"+suffix],caf=global["cancel"+suffix]||global["cancelRequest"+suffix],isNative=!0,i=0;i<vendors.length&&!raf;i++)raf=global[vendors[i]+"Request"+suffix],caf=global[vendors[i]+"Cancel"+suffix]||global[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){isNative=!1;var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(e){if(0===queue.length){var a=now(),l=Math.max(0,frameDuration-(a-last));last=l+a,setTimeout(function(){var e=queue.slice(0);queue.length=0;for(var a=0;a<e.length;a++)if(!e[a].cancelled)try{e[a].callback(last)}catch(l){setTimeout(function(){throw l},0)}},Math.round(l))}return queue.push({handle:++id,callback:e,cancelled:!1}),id},caf=function(e){for(var a=0;a<queue.length;a++)queue[a].handle===e&&(queue[a].cancelled=!0)}}module.exports=function(e){return isNative?raf.call(global,function(){e.apply(this,arguments)}):raf.call(global,e)},module.exports.cancel=function(){caf.apply(global,arguments)};


},{"performance-now":148}],148:[function(require,module,exports){
(function (process){
(function(){var e,n,r;"undefined"!=typeof performance&&null!==performance&&performance.now?module.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(module.exports=function(){return(e()-r)/1e6},n=process.hrtime,e=function(){var e;return e=n(),1e9*e[0]+e[1]},r=e()):Date.now?(module.exports=function(){return Date.now()-r},r=Date.now()):(module.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this);


}).call(this,require('_process'))

},{"_process":197}],149:[function(require,module,exports){
var EventEmitter=require("events").EventEmitter,IsObject=require("lodash.isobject"),Each=require("lodash.foreach"),Extend=require("lodash.assign"),load=function(e,t,n,r){return function(s){var i=this.slug,a=e[s],o=this.manifest;if(!IsObject(a))return!1;this.slug&&r.emit("unload",{slug:i,manifest:o});var u=n(a,s);return parseManifest(t,u),parseManifest(a,u),this.manifest=a,this.slug=s,r.emit("load",{slug:s,globalManifest:t,manifest:a,graph:u}),!0}},parseManifest=function(e,t){return Each(e.components,function(e,n){var r;IsObject(e)?(r=IsObject(e.properties)?e.properties:{},t[n]=IsObject(e["function"])?e["function"](t,r):IsObject(e.construct)?new e.construct(t,r):e):t[n]=e}),t},createBlankObject=function(){return{}};module.exports=function(e,t){var n=Extend({globalManifest:{},getGraph:createBlankObject,emitter:new EventEmitter},t),r=Object.preventExtensions({slug:null,manifest:null});return{load:load(e,n.globalManifest,n.getGraph,n.emitter).bind(r),emitter:n.emitter}};


},{"events":196,"lodash.assign":150,"lodash.foreach":161,"lodash.isobject":169}],150:[function(require,module,exports){
function assignWith(e,t,r){var s=keys(t);push.apply(s,getSymbols(t));for(var n=-1,o=s.length;++n<o;){var i=s[n],a=e[i],u=r(a,t[i],i,e,t);(u===u?u===a:a!==a)&&(void 0!==a||i in e)||(e[i]=u)}return e}function toObject(e){return isObject(e)?e:Object(e)}function isObject(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function constant(e){return function(){return e}}var baseAssign=require("lodash._baseassign"),createAssigner=require("lodash._createassigner"),isNative=require("lodash.isnative"),keys=require("lodash.keys"),arrayProto=Array.prototype,getOwnPropertySymbols=isNative(getOwnPropertySymbols=Object.getOwnPropertySymbols)&&getOwnPropertySymbols,push=arrayProto.push,getSymbols=getOwnPropertySymbols?function(e){return getOwnPropertySymbols(toObject(e))}:constant([]),assign=createAssigner(function(e,t,r){return r?assignWith(e,t,r):baseAssign(e,t)});module.exports=assign;


},{"lodash._baseassign":151,"lodash._createassigner":153,"lodash.isnative":157,"lodash.keys":158}],151:[function(require,module,exports){
function toObject(e){return isObject(e)?e:Object(e)}function isObject(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function constant(e){return function(){return e}}var baseCopy=require("lodash._basecopy"),isNative=require("lodash.isnative"),keys=require("lodash.keys"),getOwnPropertySymbols=isNative(getOwnPropertySymbols=Object.getOwnPropertySymbols)&&getOwnPropertySymbols,baseAssign=function(e,t){return null==t?e:baseCopy(t,getSymbols(t),baseCopy(t,keys(t),e))},getSymbols=getOwnPropertySymbols?function(e){return getOwnPropertySymbols(toObject(e))}:constant([]);module.exports=baseAssign;


},{"lodash._basecopy":152,"lodash.isnative":157,"lodash.keys":158}],152:[function(require,module,exports){
function baseCopy(e,o,r){r||(r={});for(var a=-1,n=o.length;++a<n;){var t=o[a];r[t]=e[t]}return r}module.exports=baseCopy;


},{}],153:[function(require,module,exports){
function createAssigner(e){return restParam(function(r,a){var l=-1,t=null==r?0:a.length,n=t>2&&a[t-2],i=t>2&&a[2],s=t>1&&a[t-1];for("function"==typeof n?(n=bindCallback(n,s,5),t-=2):(n="function"==typeof s?s:null,t-=n?1:0),i&&isIterateeCall(a[0],a[1],i)&&(n=3>t?null:n,t=1);++l<t;){var u=a[l];u&&e(r,u,n)}return r})}var bindCallback=require("lodash._bindcallback"),isIterateeCall=require("lodash._isiterateecall"),restParam=require("lodash.restparam");module.exports=createAssigner;


},{"lodash._bindcallback":154,"lodash._isiterateecall":155,"lodash.restparam":156}],154:[function(require,module,exports){
function bindCallback(n,t,r){if("function"!=typeof n)return identity;if(void 0===t)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,c){return n.call(t,r,e,u,c)};case 5:return function(r,e,u,c,i){return n.call(t,r,e,u,c,i)}}return function(){return n.apply(t,arguments)}}function identity(n){return n}module.exports=bindCallback;


},{}],155:[function(require,module,exports){
function baseProperty(e){return function(n){return null==n?void 0:n[e]}}function isArrayLike(e){return null!=e&&isLength(getLength(e))}function isIndex(e,n){return e=+e,n=null==n?MAX_SAFE_INTEGER:n,e>-1&&e%1==0&&n>e}function isIterateeCall(e,n,t){if(!isObject(t))return!1;var r=typeof n;if("number"==r?isArrayLike(t)&&isIndex(n,t.length):"string"==r&&n in t){var i=t[n];return e===e?e===i:i!==i}return!1}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&MAX_SAFE_INTEGER>=e}function isObject(e){var n=typeof e;return"function"==n||!!e&&"object"==n}var MAX_SAFE_INTEGER=Math.pow(2,53)-1,getLength=baseProperty("length");module.exports=isIterateeCall;


},{}],156:[function(require,module,exports){
function restParam(r,t){if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT);return t=nativeMax(void 0===t?r.length-1:+t||0,0),function(){for(var a=arguments,e=-1,n=nativeMax(a.length-t,0),i=Array(n);++e<n;)i[e]=a[t+e];switch(t){case 0:return r.call(this,i);case 1:return r.call(this,a[0],i);case 2:return r.call(this,a[0],a[1],i)}var c=Array(t+1);for(e=-1;++e<t;)c[e]=a[e];return c[t]=i,r.apply(this,c)}}var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=restParam;


},{}],157:[function(require,module,exports){
function baseToString(t){return"string"==typeof t?t:null==t?"":t+""}function isObjectLike(t){return!!t&&"object"==typeof t}function isNative(t){return null==t?!1:objToString.call(t)==funcTag?reIsNative.test(fnToString.call(t)):isObjectLike(t)&&reIsHostCtor.test(t)}function escapeRegExp(t){return t=baseToString(t),t&&reHasRegExpChars.test(t)?t.replace(reRegExpChars,"\\$&"):t}var funcTag="[object Function]",reRegExpChars=/[.*+?^${}()|[\]\/\\]/g,reHasRegExpChars=RegExp(reRegExpChars.source),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,objToString=objectProto.toString,reIsNative=RegExp("^"+escapeRegExp(objToString).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=isNative;


},{}],158:[function(require,module,exports){
function baseProperty(r){return function(t){return null==t?void 0:t[r]}}function isArrayLike(r){return null!=r&&isLength(getLength(r))}function isIndex(r,t){return r=+r,t=null==t?MAX_SAFE_INTEGER:t,r>-1&&r%1==0&&t>r}function isLength(r){return"number"==typeof r&&r>-1&&r%1==0&&MAX_SAFE_INTEGER>=r}function shimKeys(r){for(var t=keysIn(r),e=t.length,n=e&&r.length,o=n&&isLength(n)&&(isArray(r)||support.nonEnumArgs&&isArguments(r)),s=-1,i=[];++s<e;){var u=t[s];(o&&isIndex(u,n)||hasOwnProperty.call(r,u))&&i.push(u)}return i}function isObject(r){var t=typeof r;return"function"==t||!!r&&"object"==t}function keysIn(r){if(null==r)return[];isObject(r)||(r=Object(r));var t=r.length;t=t&&isLength(t)&&(isArray(r)||support.nonEnumArgs&&isArguments(r))&&t||0;for(var e=r.constructor,n=-1,o="function"==typeof e&&e.prototype===r,s=Array(t),i=t>0;++n<t;)s[n]=n+"";for(var u in r)i&&isIndex(u,t)||"constructor"==u&&(o||!hasOwnProperty.call(r,u))||s.push(u);return s}var isArguments=require("lodash.isarguments"),isArray=require("lodash.isarray"),isNative=require("lodash.isnative"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,MAX_SAFE_INTEGER=Math.pow(2,53)-1,support={};!function(r){var t=function(){this.x=r},e=arguments,n=[];t.prototype={valueOf:r,y:r};for(var o in new t)n.push(o);try{support.nonEnumArgs=!propertyIsEnumerable.call(e,1)}catch(s){support.nonEnumArgs=!0}}(1,0);var getLength=baseProperty("length"),keys=nativeKeys?function(r){var t=null!=r&&r.constructor;return"function"==typeof t&&t.prototype===r||"function"!=typeof r&&isArrayLike(r)?shimKeys(r):isObject(r)?nativeKeys(r):[]}:shimKeys;module.exports=keys;


},{"lodash.isarguments":159,"lodash.isarray":160,"lodash.isnative":157}],159:[function(require,module,exports){
function isObjectLike(t){return!!t&&"object"==typeof t}function baseProperty(t){return function(e){return null==e?void 0:e[t]}}function isArrayLike(t){return null!=t&&isLength(getLength(t))}function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&MAX_SAFE_INTEGER>=t}function isArguments(t){return isObjectLike(t)&&isArrayLike(t)&&objToString.call(t)==argsTag}var argsTag="[object Arguments]",objectProto=Object.prototype,objToString=objectProto.toString,MAX_SAFE_INTEGER=Math.pow(2,53)-1,getLength=baseProperty("length");module.exports=isArguments;


},{}],160:[function(require,module,exports){
function baseToString(r){return"string"==typeof r?r:null==r?"":r+""}function isObjectLike(r){return!!r&&"object"==typeof r}function isLength(r){return"number"==typeof r&&r>-1&&r%1==0&&MAX_SAFE_INTEGER>=r}function isNative(r){return null==r?!1:objToString.call(r)==funcTag?reIsNative.test(fnToString.call(r)):isObjectLike(r)&&reIsHostCtor.test(r)}function escapeRegExp(r){return r=baseToString(r),r&&reHasRegExpChars.test(r)?r.replace(reRegExpChars,"\\$&"):r}var arrayTag="[object Array]",funcTag="[object Function]",reRegExpChars=/[.*+?^${}()|[\]\/\\]/g,reHasRegExpChars=RegExp(reRegExpChars.source),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,objToString=objectProto.toString,reIsNative=RegExp("^"+escapeRegExp(objToString).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,MAX_SAFE_INTEGER=Math.pow(2,53)-1,isArray=nativeIsArray||function(r){return isObjectLike(r)&&isLength(r.length)&&objToString.call(r)==arrayTag};module.exports=isArray;


},{}],161:[function(require,module,exports){
function createForEach(a,r){return function(e,c,o){return"function"==typeof c&&void 0===o&&isArray(e)?a(e,c):r(e,bindCallback(c,o,3))}}var arrayEach=require("lodash._arrayeach"),baseEach=require("lodash._baseeach"),bindCallback=require("lodash._bindcallback"),isArray=require("lodash.isarray"),forEach=createForEach(arrayEach,baseEach);module.exports=forEach;


},{"lodash._arrayeach":162,"lodash._baseeach":163,"lodash._bindcallback":167,"lodash.isarray":168}],162:[function(require,module,exports){
function arrayEach(r,a){for(var e=-1,n=r.length;++e<n&&a(r[e],e,r)!==!1;);return r}module.exports=arrayEach;


},{}],163:[function(require,module,exports){
function baseForOwn(e,t){return baseFor(e,t,keys)}function baseProperty(e){return function(t){return null==t?void 0:t[e]}}function createBaseEach(e,t){return function(r,n){var o=r?getLength(r):0;if(!isLength(o))return e(r,n);for(var a=t?o:-1,c=toObject(r);(t?a--:++a<o)&&n(c[a],a,c)!==!1;);return r}}function createBaseFor(e){return function(t,r,n){for(var o=toObject(t),a=n(t),c=a.length,u=e?c:-1;e?u--:++u<c;){var s=a[u];if(r(o[s],s,o)===!1)break}return t}}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&MAX_SAFE_INTEGER>=e}function toObject(e){return isObject(e)?e:Object(e)}function isObject(e){var t=typeof e;return"function"==t||!!e&&"object"==t}var keys=require("lodash.keys"),MAX_SAFE_INTEGER=Math.pow(2,53)-1,baseEach=createBaseEach(baseForOwn),baseFor=createBaseFor(),getLength=baseProperty("length");module.exports=baseEach;


},{"lodash.keys":164}],164:[function(require,module,exports){
function baseProperty(r){return function(t){return null==t?void 0:t[r]}}function isArrayLike(r){return null!=r&&isLength(getLength(r))}function isIndex(r,t){return r=+r,t=null==t?MAX_SAFE_INTEGER:t,r>-1&&r%1==0&&t>r}function isLength(r){return"number"==typeof r&&r>-1&&r%1==0&&MAX_SAFE_INTEGER>=r}function shimKeys(r){for(var t=keysIn(r),e=t.length,n=e&&r.length,o=n&&isLength(n)&&(isArray(r)||support.nonEnumArgs&&isArguments(r)),s=-1,i=[];++s<e;){var u=t[s];(o&&isIndex(u,n)||hasOwnProperty.call(r,u))&&i.push(u)}return i}function isObject(r){var t=typeof r;return"function"==t||!!r&&"object"==t}function keysIn(r){if(null==r)return[];isObject(r)||(r=Object(r));var t=r.length;t=t&&isLength(t)&&(isArray(r)||support.nonEnumArgs&&isArguments(r))&&t||0;for(var e=r.constructor,n=-1,o="function"==typeof e&&e.prototype===r,s=Array(t),i=t>0;++n<t;)s[n]=n+"";for(var u in r)i&&isIndex(u,t)||"constructor"==u&&(o||!hasOwnProperty.call(r,u))||s.push(u);return s}var isArguments=require("lodash.isarguments"),isArray=require("lodash.isarray"),isNative=require("lodash.isnative"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,MAX_SAFE_INTEGER=Math.pow(2,53)-1,support={};!function(r){var t=function(){this.x=r},e=arguments,n=[];t.prototype={valueOf:r,y:r};for(var o in new t)n.push(o);try{support.nonEnumArgs=!propertyIsEnumerable.call(e,1)}catch(s){support.nonEnumArgs=!0}}(1,0);var getLength=baseProperty("length"),keys=nativeKeys?function(r){var t=null!=r&&r.constructor;return"function"==typeof t&&t.prototype===r||"function"!=typeof r&&isArrayLike(r)?shimKeys(r):isObject(r)?nativeKeys(r):[]}:shimKeys;module.exports=keys;


},{"lodash.isarguments":165,"lodash.isarray":168,"lodash.isnative":166}],165:[function(require,module,exports){
function isObjectLike(t){return!!t&&"object"==typeof t}function baseProperty(t){return function(e){return null==e?void 0:e[t]}}function isArrayLike(t){return null!=t&&isLength(getLength(t))}function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&MAX_SAFE_INTEGER>=t}function isArguments(t){return isObjectLike(t)&&isArrayLike(t)&&objToString.call(t)==argsTag}var argsTag="[object Arguments]",objectProto=Object.prototype,objToString=objectProto.toString,MAX_SAFE_INTEGER=Math.pow(2,53)-1,getLength=baseProperty("length");module.exports=isArguments;


},{}],166:[function(require,module,exports){
function baseToString(t){return"string"==typeof t?t:null==t?"":t+""}function isObjectLike(t){return!!t&&"object"==typeof t}function isNative(t){return null==t?!1:objToString.call(t)==funcTag?reIsNative.test(fnToString.call(t)):isObjectLike(t)&&reIsHostCtor.test(t)}function escapeRegExp(t){return t=baseToString(t),t&&reHasRegExpChars.test(t)?t.replace(reRegExpChars,"\\$&"):t}var funcTag="[object Function]",reRegExpChars=/[.*+?^${}()|[\]\/\\]/g,reHasRegExpChars=RegExp(reRegExpChars.source),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,objToString=objectProto.toString,reIsNative=RegExp("^"+escapeRegExp(objToString).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=isNative;


},{}],167:[function(require,module,exports){
function bindCallback(n,t,r){if("function"!=typeof n)return identity;if(void 0===t)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,c){return n.call(t,r,e,u,c)};case 5:return function(r,e,u,c,i){return n.call(t,r,e,u,c,i)}}return function(){return n.apply(t,arguments)}}function identity(n){return n}module.exports=bindCallback;


},{}],168:[function(require,module,exports){
function baseToString(r){return"string"==typeof r?r:null==r?"":r+""}function isObjectLike(r){return!!r&&"object"==typeof r}function isLength(r){return"number"==typeof r&&r>-1&&r%1==0&&MAX_SAFE_INTEGER>=r}function isNative(r){return null==r?!1:objToString.call(r)==funcTag?reIsNative.test(fnToString.call(r)):isObjectLike(r)&&reIsHostCtor.test(r)}function escapeRegExp(r){return r=baseToString(r),r&&reHasRegExpChars.test(r)?r.replace(reRegExpChars,"\\$&"):r}var arrayTag="[object Array]",funcTag="[object Function]",reRegExpChars=/[.*+?^${}()|[\]\/\\]/g,reHasRegExpChars=RegExp(reRegExpChars.source),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,objToString=objectProto.toString,reIsNative=RegExp("^"+escapeRegExp(objToString).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,MAX_SAFE_INTEGER=Math.pow(2,53)-1,isArray=nativeIsArray||function(r){return isObjectLike(r)&&isLength(r.length)&&objToString.call(r)==arrayTag};module.exports=isArray;


},{}],169:[function(require,module,exports){
function isObject(t){var e=typeof t;return"function"==e||!!t&&"object"==e}module.exports=isObject;


},{}],170:[function(require,module,exports){
var _=require("lodash"),colors={hexToArray:function(r){var o=colors.hexToString(r);return[parseInt(o[1]+o[2],16),parseInt(o[3]+o[4],16),parseInt(o[5]+o[6],16)]},arrayToHex:function(r){var o=_.map(r,function(r){var o=parseInt(r,10).toString(16);return o.length>1?o:"0"+o}).join("");return parseInt(o,16)},lightness:function(r,o){if("number"!=typeof r)throw new Error("hexColor must be in the form of 0x54AFFF");if(0>r||r>16777215)throw new Error("hexColor is out of range");var n=colors.hexToArray(r),e=255;0>o&&(o*=-1,e=0);var t=_.map(n,function(r){return r*(1-o)+e*o});return colors.arrayToHex(t)},mix:function(r,o,n){var e=colors.hexToArray(r),t=colors.hexToArray(o),a=_.map(e,function(r,o){return r*(1-n)+t[o]*n});return colors.arrayToHex(a)},hexToString:function(r){for(var o=parseInt(r,10).toString(16);o.length<6;)o="0"+o;return"#"+o}};module.exports=colors;


},{"lodash":175}],171:[function(require,module,exports){
(function (Buffer){
var insertCss=require("insert-css"),ClassList=require("class-list"),EventEmitter=require("events").EventEmitter,_=require("lodash"),colors=require("./colors"),_menuTemplate=null,_cssTemplate=null,_levelTemplate=null,sortAndFilterManifests=function(C){return _.chain(C).pairs().filter(function(C){return C[1].visible!==!1}).sortBy(function(C){return C[1].order}).value()},handlers=function(){var C=ClassList(document.body),g=!1,b=null,l=!1,t=function(C){C&&C.preventDefault(),g?I():W()},I=function(){C.remove("poem-menu-open"),b.emit("close"),g=!1},W=function(){C.add("poem-menu-open"),b.emit("open"),g=!0},o=function(C){b.emit("load",{slug:this.getAttribute("data-slug")}),I()};return function(C,g,e){b=g,l=C.preventDefault;var A=e.getElementsByClassName("poem-menu-burger")[0];A.addEventListener("click",t,!1);var c=e.getElementsByClassName("poem-menu-levels")[0].getElementsByTagName("a");return _.each(c,function(C){C.addEventListener("click",o,!1)}),e.getElementsByClassName("poem-menu-blocker")[0].addEventListener("click",I,!1),window.addEventListener("keydown",function(g){g.keyCode===C.toggleKey&&t(g)}),{close:I,open:W}}}(),loadTemplatesOnce=function(){var C=!0;return function(){C&&(C=!1,_menuTemplate=_.template(Buffer("PGRpdiBjbGFzcz0ncG9lbS1tZW51Jz4KCQoJPGEgY2xhc3M9InBvZW0tbWVudS1idXJnZXIiIGhyZWY9IiNtZW51IiB0aXRsZT0nSGl0IEVTQyBrZXkgdG8gb3Blbi9jbG9zZSc+CgkJPGRpdiBjbGFzcz0icG9lbS1tZW51LWJ1cmdlci1iYXJzIj48L2Rpdj4KCTwvYT4KCQoJPGRpdiBjbGFzcz0ncG9lbS1tZW51LXRvcCc+PC9kaXY+CgkKCTxkaXYgY2xhc3M9J3BvZW0tbWVudS1taWRkbGUnPgoJCTxkaXYgY2xhc3M9J3BvZW0tbWVudS1sZXZlbHMtdG9wJz48L2Rpdj4KCQk8ZGl2IGNsYXNzPSdwb2VtLW1lbnUtbGV2ZWxzJz4KCQkJPCU9IGxldmVscyAlPgoJCTwvZGl2PgoJCTxkaXYgY2xhc3M9J3BvZW0tbWVudS1sZXZlbHMtYm90dG9tJz48L2Rpdj4KCTwvZGl2PgoJCQoJPGRpdiBjbGFzcz0ncG9lbS1tZW51LWJvdHRvbSc+PC9kaXY+CgkKPC9kaXY+CjxkaXYgY2xhc3M9J3BvZW0tbWVudS1ibG9ja2VyJz48L2Rpdj4=","base64")),_levelTemplate=_.template(Buffer("PGEgaHJlZj0nIy88JS0gc2x1ZyAlPicgZGF0YS1zbHVnPSc8JS0gc2x1ZyAlPicgY2xhc3M9J3BvZW0tbWVudS1sZXZlbCc+Cgk8aDIgY2xhc3M9J3BvZW0tbWVudS1sZXZlbC1uYW1lJz48JS0gbWFuaWZlc3QubmFtZSAlPjwvaDE+Cgk8ZGl2IGNsYXNzPSdwb2VtLW1lbnUtbGV2ZWwtZGVzY3JpcHRpb24nPjwlLSBtYW5pZmVzdC5kZXNjcmlwdGlvbiAlPjwvZGl2Pgo8L2E+","base64")),_cssTemplate=_.template(Buffer("LnBvZW0tbWVudSwKLnBvZW0tbWVudSAqLAoucG9lbS1tZW51ICo6YmVmb3JlLAoucG9lbS1tZW51ICo6YWZ0ZXIgewoJLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94OyAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KLnBvZW0tbWVudSBhIHsKCWNvbG9yOiA8JT0gcHJpbWFyeSAlPjsKfQoucG9lbS1tZW51IHsKICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0zMDBweCk7CiAgICAgICAtbW96LXRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMzAwcHgpOwogICAgICAgIC1tcy10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTMwMHB4KTsKICAgICAgICAgLW8tdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0zMDBweCk7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMzAwcHgpOwogICAgdHJhbnNpdGlvbjogNTAwbXM7CiAgICB3aWR0aDogMzAwcHg7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBib3JkZXItcmlnaHQ6IDNweCBzb2xpZCA8JT0gbWVudUxpZ2h0ICU+OwogICAgYmFja2dyb3VuZDogPCU9IG1lbnVEYXJrICU+OwogICAgcGFkZGluZzogMWVtOwoJei1pbmRleDoxMDE7Cn0KLnBvZW0tbWVudS1vcGVuIC5wb2VtLW1lbnUgewogICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7CiAgICAgICAtbW96LXRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTsKICAgICAgICAtbXMtdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOwogICAgICAgICAtby10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTsKICAgIGJveC1zaGFkb3c6IDAgMCAyZW0gcmdiYSgwLCAwLCAwLCAwLjE5KTsKfQoucG9lbS1tZW51LWJsb2NrZXIgewoJaGVpZ2h0OjA7Cgl3aWR0aDoxMDAlOwoJcG9zaXRpb246YWJzb2x1dGU7Cgl0b3A6MDsKCWxlZnQ6MDsKCXotaW5kZXg6MTAwOwoJY3Vyc29yOiBwb2ludGVyOwogICAgYmFja2dyb3VuZDogPCU9IG1lbnUgJT47CglvcGFjaXR5OjA7Cgktd2Via2l0LXRyYW5zaXRpb246IG9wYWNpdHkgNTAwbXM7CgkgICAtbW96LXRyYW5zaXRpb246IG9wYWNpdHkgNTAwbXM7CgkgICAgLW1zLXRyYW5zaXRpb246IG9wYWNpdHkgNTAwbXM7CgkgICAgIC1vLXRyYW5zaXRpb246IG9wYWNpdHkgNTAwbXM7CgkgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgNTAwbXM7Cn0KLnBvZW0tbWVudS1vcGVuIC5wb2VtLW1lbnUtYmxvY2tlciB7CgloZWlnaHQ6MTAwJTsKCW9wYWNpdHk6MC43Owp9Ci5wb2VtLW1lbnUtb3BlbiAucG9lbS1tZW51LWNvbnRhaW5lciB7CiAgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlWCgzMDBweCk7CiAgICAgICAtbW96LXRyYW5zZm9ybTogdHJhbnNsYXRlWCgzMDBweCk7CiAgICAgICAgLW1zLXRyYW5zZm9ybTogdHJhbnNsYXRlWCgzMDBweCk7CiAgICAgICAgIC1vLXRyYW5zZm9ybTogdHJhbnNsYXRlWCgzMDBweCk7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgzMDBweCk7CiAgICBvcGFjaXR5OiAwLjM7Cn0KLnBvZW0tbWVudS1jb250YWluZXIgewoJLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7CgkgICAtbW96LXRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTsKCSAgICAtbXMtdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOwoJICAgICAtby10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7CgkgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTsKCWhlaWdodDogMTAwJTsKCXRyYW5zaXRpb246IHRyYW5zZm9ybSA1MDBtcywgb3BhY2l0eSA1MDBtczsKCXdpZHRoOiAxMDAlOwoJcG9zaXRpb246IGFic29sdXRlOwoJei1pbmRleDowOwp9Ci5wb2VtLW1lbnUtYnVyZ2VyIHsKCXBhZGRpbmc6IDEuNWVtIDAuNWVtOwoJZGlzcGxheTogaW5saW5lLWJsb2NrOwoJcG9zaXRpb246IGFic29sdXRlOwoJdG9wOiAwOwoJcmlnaHQ6IDA7Cgktd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKDMuNGVtLCAwLjRlbSk7CgkgICAtbW96LXRyYW5zZm9ybTogdHJhbnNsYXRlKDMuNGVtLCAwLjRlbSk7CgkgICAgLW1zLXRyYW5zZm9ybTogdHJhbnNsYXRlKDMuNGVtLCAwLjRlbSk7CgkgICAgIC1vLXRyYW5zZm9ybTogdHJhbnNsYXRlKDMuNGVtLCAwLjRlbSk7CgkgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDMuNGVtLCAwLjRlbSk7Cgktd2Via2l0LXRyYW5zaXRpb246IC13ZWJraXQtdHJhbnNmb3JtIDUwMG1zOwoJICAgLW1vei10cmFuc2l0aW9uOiAtbW96LXRyYW5zZm9ybSA1MDBtczsKCSAgICAtbXMtdHJhbnNpdGlvbjogLW1zLXRyYW5zZm9ybSA1MDBtczsKCSAgICAgLW8tdHJhbnNpdGlvbjogLW8tdHJhbnNmb3JtIDUwMG1zOwoJICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gNTAwbXM7Cn0KLnBvZW0tbWVudS1idXJnZXItYmFycyB7CglkaXNwbGF5OmJsb2NrOwoJaGVpZ2h0OjAuM2VtOwoJd2lkdGg6MmVtOwoJYmFja2dyb3VuZDogPCU9IGhhbWJ1cmdlciAlPjsKCXBvc2l0aW9uOnJlbGF0aXZlOwoJY3Vyc29yOiBwb2ludGVyOwoJLXdlYmtpdC10cmFuc2l0aW9uOiBhbGwgMC42NnM7CgkgICAtbW96LXRyYW5zaXRpb246IGFsbCAwLjY2czsKCSAgICAtbXMtdHJhbnNpdGlvbjogYWxsIDAuNjZzOwoJICAgICAtby10cmFuc2l0aW9uOiBhbGwgMC42NnM7CgkgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjY2czsKfQoucG9lbS1tZW51LWJ1cmdlci1iYXJzOmFmdGVyIHsKCWNvbnRlbnQ6Jyc7Cglwb3NpdGlvbjphYnNvbHV0ZTsKCXRvcDowLjhlbTsKCXdpZHRoOjJlbTsKCWhlaWdodDowLjNlbTsKCWJhY2tncm91bmQ6IDwlPSBoYW1idXJnZXIgJT47Cgktd2Via2l0LXRyYW5zaXRpb246IGFsbCAwLjY2czsKCSAgIC1tb3otdHJhbnNpdGlvbjogYWxsIDAuNjZzOwoJICAgIC1tcy10cmFuc2l0aW9uOiBhbGwgMC42NnM7CgkgICAgIC1vLXRyYW5zaXRpb246IGFsbCAwLjY2czsKCSAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNjZzOwp9Ci5wb2VtLW1lbnUtYnVyZ2VyLWJhcnM6YmVmb3JlIHsKCWNvbnRlbnQ6Jyc7Cglwb3NpdGlvbjphYnNvbHV0ZTsKCXRvcDotMC44ZW07Cgl3aWR0aDoyZW07CgloZWlnaHQ6MC4zZW07CgliYWNrZ3JvdW5kOjwlPSBoYW1idXJnZXIgJT47Cgktd2Via2l0LXRyYW5zaXRpb246IGFsbCAwLjY2czsKCSAgIC1tb3otdHJhbnNpdGlvbjogYWxsIDAuNjZzOwoJICAgIC1tcy10cmFuc2l0aW9uOiBhbGwgMC42NnM7CgkgICAgIC1vLXRyYW5zaXRpb246IGFsbCAwLjY2czsKCSAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNjZzOwp9CgoucG9lbS1tZW51LW9wZW4gLnBvZW0tbWVudS1idXJnZXItYmFycyB7CgliYWNrZ3JvdW5kOnRyYW5zcGFyZW50Owp9Ci5wb2VtLW1lbnUtb3BlbiAucG9lbS1tZW51LWJ1cmdlci1iYXJzOmJlZm9yZSB7Cgktd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMjI1ZGVnKTsKCSAgIC1tb3otdHJhbnNmb3JtOnJvdGF0ZSgyMjVkZWcpOwoJICAgIC1tcy10cmFuc2Zvcm06cm90YXRlKDIyNWRlZyk7CgkgICAgIC1vLXRyYW5zZm9ybTpyb3RhdGUoMjI1ZGVnKTsKCSAgICAgICAgdHJhbnNmb3JtOnJvdGF0ZSgyMjVkZWcpOwoJdG9wOjA7Cn0KLnBvZW0tbWVudS1vcGVuIC5wb2VtLW1lbnUtYnVyZ2VyLWJhcnM6YWZ0ZXIgewoJLXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKC0yMjVkZWcpOwoJICAgLW1vei10cmFuc2Zvcm06cm90YXRlKC0yMjVkZWcpOwoJICAgIC1tcy10cmFuc2Zvcm06cm90YXRlKC0yMjVkZWcpOwoJICAgICAtby10cmFuc2Zvcm06cm90YXRlKC0yMjVkZWcpOwoJICAgICAgICB0cmFuc2Zvcm06cm90YXRlKC0yMjVkZWcpOwoJdG9wOjA7Cn0KLnBvZW0tbWVudS1ib3R0b20gewoJcG9zaXRpb246IGFic29sdXRlOwoJYm90dG9tOiAwOwoJd2lkdGg6IDEwMCU7CglsZWZ0OiAwOwoJcGFkZGluZzogMWVtOwp9Ci5wb2VtLW1lbnUtYm90dG9tLW11dGUgewoJdGV4dC1hbGlnbjpyaWdodDsKfQoucG9lbS1tZW51LWJvdHRvbS1tdXRlIGltZyB7Cgl3aWR0aDo2MHB4Owp9Ci5wb2VtLW1lbnUtYm90dG9tLXJlc2V0IHsKCXBvc2l0aW9uOiBhYnNvbHV0ZTsKCWJvdHRvbToxLjNlbTsKCWxlZnQ6MWVtOwp9Ci5wb2VtLW1lbnUtdG9wIHsKICAgIGNvbG9yOiA8JT0gcHJpbWFyeSAlPjsKICAgIGZvbnQtc2l6ZTogMS43ZW07CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmb250LXdlaWdodDogODAwOwogICAgbGluZS1oZWlnaHQ6IDEuMjsKICAgIG1hcmdpbi10b3A6IDAuMWVtOwp9Ci5wb2VtLW1lbnUtbWlkZGxlIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGxlZnQ6IDA7CiAgICByaWdodDogMDsKICAgIHRvcDogNC40ZW07CiAgICBib3R0b206IDVlbTsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgcGFkZGluZzogMWVtOwogICAgYmFja2dyb3VuZDogPCU9IG1lbnUgJT47CiAgICBib3JkZXItdG9wOiAxcHggc29saWQgPCU9IG1lbnVMaWdodCAlPjsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCA8JT0gbWVudURhcmsgJT47Cn0KLnBvZW0tbWVudS1sZXZlbC1uYW1lIHsKICAgIG1hcmdpbjogMDsKICAgIGZvbnQtd2VpZ2h0OiAxMDA7CiAgICBmb250LXNpemU6IDEuMWVtOwogICAgbWFyZ2luLWJvdHRvbTogMC4zZW07Cgljb2xvcjogPCU9IHByaW1hcnkgJT4KfQphOmhvdmVyIC5wb2VtLW1lbnUtbGV2ZWwtbmFtZSB7Cgljb2xvcjogPCU9IHByaW1hcnlBY3RpdmUgJT4KfQoucG9lbS1tZW51LWxldmVsLWRlc2NyaXB0aW9uIHsKICAgIGNvbG9yOiA8JT0gdGV4dCAlPjsKICAgIHRleHQtdHJhbnNmb3JtOiBub25lOwogICAgZm9udC1zaXplOiAwLjhlbTsKICAgIGZvbnQtd2VpZ2h0OiAxMDA7Cn0KYTpob3ZlciAucG9lbS1tZW51LWxldmVsLWRlc2NyaXB0aW9uIHsKCWNvbG9yOiA8JT0gdGV4dEFjdGl2ZSAlPgp9CgphLnBvZW0tbWVudS1sZXZlbCB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGJvcmRlcjogMXB4IHNvbGlkIDwlPSBsZXZlbEFjdGl2ZSAlPjsKICAgIG1hcmdpbjogMS4zZW0gMDsKICAgIHBhZGRpbmc6IDAuNWVtOwogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgYm94LXNoYWRvdzogMCAwIDAuOWVtIHJnYmEoMCwgMCwgMCwgMC4yMik7CiAgICBiYWNrZ3JvdW5kOiA8JT0gbGV2ZWwgJT47CiAgICAtd2Via2l0LXRyYW5zaXRpb246IC13ZWJraXQtdHJhbnNmb3JtIDIwMG1zOwogICAgICAgLW1vei10cmFuc2l0aW9uOiAtbW96LXRyYW5zZm9ybSAyMDBtczsKICAgICAgICAtbXMtdHJhbnNpdGlvbjogLW1zLXRyYW5zZm9ybSAyMDBtczsKICAgICAgICAgLW8tdHJhbnNpdGlvbjogLW8tdHJhbnNmb3JtIDIwMG1zOwogICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMjAwbXM7CiAgICAtd2Via2l0LXRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgICAtbW96LXRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgICAgLW1zLXRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgICAgIC1vLXRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7Cn0KYS5wb2VtLW1lbnUtbGV2ZWwtdGl0bGVzIHsKCXRleHQtYWxpZ246IGNlbnRlcjsKCXBhZGRpbmc6IDAuNGVtOwoJbWFyZ2luLXRvcDogMC41ZW07Cn0KYS5wb2VtLW1lbnUtbGV2ZWw6aG92ZXIgewogICAgLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKDEuMDE1KTsKICAgICAgIC1tb3otdHJhbnNmb3JtOiBzY2FsZSgxLjAxNSk7CiAgICAgICAgLW1zLXRyYW5zZm9ybTogc2NhbGUoMS4wMTUpOwogICAgICAgICAtby10cmFuc2Zvcm06IHNjYWxlKDEuMDE1KTsKICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjAxNSk7Cn0KQG1lZGlhIChtYXgtd2lkdGg6NDAwcHgpIHsKCS5wb2VtLW1lbnUgewoJICAgIGZvbnQtc2l6ZTogMC44NWVtOwoJfQoJLnBvZW0tbWVudS1vcGVuIC5idXJnZXItd3JhcHBlciB7CgkgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTAuMWVtKTsKCSAgICAgICAtbW96LXRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMC4xZW0pOwoJICAgICAgICAtbXMtdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0wLjFlbSk7CgkgICAgICAgICAtby10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTAuMWVtKTsKCSAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMC4xZW0pOwoJfQoJCgkucG9lbS1tZW51LXRvcCB7CgkgICAgdGV4dC1hbGlnbjogbGVmdDsKCSAgICBmb250LXNpemU6IDIuMWVtOwoJfQoJLnBvZW0tbWVudS1taWRkbGUgewoJICAgIHRvcDogNC44ZW07CgkgICAgYm90dG9tOiAzLjVlbTsKCX0KfQ==","base64")))}}(),runCssTemplates=function(C){var g=C.primaryColor>C.menuColor?1:-1,b=_cssTemplate(_.mapValues({hamburger:C.hamburgerColor,primaryActive:C.primaryColor,text:C.textColor,menu:C.menuColor,textActive:colors.lightness(C.textColor,.1*g),menuDark:colors.lightness(C.menuColor,g*-.2),menuLight:colors.lightness(C.menuColor,.2*g),primary:colors.mix(C.primaryColor,C.menuColor,.2),level:colors.mix(C.primaryColor,C.menuColor,.9),levelActive:colors.mix(C.primaryColor,C.menuColor,.6)},colors.hexToString));insertCss(b)},runHtmlTemplates=function(C,g){function b(C,g){_.isElement(g)?C.appendChild(g):C.innerHTML=g}var l=_.reduce(C,function(C,g){return C+_levelTemplate({slug:g[0],manifest:g[1]})},""),t=_menuTemplate({levels:l}),I=document.createElement("div");return I.innerHTML=t,b(I.getElementsByClassName("poem-menu-top")[0],g.top),b(I.getElementsByClassName("poem-menu-levels-top")[0],g.beforeLevels),b(I.getElementsByClassName("poem-menu-levels-bottom")[0],g.afterLevels),b(I.getElementsByClassName("poem-menu-bottom")[0],g.bottom),document.body.insertBefore(I,document.body.firstChild),I};module.exports=function(C,g){loadTemplatesOnce();var b=_.extend({hamburgerColor:16777215,primaryColor:5550079,textColor:10471137,menuColor:2567732,top:"Poem",beforeLevels:"",afterLevels:"",bottom:"",preventDefaultLevelLinks:!0,toggleKey:27},g),l=new EventEmitter,t=sortAndFilterManifests(C);runCssTemplates(b);var I=runHtmlTemplates(t,b),W=handlers(b,l,I);return{emitter:l,close:W.close,open:W.open}};


}).call(this,require("buffer").Buffer)

},{"./colors":170,"buffer":192,"class-list":172,"events":196,"insert-css":174,"lodash":175}],172:[function(require,module,exports){
function ClassList(n){function t(n){var t=s();indexof(t,n)>-1||(t.push(n),a(t))}function r(n){var t=s(),r=indexof(t,n);-1!==r&&(t.splice(r,1),a(t))}function e(n){return indexof(s(),n)>-1}function i(n){return e(n)?(r(n),!1):(t(n),!0)}function u(){return n.className}function o(n){var t=s();return t[n]||null}function s(){var t=n.className;return filter(t.split(" "),isTruthy)}function a(t){var r=t.length;n.className=t.join(" "),l.length=r;for(var e=0;e<t.length;e++)l[e]=t[e];delete t[r]}var f=n.classList;if(f)return f;var l={add:t,remove:r,contains:e,toggle:i,toString:u,length:0,item:o};return l}function filter(n,t){for(var r=[],e=0;e<n.length;e++)t(n[e])&&r.push(n[e]);return r}function isTruthy(n){return!!n}var indexof=require("indexof");module.exports=ClassList;


},{"indexof":173}],173:[function(require,module,exports){
var indexOf=[].indexOf;module.exports=function(e,n){if(indexOf)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1};


},{}],174:[function(require,module,exports){
var inserted={};module.exports=function(e,t){if(!inserted[e]){inserted[e]=!0;var n=document.createElement("style");n.setAttribute("type","text/css"),"textContent"in n?n.textContent=e:n.styleSheet.cssText=e;var s=document.getElementsByTagName("head")[0];t&&t.prepend?s.insertBefore(n,s.childNodes[0]):s.appendChild(n)}};


},{}],175:[function(require,module,exports){
(function (global){
(function(){function n(n,r,t){for(var e=(t||0)-1,u=n?n.length:0;++e<u;)if(n[e]===r)return e;return-1}function r(r,t){var e=typeof t;if(r=r.cache,"boolean"==e||null==t)return r[t]?0:-1;"number"!=e&&"string"!=e&&(e="object");var u="number"==e?t:m+t;return r=(r=r[e])&&r[u],"object"==e?r&&n(r,t)>-1?0:-1:r?0:-1}function t(n){var r=this.cache,t=typeof n;if("boolean"==t||null==n)r[n]=!0;else{"number"!=t&&"string"!=t&&(t="object");var e="number"==t?n:m+n,u=r[t]||(r[t]={});"object"==t?(u[e]||(u[e]=[])).push(n):u[e]=!0}}function e(n){return n.charCodeAt(0)}function u(n,r){for(var t=n.criteria,e=r.criteria,u=-1,o=t.length;++u<o;){var a=t[u],i=e[u];if(a!==i){if(a>i||"undefined"==typeof a)return 1;if(i>a||"undefined"==typeof i)return-1}}return n.index-r.index}function o(n){var r=-1,e=n.length,u=n[0],o=n[e/2|0],a=n[e-1];if(u&&"object"==typeof u&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var i=f();i["false"]=i["null"]=i["true"]=i.undefined=!1;var l=f();for(l.array=n,l.cache=i,l.push=t;++r<e;)l.push(n[r]);return l}function a(n){return"\\"+G[n]}function i(){return h.pop()||[]}function f(){return g.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function l(n){n.length=0,h.length<d&&h.push(n)}function c(n){var r=n.cache;r&&c(r),n.array=n.cache=n.criteria=n.object=n.number=n.string=n.value=null,g.length<d&&g.push(n)}function p(n,r,t){r||(r=0),"undefined"==typeof t&&(t=n?n.length:0);for(var e=-1,u=t-r||0,o=Array(0>u?0:u);++e<u;)o[e]=n[r+e];return o}function s(t){function h(n){return n&&"object"==typeof n&&!Yt(n)&&Tt.call(n,"__wrapped__")?n:new g(n)}function g(n,r){this.__chain__=!!r,this.__wrapped__=n}function d(n){function r(){if(e){var n=p(e);$t.apply(n,arguments)}if(this instanceof r){var o=J(t.prototype),a=t.apply(o,n||arguments);return Sn(a)?a:o}return t.apply(u,n||arguments)}var t=n[0],e=n[2],u=n[4];return Xt(r,n),r}function G(n,r,t,e,u){if(t){var o=t(n);if("undefined"!=typeof o)return o}var a=Sn(n);if(!a)return n;var f=Nt.call(n);if(!K[f])return n;var c=Jt[f];switch(f){case F:case B:return new c(+n);case q:case P:return new c(n);case L:return o=c(n.source,C.exec(n)),o.lastIndex=n.lastIndex,o}var s=Yt(n);if(r){var v=!e;e||(e=i()),u||(u=i());for(var h=e.length;h--;)if(e[h]==n)return u[h];o=s?c(n.length):{}}else o=s?p(n):oe({},n);return s&&(Tt.call(n,"index")&&(o.index=n.index),Tt.call(n,"input")&&(o.input=n.input)),r?(e.push(n),u.push(o),(s?Xn:fe)(n,function(n,a){o[a]=G(n,r,t,e,u)}),v&&(l(e),l(u)),o):o}function J(n,r){return Sn(n)?zt(n):{}}function Q(n,r,t){if("function"!=typeof n)return Yr;if("undefined"==typeof r||!("prototype"in n))return n;var e=n.__bindData__;if("undefined"==typeof e&&(Qt.funcNames&&(e=!n.name),e=e||!Qt.funcDecomp,!e)){var u=At.call(n);Qt.funcNames||(e=!O.test(u)),e||(e=I.test(u),Xt(n,e))}if(e===!1||e!==!0&&1&e[1])return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,e){return n.call(r,t,e)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,o){return n.call(r,t,e,u,o)}}return $r(n,r)}function X(n){function r(){var n=f?a:this;if(u){var h=p(u);$t.apply(h,arguments)}if((o||c)&&(h||(h=p(arguments)),o&&$t.apply(h,o),c&&h.length<i))return e|=16,X([t,s?e:-4&e,h,null,a,i]);if(h||(h=arguments),l&&(t=n[v]),this instanceof r){n=J(t.prototype);var g=t.apply(n,h);return Sn(g)?g:n}return t.apply(n,h)}var t=n[0],e=n[1],u=n[2],o=n[3],a=n[4],i=n[5],f=1&e,l=2&e,c=4&e,s=8&e,v=t;return Xt(r,n),r}function Y(t,e){var u=-1,a=ln(),i=t?t.length:0,f=i>=b&&a===n,l=[];if(f){var p=o(e);p?(a=r,e=p):f=!1}for(;++u<i;){var s=t[u];a(e,s)<0&&l.push(s)}return f&&c(e),l}function nn(n,r,t,e){for(var u=(e||0)-1,o=n?n.length:0,a=[];++u<o;){var i=n[u];if(i&&"object"==typeof i&&"number"==typeof i.length&&(Yt(i)||vn(i))){r||(i=nn(i,r,t));var f=-1,l=i.length,c=a.length;for(a.length+=l;++f<l;)a[c++]=i[f]}else t||a.push(i)}return a}function rn(n,r,t,e,u,o){if(t){var a=t(n,r);if("undefined"!=typeof a)return!!a}if(n===r)return 0!==n||1/n==1/r;var f=typeof n,c=typeof r;if(!(n!==n||n&&V[f]||r&&V[c]))return!1;if(null==n||null==r)return n===r;var p=Nt.call(n),s=Nt.call(r);if(p==T&&(p=z),s==T&&(s=z),p!=s)return!1;switch(p){case F:case B:return+n==+r;case q:return n!=+n?r!=+r:0==n?1/n==1/r:n==+r;case L:case P:return n==jt(r)}var v=p==$;if(!v){var h=Tt.call(n,"__wrapped__"),g=Tt.call(r,"__wrapped__");if(h||g)return rn(h?n.__wrapped__:n,g?r.__wrapped__:r,t,e,u,o);if(p!=z)return!1;var y=n.constructor,m=r.constructor;if(y!=m&&!(In(y)&&y instanceof y&&In(m)&&m instanceof m)&&"constructor"in n&&"constructor"in r)return!1}var b=!u;u||(u=i()),o||(o=i());for(var d=u.length;d--;)if(u[d]==n)return o[d]==r;var _=0;if(a=!0,u.push(n),o.push(r),v){if(d=n.length,_=r.length,a=_==d,a||e)for(;_--;){var w=d,j=r[_];if(e)for(;w--&&!(a=rn(n[w],j,t,e,u,o)););else if(!(a=rn(n[_],j,t,e,u,o)))break}}else ie(r,function(r,i,f){return Tt.call(f,i)?(_++,a=Tt.call(n,i)&&rn(n[i],r,t,e,u,o)):void 0}),a&&!e&&ie(n,function(n,r,t){return Tt.call(t,r)?a=--_>-1:void 0});return u.pop(),o.pop(),b&&(l(u),l(o)),a}function tn(n,r,t,e,u){(Yt(r)?Xn:fe)(r,function(r,o){var a,i,f=r,l=n[o];if(r&&((i=Yt(r))||le(r))){for(var c=e.length;c--;)if(a=e[c]==r){l=u[c];break}if(!a){var p;t&&(f=t(l,r),(p="undefined"!=typeof f)&&(l=f)),p||(l=i?Yt(l)?l:[]:le(l)?l:{}),e.push(r),u.push(l),p||tn(l,r,t,e,u)}}else t&&(f=t(l,r),"undefined"==typeof f&&(f=r)),"undefined"!=typeof f&&(l=f);n[o]=l})}function en(n,r){return n+St(Ht()*(r-n+1))}function un(t,e,u){var a=-1,f=ln(),p=t?t.length:0,s=[],v=!e&&p>=b&&f===n,h=u||v?i():s;if(v){var g=o(h);f=r,h=g}for(;++a<p;){var y=t[a],m=u?u(y,a,t):y;(e?!a||h[h.length-1]!==m:f(h,m)<0)&&((u||v)&&h.push(m),s.push(y))}return v?(l(h.array),c(h)):u&&l(h),s}function on(n){return function(r,t,e){var u={};t=h.createCallback(t,e,3);var o=-1,a=r?r.length:0;if("number"==typeof a)for(;++o<a;){var i=r[o];n(u,i,t(i,o,r),r)}else fe(r,function(r,e,o){n(u,r,t(r,e,o),o)});return u}}function an(n,r,t,e,u,o){var a=1&r,i=2&r,f=4&r,l=16&r,c=32&r;if(!i&&!In(n))throw new kt;l&&!t.length&&(r&=-17,l=t=!1),c&&!e.length&&(r&=-33,c=e=!1);var s=n&&n.__bindData__;if(s&&s!==!0)return s=p(s),s[2]&&(s[2]=p(s[2])),s[3]&&(s[3]=p(s[3])),!a||1&s[1]||(s[4]=u),!a&&1&s[1]&&(r|=8),!f||4&s[1]||(s[5]=o),l&&$t.apply(s[2]||(s[2]=[]),t),c&&Wt.apply(s[3]||(s[3]=[]),e),s[1]|=r,an.apply(null,s);var v=1==r||17===r?d:X;return v([n,r,t,e,u,o])}function fn(n){return re[n]}function ln(){var r=(r=h.indexOf)===br?n:r;return r}function cn(n){return"function"==typeof n&&Rt.test(n)}function pn(n){var r,t;return n&&Nt.call(n)==z&&(r=n.constructor,!In(r)||r instanceof r)?(ie(n,function(n,r){t=r}),"undefined"==typeof t||Tt.call(n,t)):!1}function sn(n){return te[n]}function vn(n){return n&&"object"==typeof n&&"number"==typeof n.length&&Nt.call(n)==T||!1}function hn(n,r,t,e){return"boolean"!=typeof r&&null!=r&&(e=t,t=r,r=!1),G(n,r,"function"==typeof t&&Q(t,e,1))}function gn(n,r,t){return G(n,!0,"function"==typeof r&&Q(r,t,1))}function yn(n,r){var t=J(n);return r?oe(t,r):t}function mn(n,r,t){var e;return r=h.createCallback(r,t,3),fe(n,function(n,t,u){return r(n,t,u)?(e=t,!1):void 0}),e}function bn(n,r,t){var e;return r=h.createCallback(r,t,3),_n(n,function(n,t,u){return r(n,t,u)?(e=t,!1):void 0}),e}function dn(n,r,t){var e=[];ie(n,function(n,r){e.push(r,n)});var u=e.length;for(r=Q(r,t,3);u--&&r(e[u--],e[u],n)!==!1;);return n}function _n(n,r,t){var e=ne(n),u=e.length;for(r=Q(r,t,3);u--;){var o=e[u];if(r(n[o],o,n)===!1)break}return n}function wn(n){var r=[];return ie(n,function(n,t){In(n)&&r.push(t)}),r.sort()}function jn(n,r){return n?Tt.call(n,r):!1}function kn(n){for(var r=-1,t=ne(n),e=t.length,u={};++r<e;){var o=t[r];u[n[o]]=o}return u}function xn(n){return n===!0||n===!1||n&&"object"==typeof n&&Nt.call(n)==F||!1}function Cn(n){return n&&"object"==typeof n&&Nt.call(n)==B||!1}function On(n){return n&&1===n.nodeType||!1}function Nn(n){var r=!0;if(!n)return r;var t=Nt.call(n),e=n.length;return t==$||t==P||t==T||t==z&&"number"==typeof e&&In(n.splice)?!e:(fe(n,function(){return r=!1}),r)}function Rn(n,r,t,e){return rn(n,r,"function"==typeof t&&Q(t,e,2))}function En(n){return Pt(n)&&!Kt(parseFloat(n))}function In(n){return"function"==typeof n}function Sn(n){return!(!n||!V[typeof n])}function An(n){return Tn(n)&&n!=+n}function Dn(n){return null===n}function Tn(n){return"number"==typeof n||n&&"object"==typeof n&&Nt.call(n)==q||!1}function $n(n){return n&&"object"==typeof n&&Nt.call(n)==L||!1}function Fn(n){return"string"==typeof n||n&&"object"==typeof n&&Nt.call(n)==P||!1}function Bn(n){return"undefined"==typeof n}function Wn(n,r,t){var e={};return r=h.createCallback(r,t,3),fe(n,function(n,t,u){e[t]=r(n,t,u)}),e}function qn(n){var r=arguments,t=2;if(!Sn(n))return n;if("number"!=typeof r[2]&&(t=r.length),t>3&&"function"==typeof r[t-2])var e=Q(r[--t-1],r[t--],2);else t>2&&"function"==typeof r[t-1]&&(e=r[--t]);for(var u=p(arguments,1,t),o=-1,a=i(),f=i();++o<t;)tn(n,u[o],e,a,f);return l(a),l(f),n}function zn(n,r,t){var e={};if("function"!=typeof r){var u=[];ie(n,function(n,r){u.push(r)}),u=Y(u,nn(arguments,!0,!1,1));for(var o=-1,a=u.length;++o<a;){var i=u[o];e[i]=n[i]}}else r=h.createCallback(r,t,3),ie(n,function(n,t,u){r(n,t,u)||(e[t]=n)});return e}function Ln(n){for(var r=-1,t=ne(n),e=t.length,u=ht(e);++r<e;){var o=t[r];u[r]=[o,n[o]]}return u}function Pn(n,r,t){var e={};if("function"!=typeof r)for(var u=-1,o=nn(arguments,!0,!1,1),a=Sn(n)?o.length:0;++u<a;){var i=o[u];i in n&&(e[i]=n[i])}else r=h.createCallback(r,t,3),ie(n,function(n,t,u){r(n,t,u)&&(e[t]=n)});return e}function Kn(n,r,t,e){var u=Yt(n);if(null==t)if(u)t=[];else{var o=n&&n.constructor,a=o&&o.prototype;t=J(a)}return r&&(r=h.createCallback(r,e,4),(u?Xn:fe)(n,function(n,e,u){return r(t,n,e,u)})),t}function Un(n){for(var r=-1,t=ne(n),e=t.length,u=ht(e);++r<e;)u[r]=n[t[r]];return u}function Mn(n){for(var r=arguments,t=-1,e=nn(r,!0,!1,1),u=r[2]&&r[2][r[1]]===n?1:e.length,o=ht(u);++t<u;)o[t]=n[e[t]];return o}function Vn(n,r,t){var e=-1,u=ln(),o=n?n.length:0,a=!1;return t=(0>t?Mt(0,o+t):t)||0,Yt(n)?a=u(n,r,t)>-1:"number"==typeof o?a=(Fn(n)?n.indexOf(r,t):u(n,r,t))>-1:fe(n,function(n){return++e>=t?!(a=n===r):void 0}),a}function Gn(n,r,t){var e=!0;r=h.createCallback(r,t,3);var u=-1,o=n?n.length:0;if("number"==typeof o)for(;++u<o&&(e=!!r(n[u],u,n)););else fe(n,function(n,t,u){return e=!!r(n,t,u)});return e}function Hn(n,r,t){var e=[];r=h.createCallback(r,t,3);var u=-1,o=n?n.length:0;if("number"==typeof o)for(;++u<o;){var a=n[u];r(a,u,n)&&e.push(a)}else fe(n,function(n,t,u){r(n,t,u)&&e.push(n)});return e}function Jn(n,r,t){r=h.createCallback(r,t,3);var e=-1,u=n?n.length:0;if("number"!=typeof u){var o;return fe(n,function(n,t,e){return r(n,t,e)?(o=n,!1):void 0}),o}for(;++e<u;){var a=n[e];if(r(a,e,n))return a}}function Qn(n,r,t){var e;return r=h.createCallback(r,t,3),Yn(n,function(n,t,u){return r(n,t,u)?(e=n,!1):void 0}),e}function Xn(n,r,t){var e=-1,u=n?n.length:0;if(r=r&&"undefined"==typeof t?r:Q(r,t,3),"number"==typeof u)for(;++e<u&&r(n[e],e,n)!==!1;);else fe(n,r);return n}function Yn(n,r,t){var e=n?n.length:0;if(r=r&&"undefined"==typeof t?r:Q(r,t,3),"number"==typeof e)for(;e--&&r(n[e],e,n)!==!1;);else{var u=ne(n);e=u.length,fe(n,function(n,t,o){return t=u?u[--e]:--e,r(o[t],t,o)})}return n}function Zn(n,r){var t=p(arguments,2),e=-1,u="function"==typeof r,o=n?n.length:0,a=ht("number"==typeof o?o:0);return Xn(n,function(n){a[++e]=(u?r:n[r]).apply(n,t)}),a}function nr(n,r,t){var e=-1,u=n?n.length:0;if(r=h.createCallback(r,t,3),"number"==typeof u)for(var o=ht(u);++e<u;)o[e]=r(n[e],e,n);else o=[],fe(n,function(n,t,u){o[++e]=r(n,t,u)});return o}function rr(n,r,t){var u=-(1/0),o=u;if("function"!=typeof r&&t&&t[r]===n&&(r=null),null==r&&Yt(n))for(var a=-1,i=n.length;++a<i;){var f=n[a];f>o&&(o=f)}else r=null==r&&Fn(n)?e:h.createCallback(r,t,3),Xn(n,function(n,t,e){var a=r(n,t,e);a>u&&(u=a,o=n)});return o}function tr(n,r,t){var u=1/0,o=u;if("function"!=typeof r&&t&&t[r]===n&&(r=null),null==r&&Yt(n))for(var a=-1,i=n.length;++a<i;){var f=n[a];o>f&&(o=f)}else r=null==r&&Fn(n)?e:h.createCallback(r,t,3),Xn(n,function(n,t,e){var a=r(n,t,e);u>a&&(u=a,o=n)});return o}function er(n,r,t,e){if(!n)return t;var u=arguments.length<3;r=h.createCallback(r,e,4);var o=-1,a=n.length;if("number"==typeof a)for(u&&(t=n[++o]);++o<a;)t=r(t,n[o],o,n);else fe(n,function(n,e,o){t=u?(u=!1,n):r(t,n,e,o)});return t}function ur(n,r,t,e){var u=arguments.length<3;return r=h.createCallback(r,e,4),Yn(n,function(n,e,o){t=u?(u=!1,n):r(t,n,e,o)}),t}function or(n,r,t){return r=h.createCallback(r,t,3),Hn(n,function(n,t,e){return!r(n,t,e)})}function ar(n,r,t){if(n&&"number"!=typeof n.length&&(n=Un(n)),null==r||t)return n?n[en(0,n.length-1)]:v;var e=ir(n);return e.length=Vt(Mt(0,r),e.length),e}function ir(n){var r=-1,t=n?n.length:0,e=ht("number"==typeof t?t:0);return Xn(n,function(n){var t=en(0,++r);e[r]=e[t],e[t]=n}),e}function fr(n){var r=n?n.length:0;return"number"==typeof r?r:ne(n).length}function lr(n,r,t){var e;r=h.createCallback(r,t,3);var u=-1,o=n?n.length:0;if("number"==typeof o)for(;++u<o&&!(e=r(n[u],u,n)););else fe(n,function(n,t,u){return!(e=r(n,t,u))});return!!e}function cr(n,r,t){var e=-1,o=Yt(r),a=n?n.length:0,p=ht("number"==typeof a?a:0);for(o||(r=h.createCallback(r,t,3)),Xn(n,function(n,t,u){var a=p[++e]=f();o?a.criteria=nr(r,function(r){return n[r]}):(a.criteria=i())[0]=r(n,t,u),a.index=e,a.value=n}),a=p.length,p.sort(u);a--;){var s=p[a];p[a]=s.value,o||l(s.criteria),c(s)}return p}function pr(n){return n&&"number"==typeof n.length?p(n):Un(n)}function sr(n){for(var r=-1,t=n?n.length:0,e=[];++r<t;){var u=n[r];u&&e.push(u)}return e}function vr(n){return Y(n,nn(arguments,!0,!0,1))}function hr(n,r,t){var e=-1,u=n?n.length:0;for(r=h.createCallback(r,t,3);++e<u;)if(r(n[e],e,n))return e;return-1}function gr(n,r,t){var e=n?n.length:0;for(r=h.createCallback(r,t,3);e--;)if(r(n[e],e,n))return e;return-1}function yr(n,r,t){var e=0,u=n?n.length:0;if("number"!=typeof r&&null!=r){var o=-1;for(r=h.createCallback(r,t,3);++o<u&&r(n[o],o,n);)e++}else if(e=r,null==e||t)return n?n[0]:v;return p(n,0,Vt(Mt(0,e),u))}function mr(n,r,t,e){return"boolean"!=typeof r&&null!=r&&(e=t,t="function"!=typeof r&&e&&e[r]===n?null:r,r=!1),null!=t&&(n=nr(n,t,e)),nn(n,r)}function br(r,t,e){if("number"==typeof e){var u=r?r.length:0;e=0>e?Mt(0,u+e):e||0}else if(e){var o=Nr(r,t);return r[o]===t?o:-1}return n(r,t,e)}function dr(n,r,t){var e=0,u=n?n.length:0;if("number"!=typeof r&&null!=r){var o=u;for(r=h.createCallback(r,t,3);o--&&r(n[o],o,n);)e++}else e=null==r||t?1:r||e;return p(n,0,Vt(Mt(0,u-e),u))}function _r(){for(var t=[],e=-1,u=arguments.length,a=i(),f=ln(),p=f===n,s=i();++e<u;){var v=arguments[e];(Yt(v)||vn(v))&&(t.push(v),a.push(p&&v.length>=b&&o(e?t[e]:s)))}var h=t[0],g=-1,y=h?h.length:0,m=[];n:for(;++g<y;){var d=a[0];if(v=h[g],(d?r(d,v):f(s,v))<0){for(e=u,(d||s).push(v);--e;)if(d=a[e],(d?r(d,v):f(t[e],v))<0)continue n;m.push(v)}}for(;u--;)d=a[u],d&&c(d);return l(a),l(s),m}function wr(n,r,t){var e=0,u=n?n.length:0;if("number"!=typeof r&&null!=r){var o=u;for(r=h.createCallback(r,t,3);o--&&r(n[o],o,n);)e++}else if(e=r,null==e||t)return n?n[u-1]:v;return p(n,Mt(0,u-e))}function jr(n,r,t){var e=n?n.length:0;for("number"==typeof t&&(e=(0>t?Mt(0,e+t):Vt(t,e-1))+1);e--;)if(n[e]===r)return e;return-1}function kr(n){for(var r=arguments,t=0,e=r.length,u=n?n.length:0;++t<e;)for(var o=-1,a=r[t];++o<u;)n[o]===a&&(Bt.call(n,o--,1),u--);return n}function xr(n,r,t){n=+n||0,t="number"==typeof t?t:+t||1,null==r&&(r=n,n=0);for(var e=-1,u=Mt(0,Et((r-n)/(t||1))),o=ht(u);++e<u;)o[e]=n,n+=t;return o}function Cr(n,r,t){var e=-1,u=n?n.length:0,o=[];for(r=h.createCallback(r,t,3);++e<u;){var a=n[e];r(a,e,n)&&(o.push(a),Bt.call(n,e--,1),u--)}return o}function Or(n,r,t){if("number"!=typeof r&&null!=r){var e=0,u=-1,o=n?n.length:0;for(r=h.createCallback(r,t,3);++u<o&&r(n[u],u,n);)e++}else e=null==r||t?1:Mt(0,r);return p(n,e)}function Nr(n,r,t,e){var u=0,o=n?n.length:u;for(t=t?h.createCallback(t,e,1):Yr,r=t(r);o>u;){var a=u+o>>>1;t(n[a])<r?u=a+1:o=a}return u}function Rr(){return un(nn(arguments,!0,!0))}function Er(n,r,t,e){return"boolean"!=typeof r&&null!=r&&(e=t,t="function"!=typeof r&&e&&e[r]===n?null:r,r=!1),null!=t&&(t=h.createCallback(t,e,3)),un(n,r,t)}function Ir(n){return Y(n,p(arguments,1))}function Sr(){for(var n=-1,r=arguments.length;++n<r;){var t=arguments[n];if(Yt(t)||vn(t))var e=e?un(Y(e,t).concat(Y(t,e))):t}return e||[]}function Ar(){for(var n=arguments.length>1?arguments:arguments[0],r=-1,t=n?rr(ve(n,"length")):0,e=ht(0>t?0:t);++r<t;)e[r]=ve(n,r);return e}function Dr(n,r){var t=-1,e=n?n.length:0,u={};for(r||!e||Yt(n[0])||(r=[]);++t<e;){var o=n[t];r?u[o]=r[t]:o&&(u[o[0]]=o[1])}return u}function Tr(n,r){if(!In(r))throw new kt;return function(){return--n<1?r.apply(this,arguments):void 0}}function $r(n,r){return arguments.length>2?an(n,17,p(arguments,2),null,r):an(n,1,null,null,r)}function Fr(n){for(var r=arguments.length>1?nn(arguments,!0,!1,1):wn(n),t=-1,e=r.length;++t<e;){var u=r[t];n[u]=an(n[u],1,null,null,n)}return n}function Br(n,r){return arguments.length>2?an(r,19,p(arguments,2),null,n):an(r,3,null,null,n)}function Wr(){for(var n=arguments,r=n.length;r--;)if(!In(n[r]))throw new kt;return function(){for(var r=arguments,t=n.length;t--;)r=[n[t].apply(this,r)];return r[0]}}function qr(n,r){return r="number"==typeof r?r:+r||n.length,an(n,4,null,null,null,r)}function zr(n,r,t){var e,u,o,a,i,f,l,c=0,p=!1,s=!0;if(!In(n))throw new kt;if(r=Mt(0,r)||0,t===!0){var h=!0;s=!1}else Sn(t)&&(h=t.leading,p="maxWait"in t&&(Mt(r,t.maxWait)||0),s="trailing"in t?t.trailing:s);var g=function(){var t=r-(ge()-a);if(0>=t){u&&It(u);var p=l;u=f=l=v,p&&(c=ge(),o=n.apply(i,e),f||u||(e=i=null))}else f=Ft(g,t)},y=function(){f&&It(f),u=f=l=v,(s||p!==r)&&(c=ge(),o=n.apply(i,e),f||u||(e=i=null))};return function(){if(e=arguments,a=ge(),i=this,l=s&&(f||!h),p===!1)var t=h&&!f;else{u||h||(c=a);var v=p-(a-c),m=0>=v;m?(u&&(u=It(u)),c=a,o=n.apply(i,e)):u||(u=Ft(y,v))}return m&&f?f=It(f):f||r===p||(f=Ft(g,r)),t&&(m=!0,o=n.apply(i,e)),!m||f||u||(e=i=null),o}}function Lr(n){if(!In(n))throw new kt;var r=p(arguments,1);return Ft(function(){n.apply(v,r)},1)}function Pr(n,r){if(!In(n))throw new kt;var t=p(arguments,2);return Ft(function(){n.apply(v,t)},r)}function Kr(n,r){if(!In(n))throw new kt;var t=function(){var e=t.cache,u=r?r.apply(this,arguments):m+arguments[0];return Tt.call(e,u)?e[u]:e[u]=n.apply(this,arguments)};return t.cache={},t}function Ur(n){var r,t;if(!In(n))throw new kt;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}}function Mr(n){return an(n,16,p(arguments,1))}function Vr(n){return an(n,32,null,p(arguments,1))}function Gr(n,r,t){var e=!0,u=!0;if(!In(n))throw new kt;return t===!1?e=!1:Sn(t)&&(e="leading"in t?t.leading:e,u="trailing"in t?t.trailing:u),U.leading=e,U.maxWait=r,U.trailing=u,zr(n,r,U)}function Hr(n,r){return an(r,16,[n])}function Jr(n){return function(){return n}}function Qr(n,r,t){var e=typeof n;if(null==n||"function"==e)return Q(n,r,t);if("object"!=e)return tt(n);var u=ne(n),o=u[0],a=n[o];return 1!=u.length||a!==a||Sn(a)?function(r){for(var t=u.length,e=!1;t--&&(e=rn(r[u[t]],n[u[t]],null,!0)););return e}:function(n){var r=n[o];return a===r&&(0!==a||1/a==1/r)}}function Xr(n){return null==n?"":jt(n).replace(ue,fn)}function Yr(n){return n}function Zr(n,r,t){var e=!0,u=r&&wn(r);r&&(t||u.length)||(null==t&&(t=r),o=g,r=n,n=h,u=wn(r)),t===!1?e=!1:Sn(t)&&"chain"in t&&(e=t.chain);var o=n,a=In(o);Xn(u,function(t){var u=n[t]=r[t];a&&(o.prototype[t]=function(){var r=this.__chain__,t=this.__wrapped__,a=[t];$t.apply(a,arguments);var i=u.apply(n,a);if(e||r){if(t===i&&Sn(i))return this;i=new o(i),i.__chain__=r}return i})})}function nt(){return t._=Ot,this}function rt(){}function tt(n){return function(r){return r[n]}}function et(n,r,t){var e=null==n,u=null==r;if(null==t&&("boolean"==typeof n&&u?(t=n,n=1):u||"boolean"!=typeof r||(t=r,u=!0)),e&&u&&(r=1),n=+n||0,u?(r=n,n=0):r=+r||0,t||n%1||r%1){var o=Ht();return Vt(n+o*(r-n+parseFloat("1e-"+((o+"").length-1))),r)}return en(n,r)}function ut(n,r){if(n){var t=n[r];return In(t)?n[r]():t}}function ot(n,r,t){var e=h.templateSettings;n=jt(n||""),t=ae({},t,e);var u,o=ae({},t.imports,e.imports),i=ne(o),f=Un(o),l=0,c=t.interpolate||E,p="__p += '",s=wt((t.escape||E).source+"|"+c.source+"|"+(c===N?x:E).source+"|"+(t.evaluate||E).source+"|$","g");n.replace(s,function(r,t,e,o,i,f){return e||(e=o),p+=n.slice(l,f).replace(S,a),t&&(p+="' +\n__e("+t+") +\n'"),i&&(u=!0,p+="';\n"+i+";\n__p += '"),e&&(p+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),l=f+r.length,r}),p+="';\n";var g=t.variable,y=g;y||(g="obj",p="with ("+g+") {\n"+p+"\n}\n"),p=(u?p.replace(w,""):p).replace(j,"$1").replace(k,"$1;"),p="function("+g+") {\n"+(y?"":g+" || ("+g+" = {});\n")+"var __t, __p = '', __e = _.escape"+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var m="\n/*\n//# sourceURL="+(t.sourceURL||"/lodash/template/source["+D++ +"]")+"\n*/";try{var b=mt(i,"return "+p+m).apply(v,f)}catch(d){throw d.source=p,d}return r?b(r):(b.source=p,b)}function at(n,r,t){n=(n=+n)>-1?n:0;var e=-1,u=ht(n);for(r=Q(r,t,1);++e<n;)u[e]=r(e);return u}function it(n){return null==n?"":jt(n).replace(ee,sn)}function ft(n){var r=++y;return jt(null==n?"":n)+r}function lt(n){return n=new g(n),n.__chain__=!0,n}function ct(n,r){return r(n),n}function pt(){return this.__chain__=!0,this}function st(){return jt(this.__wrapped__)}function vt(){return this.__wrapped__}t=t?Z.defaults(H.Object(),t,Z.pick(H,A)):H;var ht=t.Array,gt=t.Boolean,yt=t.Date,mt=t.Function,bt=t.Math,dt=t.Number,_t=t.Object,wt=t.RegExp,jt=t.String,kt=t.TypeError,xt=[],Ct=_t.prototype,Ot=t._,Nt=Ct.toString,Rt=wt("^"+jt(Nt).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Et=bt.ceil,It=t.clearTimeout,St=bt.floor,At=mt.prototype.toString,Dt=cn(Dt=_t.getPrototypeOf)&&Dt,Tt=Ct.hasOwnProperty,$t=xt.push,Ft=t.setTimeout,Bt=xt.splice,Wt=xt.unshift,qt=function(){try{var n={},r=cn(r=_t.defineProperty)&&r,t=r(n,n,n)&&r}catch(e){}return t}(),zt=cn(zt=_t.create)&&zt,Lt=cn(Lt=ht.isArray)&&Lt,Pt=t.isFinite,Kt=t.isNaN,Ut=cn(Ut=_t.keys)&&Ut,Mt=bt.max,Vt=bt.min,Gt=t.parseInt,Ht=bt.random,Jt={};Jt[$]=ht,Jt[F]=gt,Jt[B]=yt,Jt[W]=mt,Jt[z]=_t,Jt[q]=dt,Jt[L]=wt,Jt[P]=jt,g.prototype=h.prototype;var Qt=h.support={};Qt.funcDecomp=!cn(t.WinRTError)&&I.test(s),Qt.funcNames="string"==typeof mt.name,h.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:N,variable:"",imports:{_:h}},zt||(J=function(){function n(){}return function(r){if(Sn(r)){n.prototype=r;var e=new n;n.prototype=null}return e||t.Object()}}());var Xt=qt?function(n,r){M.value=r,qt(n,"__bindData__",M),M.value=null}:rt,Yt=Lt||function(n){return n&&"object"==typeof n&&"number"==typeof n.length&&Nt.call(n)==$||!1},Zt=function(n){var r,t=n,e=[];if(!t)return e;if(!V[typeof n])return e;for(r in t)Tt.call(t,r)&&e.push(r);return e},ne=Ut?function(n){return Sn(n)?Ut(n):[]}:Zt,re={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te=kn(re),ee=wt("("+ne(te).join("|")+")","g"),ue=wt("["+ne(re).join("")+"]","g"),oe=function(n,r,t){var e,u=n,o=u;if(!u)return o;var a=arguments,i=0,f="number"==typeof t?2:a.length;if(f>3&&"function"==typeof a[f-2])var l=Q(a[--f-1],a[f--],2);else f>2&&"function"==typeof a[f-1]&&(l=a[--f]);for(;++i<f;)if(u=a[i],u&&V[typeof u])for(var c=-1,p=V[typeof u]&&ne(u),s=p?p.length:0;++c<s;)e=p[c],o[e]=l?l(o[e],u[e]):u[e];return o},ae=function(n,r,t){var e,u=n,o=u;if(!u)return o;for(var a=arguments,i=0,f="number"==typeof t?2:a.length;++i<f;)if(u=a[i],u&&V[typeof u])for(var l=-1,c=V[typeof u]&&ne(u),p=c?c.length:0;++l<p;)e=c[l],"undefined"==typeof o[e]&&(o[e]=u[e]);return o},ie=function(n,r,t){var e,u=n,o=u;if(!u)return o;if(!V[typeof u])return o;r=r&&"undefined"==typeof t?r:Q(r,t,3);for(e in u)if(r(u[e],e,n)===!1)return o;return o},fe=function(n,r,t){var e,u=n,o=u;if(!u)return o;if(!V[typeof u])return o;r=r&&"undefined"==typeof t?r:Q(r,t,3);for(var a=-1,i=V[typeof u]&&ne(u),f=i?i.length:0;++a<f;)if(e=i[a],r(u[e],e,n)===!1)return o;return o},le=Dt?function(n){if(!n||Nt.call(n)!=z)return!1;var r=n.valueOf,t=cn(r)&&(t=Dt(r))&&Dt(t);return t?n==t||Dt(n)==t:pn(n)}:pn,ce=on(function(n,r,t){Tt.call(n,t)?n[t]++:n[t]=1}),pe=on(function(n,r,t){(Tt.call(n,t)?n[t]:n[t]=[]).push(r)}),se=on(function(n,r,t){n[t]=r}),ve=nr,he=Hn,ge=cn(ge=yt.now)&&ge||function(){return(new yt).getTime()},ye=8==Gt(_+"08")?Gt:function(n,r){return Gt(Fn(n)?n.replace(R,""):n,r||0)};return h.after=Tr,h.assign=oe,h.at=Mn,h.bind=$r,h.bindAll=Fr,h.bindKey=Br,h.chain=lt,h.compact=sr,h.compose=Wr,h.constant=Jr,h.countBy=ce,h.create=yn,h.createCallback=Qr,h.curry=qr,h.debounce=zr,h.defaults=ae,h.defer=Lr,h.delay=Pr,h.difference=vr,h.filter=Hn,h.flatten=mr,h.forEach=Xn,h.forEachRight=Yn,h.forIn=ie,h.forInRight=dn,h.forOwn=fe,h.forOwnRight=_n,h.functions=wn,h.groupBy=pe,h.indexBy=se,h.initial=dr,h.intersection=_r,h.invert=kn,h.invoke=Zn,h.keys=ne,h.map=nr,h.mapValues=Wn,h.max=rr,h.memoize=Kr,h.merge=qn,h.min=tr,h.omit=zn,h.once=Ur,h.pairs=Ln,h.partial=Mr,h.partialRight=Vr,h.pick=Pn,h.pluck=ve,h.property=tt,h.pull=kr,h.range=xr,h.reject=or,h.remove=Cr,h.rest=Or,h.shuffle=ir,h.sortBy=cr,h.tap=ct,h.throttle=Gr,h.times=at,h.toArray=pr,h.transform=Kn,h.union=Rr,h.uniq=Er,h.values=Un,h.where=he,h.without=Ir,h.wrap=Hr,h.xor=Sr,h.zip=Ar,h.zipObject=Dr,h.collect=nr,h.drop=Or,h.each=Xn,h.eachRight=Yn,h.extend=oe,h.methods=wn,h.object=Dr,h.select=Hn,h.tail=Or,h.unique=Er,h.unzip=Ar,Zr(h),h.clone=hn,h.cloneDeep=gn,h.contains=Vn,h.escape=Xr,h.every=Gn,h.find=Jn,h.findIndex=hr,h.findKey=mn,h.findLast=Qn,h.findLastIndex=gr,h.findLastKey=bn,h.has=jn,h.identity=Yr,h.indexOf=br,h.isArguments=vn,h.isArray=Yt,h.isBoolean=xn,h.isDate=Cn,h.isElement=On,h.isEmpty=Nn,h.isEqual=Rn,h.isFinite=En,h.isFunction=In,h.isNaN=An,h.isNull=Dn,h.isNumber=Tn,h.isObject=Sn,h.isPlainObject=le,h.isRegExp=$n,h.isString=Fn,h.isUndefined=Bn,h.lastIndexOf=jr,h.mixin=Zr,h.noConflict=nt,h.noop=rt,h.now=ge,h.parseInt=ye,h.random=et,h.reduce=er,h.reduceRight=ur,h.result=ut,h.runInContext=s,h.size=fr,h.some=lr,h.sortedIndex=Nr,h.template=ot,h.unescape=it,h.uniqueId=ft,h.all=Gn,h.any=lr,h.detect=Jn,h.findWhere=Jn,h.foldl=er,h.foldr=ur,h.include=Vn,h.inject=er,Zr(function(){var n={};return fe(h,function(r,t){h.prototype[t]||(n[t]=r)}),n}(),!1),h.first=yr,h.last=wr,h.sample=ar,h.take=yr,h.head=yr,fe(h,function(n,r){var t="sample"!==r;h.prototype[r]||(h.prototype[r]=function(r,e){var u=this.__chain__,o=n(this.__wrapped__,r,e);return u||null!=r&&(!e||t&&"function"==typeof r)?new g(o,u):o})}),h.VERSION="2.4.2",h.prototype.chain=pt,h.prototype.toString=st,h.prototype.value=vt,h.prototype.valueOf=vt,Xn(["join","pop","shift"],function(n){var r=xt[n];h.prototype[n]=function(){var n=this.__chain__,t=r.apply(this.__wrapped__,arguments);return n?new g(t,n):t}}),Xn(["push","reverse","sort","unshift"],function(n){var r=xt[n];h.prototype[n]=function(){return r.apply(this.__wrapped__,arguments),this}}),Xn(["concat","slice","splice"],function(n){var r=xt[n];h.prototype[n]=function(){return new g(r.apply(this.__wrapped__,arguments),this.__chain__)}}),h}var v,h=[],g=[],y=0,m=+new Date+"",b=75,d=40,_=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",w=/\b__p \+= '';/g,j=/\b(__p \+=) '' \+/g,k=/(__e\(.*?\)|\b__t\)) \+\n'';/g,x=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,C=/\w*$/,O=/^\s*function[ \n\r\t]+\w/,N=/<%=([\s\S]+?)%>/g,R=RegExp("^["+_+"]*0+(?=.$)"),E=/($^)/,I=/\bthis\b/,S=/['\n\r\t\u2028\u2029\\]/g,A=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],D=0,T="[object Arguments]",$="[object Array]",F="[object Boolean]",B="[object Date]",W="[object Function]",q="[object Number]",z="[object Object]",L="[object RegExp]",P="[object String]",K={};K[W]=!1,K[T]=K[$]=K[F]=K[B]=K[q]=K[z]=K[L]=K[P]=!0;var U={leading:!1,maxWait:0,trailing:!1},M={configurable:!1,enumerable:!1,value:null,writable:!1},V={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},G={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},H=V[typeof window]&&window||this,J=V[typeof exports]&&exports&&!exports.nodeType&&exports,Q=V[typeof module]&&module&&!module.nodeType&&module,X=Q&&Q.exports===J&&J,Y=V[typeof global]&&global;!Y||Y.global!==Y&&Y.window!==Y||(H=Y);var Z=s();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(H._=Z,define(function(){return Z})):J&&Q?X?(Q.exports=Z)._=Z:J._=Z:H._=Z}).call(this);


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],176:[function(require,module,exports){
var localforage=require("localforage"),EventEmitter=require("events").EventEmitter,muteUI=require("./ui"),extend=require("extend"),dispatchChanged=function(e,t){e.emit("change",t),e.emit(t===!0?"mute":"unmute")},updateFromLocalStorage=function(e,t){localforage.getItem("poem-mute",function(t,u){e.muted();e.muted(t||u!==!1&&u!==!0?!1:u)}.bind(this))},keyboardShortcut=function(e,t,u){u.keyCode!==!1&&window.addEventListener("keydown",function(e){e.keyCode===u.keyCode&&t()})},getSetMuted=function(e,t){return function(u){return(u===!0||u===!1)&&u!==e.muted&&(e.muted=u,localforage.setItem("poem-mute",e.muted),dispatchChanged(t,e.muted)),e.muted}},mute=function(e){var t=extend({muted:!1,keyCode:83}),u={muted:t.muted},n=new EventEmitter,o=getSetMuted(u,n),r=function(){o(!o())};keyboardShortcut(u,r,t);var d={muted:o,toggle:r,emitter:n,el:null};return updateFromLocalStorage(d,n),d.el=muteUI(d),d};module.exports=mute;


},{"./ui":181,"events":196,"extend":179,"localforage":132}],177:[function(require,module,exports){
function ClassList(n){function t(n){var t=s();indexof(t,n)>-1||(t.push(n),a(t))}function r(n){var t=s(),r=indexof(t,n);-1!==r&&(t.splice(r,1),a(t))}function e(n){return indexof(s(),n)>-1}function i(n){return e(n)?(r(n),!1):(t(n),!0)}function u(){return n.className}function o(n){var t=s();return t[n]||null}function s(){var t=n.className;return filter(t.split(" "),isTruthy)}function a(t){var r=t.length;n.className=t.join(" "),l.length=r;for(var e=0;e<t.length;e++)l[e]=t[e];delete t[r]}var f=n.classList;if(f)return f;var l={add:t,remove:r,contains:e,toggle:i,toString:u,length:0,item:o};return l}function filter(n,t){for(var r=[],e=0;e<n.length;e++)t(n[e])&&r.push(n[e]);return r}function isTruthy(n){return!!n}var indexof=require("indexof");module.exports=ClassList;


},{"indexof":178}],178:[function(require,module,exports){
var indexOf=[].indexOf;module.exports=function(e,n){if(indexOf)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1};


},{}],179:[function(require,module,exports){
var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString,undefined,isPlainObject=function(t){"use strict";if(!t||"[object Object]"!==toString.call(t))return!1;var r=hasOwn.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&hasOwn.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var o;for(o in t);return o===undefined||hasOwn.call(t,o)};module.exports=function t(){"use strict";var r,n,o,e,c,a,i=arguments[0],s=1,u=arguments.length,l=!1;for("boolean"==typeof i?(l=i,i=arguments[1]||{},s=2):("object"!=typeof i&&"function"!=typeof i||null==i)&&(i={});u>s;++s)if(r=arguments[s],null!=r)for(n in r)o=i[n],e=r[n],i!==e&&(l&&e&&(isPlainObject(e)||(c=Array.isArray(e)))?(c?(c=!1,a=o&&Array.isArray(o)?o:[]):a=o&&isPlainObject(o)?o:{},i[n]=t(l,a,e)):e!==undefined&&(i[n]=e));return i};


},{}],180:[function(require,module,exports){
var inserted={};module.exports=function(e,t){if(!inserted[e]){inserted[e]=!0;var n=document.createElement("style");n.setAttribute("type","text/css"),"textContent"in n?n.textContent=e:n.styleSheet.cssText=e;var s=document.getElementsByTagName("head")[0];t&&t.prepend?s.insertBefore(n,s.childNodes[0]):s.appendChild(n)}};


},{}],181:[function(require,module,exports){
(function (Buffer){
function createElement(L,M){var j=document.createElement("div");return j.innerHTML=L,j.getElementsByClassName(M)[0]}var ClassList=require("class-list"),insertCss=require("insert-css"),_html=Buffer("PGEgaHJlZj0nI211dGUnIGlkPSdwb2VtLW11dGUnIGNsYXNzPSdwb2VtLW11dGUnIHRpdGxlPSdIaXQgUyBrZXkgdG8gbXV0ZSc+Cgk8c3ZnIGNsYXNzPSdwb2VtLW11dGUtc3ZnJyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJCSB2aWV3Qm94PSIwIDAgNjQwIDQxNC40IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA2NDAgNDE0LjQiIHhtbDpzcGFjZT0icHJlc2VydmUiPgoJPHBhdGggY2xhc3M9J3BvZW0tbXV0ZS1zcGVha2VyJwoJCWQ9Ik0yOTQuNCwzNzlsLTExMi41LTc4LjljLTMuOC0yLjctOC4zLTQuMS0xMy00LjFINzMuNkM2MS4xLDI5Niw1MSwyODUuOSw1MSwyNzMuNFYxNDIuNmMwLTEyLjUsMTAuMS0yMi42LDIyLjYtMjIuNmg5Ni4yCgkJYzQuNywwLDkuMi0xLjQsMTMuMS00LjFsMTExLjUtNzguN2MxNS0xMC42LDM1LjcsMC4xLDM1LjcsMTguNXYzMDQuOEMzMzAsMzc4LjgsMzA5LjQsMzg5LjUsMjk0LjQsMzc5eiIvPgoJPHBhdGggY2xhc3M9J3BvZW0tbXV0ZS14JwoJCWQ9Ik01NjUuMywyNjkuM2wtNTkuMS01OS4xbDU5LjEtNTkuMWM3LjEtNy4xLDcuMS0xOC43LDAtMjUuOGMtNy4xLTcuMS0xOC43LTcuMS0yNS44LDBsLTU5LjEsNTkuMWwtNTkuMS01OS4xCgkJYy03LjEtNy4xLTE4LjctNy4xLTI1LjgsMGwwLDBjLTcuMSw3LjEtNy4xLDE4LjcsMCwyNS44bDU5LjEsNTkuMWwtNTkuMSw1OS4xYy03LjEsNy4xLTcuMSwxOC43LDAsMjUuOGM3LjEsNy4xLDE4LjcsNy4xLDI1LjgsMAoJCWw1OS4xLTU5LjFsNTkuMSw1OS4xYzcuMSw3LjEsMTguNyw3LjEsMjUuOCwwdjBDNTcyLjQsMjg3LjksNTcyLjQsMjc2LjQsNTY1LjMsMjY5LjN6Ii8+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggY2xhc3M9J3BvZW0tbXV0ZS13YXZlJwoJCQkJZD0iTTM5NS4yLDMxNC4yYy02LjMsMC0xMi40LTMuNy0xNS4xLTkuOGMtMi44LTYuNS0xLjItMTMuNywzLjUtMTguNGMwLjUtMC42LDEtMS4yLDEuNi0xLjhjMi4yLTIuMiw0LjMtMy42LDYuMS00LjcKCQkJCWMxLTEuMSwyLTIuMiwzLTMuM2MxLjctMS44LDMuNC0zLjcsNS4zLTUuN2MxNi42LTE5LjksMjQuNC00Ni43LDIxLjYtNzMuN2MtMi44LTI2LjktMTYtNTEuMy0zNi4yLTY2LjljLTcuMi01LjYtOC41LTE1LjktMy0yMy4xCgkJCQljNS42LTcuMiwxNS45LTguNSwyMy4xLTNjMjcuMywyMS4xLDQ1LjEsNTMuNyw0OC44LDg5LjZjMy44LDM2LjEtNyw3Mi4yLTI5LjYsOTlsLTAuNCwwLjVsLTAuNSwwLjVjLTEuNiwxLjYtMy4xLDMuMi00LjcsNQoJCQkJYy0xLjgsMi0zLjcsNC4xLTUuOSw2LjNsLTEuOSwxLjlsLTIuNCwxLjJjMCwwLDAsMC0wLjEsMGMtMS40LDEuNy0zLjUsMy44LTYuOSw1LjJDMzk5LjcsMzEzLjgsMzk3LjUsMzE0LjIsMzk1LjIsMzE0LjJ6Ii8+CgkJPC9nPgoJCTxnPgoJCQk8cGF0aCBjbGFzcz0ncG9lbS1tdXRlLXdhdmUnCgkJCQlkPSJNNDM4LjYsMzU2LjJjLTYuMywwLTEyLjQtMy43LTE1LjEtOS44Yy0yLjktNi42LTEuMS0xNC4xLDMuOS0xOC44YzAuNS0wLjcsMS4yLTEuNiwyLjEtMi40YzMtMyw1LjktNC44LDguMy02LjIKCQkJCWMxLjgtMS45LDMuNi0zLjgsNS40LTUuOWMyLjQtMi43LDQuOS01LjUsNy44LTguNGMyNS43LTMwLjcsMzcuOS03Mi4xLDMzLjUtMTEzLjhjLTQuNC00MS41LTI0LjgtNzkuMS01NS45LTEwMy4yCgkJCQljLTcuMi01LjYtOC41LTE1LjktMy0yMy4xYzUuNi03LjIsMTUuOS04LjUsMjMuMS0zYzM4LjIsMjkuNiw2My4yLDc1LjQsNjguNiwxMjUuOGM1LjQsNTAuOC05LjgsMTAxLjUtNDEuNiwxMzkuMWwtMC40LDAuNQoJCQkJbC0wLjUsMC41Yy0yLjQsMi40LTQuNyw1LTcuMSw3LjZjLTIuNiwyLjktNS4yLDUuOC04LjMsOC45bC0xLjksMS45bC0yLjQsMS4yYy0wLjgsMC40LTEuNCwwLjctMS43LDAuOWMtMS4zLDEuOS0zLjgsNC44LTguMSw2LjYKCQkJCUM0NDMsMzU1LjcsNDQwLjgsMzU2LjIsNDM4LjYsMzU2LjJ6Ii8+CgkJPC9nPgoJCTxnPgoJCQk8cGF0aCBjbGFzcz0ncG9lbS1tdXRlLXdhdmUnCgkJCQlkPSJNNDgzLjYsMzk1LjZjLTYuMywwLTEyLjQtMy43LTE1LjEtOS44Yy0zLTYuNy0xLjEtMTQuNCw0LjItMTljMC42LTAuOSwxLjQtMS45LDIuNS0yLjljMy43LTMuNyw3LjMtNS45LDEwLjMtNy41CgkJCQljMi42LTIuNyw1LTUuNCw3LjYtOC4zYzMuMi0zLjUsNi40LTcuMSwxMC4xLTEwLjhjMzQuMy00MC44LDUwLjYtOTYsNDQuOC0xNTEuNmMtNS44LTU1LjItMzMtMTA1LjItNzQuNS0xMzcuMwoJCQkJYy03LjItNS42LTguNS0xNS45LTMtMjMuMWM1LjYtNy4yLDE1LjktOC41LDIzLjEtM2M0OC42LDM3LjYsODAuMyw5NS45LDg3LjEsMTYwYzYuOCw2NC43LTEyLjQsMTI5LjEtNTIuOCwxNzYuOWwtMC40LDAuNQoJCQkJbC0wLjUsMC41Yy0zLjMsMy4zLTYuMiw2LjYtOS40LDEwLjFjLTMuMywzLjctNi43LDcuNS0xMC42LDExLjNsLTEuOSwxLjlsLTIuNCwxLjJjLTEuOCwwLjktMi44LDEuNC0zLjYsMgoJCQkJYy0xLjMsMi0zLjksNS41LTguOSw3LjdDNDg4LjEsMzk1LjIsNDg1LjgsMzk1LjYsNDgzLjYsMzk1LjZ6Ii8+CgkJPC9nPgoJPC9nPgoJPC9zdmc+CjwvYT4=","base64"),_css=Buffer("LnBvZW0tbXV0ZS1zdmcgewogICAgZmlsbDogI2ZmZjsKCW9wYWNpdHk6MC44Owp9Ci5wb2VtLW11dGUtbXV0ZWQgLnBvZW0tbXV0ZS13YXZlIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KLnBvZW0tbXV0ZS11bm11dGVkIC5wb2VtLW11dGUteCB7CiAgICBkaXNwbGF5OiBub25lOwp9Ci5wb2VtLW11dGUteCB7CiAgICBmaWxsOiByZWQ7Cn0KLnBvZW0tbXV0ZS1zdmc6aG92ZXIgewogICAgb3BhY2l0eToxOwp9","base64"),_cssInserted=!1;module.exports=function(L){var M=createElement(_html,"poem-mute"),j=ClassList(M);_cssInserted||(insertCss(_css),_cssInserted=!0);var u=function(){L.muted()?(j.remove("poem-mute-unmuted"),j.add("poem-mute-muted")):(j.remove("poem-mute-muted"),j.add("poem-mute-unmuted"))};return L.emitter.on("change",u),u(),M.addEventListener("click",function(M){L.toggle(),u(),M.preventDefault(),M.stopImmediatePropagation()},!0),M};


}).call(this,require("buffer").Buffer)

},{"buffer":192,"class-list":177,"insert-css":180}],182:[function(require,module,exports){
function noop(n){if(n)throw n}function badge(n,t){inserted||(insert(".npm-scb-wrap {\n  font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  font-weight: 200;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n}\n\n.npm-scb-wrap a {\n  text-decoration: none;\n  color: #000;\n}\n.npm-scb-white\n.npm-scb-wrap a {\n  color: #fff;\n}\n\n.npm-scb-inner {\n  position: absolute;\n  top: -120px; left: 0;\n  padding: 8px;\n  width: 100%;\n  height: 150px;\n  z-index: 2;\n  -webkit-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n     -moz-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n      -ms-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n       -o-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n          transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n}\n.npm-scb-wrap:hover\n.npm-scb-inner {\n  top: 0;\n}\n\n.npm-scb-artwork {\n  position: absolute;\n  top: 16px; left: 16px;\n  width: 104px; height: 104px;\n  box-shadow: 0 0 8px -3px #000;\n  outline: 1px solid rgba(0,0,0,0.1);\n  z-index: 2;\n}\n.npm-scb-white\n.npm-scb-artwork {\n  outline: 1px solid rgba(255,255,255,0.1);\n  box-shadow: 0 0 10px -2px rgba(255,255,255,0.9);\n}\n\n.npm-scb-info {\n  position: absolute;\n  top: 16px;\n  left: 120px;\n  width: 300px;\n  z-index: 1;\n}\n\n.npm-scb-info > a {\n  display: block;\n}\n\n.npm-scb-now-playing {\n  font-size: 12px;\n  line-height: 12px;\n  position: absolute;\n  width: 500px;\n  z-index: 1;\n  padding: 15px 0;\n  top: 0; left: 138px;\n  opacity: 1;\n  -webkit-transition: opacity 0.25s;\n     -moz-transition: opacity 0.25s;\n      -ms-transition: opacity 0.25s;\n       -o-transition: opacity 0.25s;\n          transition: opacity 0.25s;\n}\n\n.npm-scb-wrap:hover\n.npm-scb-now-playing {\n  opacity: 0;\n}\n\n.npm-scb-white\n.npm-scb-now-playing {\n  color: #fff;\n}\n.npm-scb-now-playing > a {\n  font-weight: bold;\n}\n\n.npm-scb-info > a > p {\n  margin: 0;\n  padding-bottom: 0.25em;\n  line-height: 1.35em;\n  margin-left: 1em;\n  font-size: 1em;\n}\n\n.npm-scb-title {\n  font-weight: bold;\n}\n\n.npm-scb-icon {\n  position: absolute;\n  top: 120px;\n  padding-top: 0.75em;\n  left: 16px;\n}\n"),inserted=!0),template||(template=minstache.compile('<div class="npm-scb-wrap">\n  <div class="npm-scb-inner">\n    <a target="_blank" href="{{urls.song}}">\n      <img class="npm-scb-icon" src="{{icon}}">\n      <img class="npm-scb-artwork" src="{{artwork}}">\n    </a>\n    <div class="npm-scb-info">\n      <a target="_blank" href="{{urls.song}}">\n        <p class="npm-scb-title">{{title}}</p>\n      </a>\n      <a target="_blank" href="{{urls.artist}}">\n        <p class="npm-scb-artist">{{artist}}</p>\n      </a>\n    </div>\n  </div>\n  <div class="npm-scb-now-playing">\n    Now Playing:\n    <a href="{{urls.song}}">{{title}}</a>\n    by\n    <a href="{{urls.artist}}">{{artist}}</a>\n  </div>\n</div>\n')),!gwfadded&&n.getFonts&&(fonts.add({"Open Sans":[300,600]}),gwfadded=!0),n=n||{},t=t||noop;var i=n.el||document.createElement("div"),e="dark"in n&&!n.dark?"white":"black",s=n.client_id,o=n.song;return resolve(s,o,function(n,o){if(n)return t(n);if("track"!==o.kind)throw new Error("soundcloud-badge only supports individual tracks at the moment");i.classList["black"===e?"remove":"add"]("npm-scb-white"),i.innerHTML=template({artwork:o.artwork_url||o.user.avatar_url,artist:o.user.username,title:o.title,icon:icons[e],urls:{song:o.permalink_url,artist:o.user.permalink_url}}),document.body.appendChild(i),t(null,o.stream_url+"?client_id="+s,o,i)}),i}var resolve=require("soundcloud-resolve"),fonts=require("google-fonts"),minstache=require("minstache"),insert=require("insert-css"),fs=require("fs"),icons={black:"http://developers.soundcloud.com/assets/logo_black.png",white:"http://developers.soundcloud.com/assets/logo_white.png"};module.exports=badge;var inserted=!1,gwfadded=!1,template=null;


},{"fs":191,"google-fonts":183,"insert-css":184,"minstache":185,"soundcloud-resolve":186}],183:[function(require,module,exports){
function asString(e){var t=getHref(e);return'<link href="'+t+'" rel="stylesheet" type="text/css">'}function asElement(e){var t=getHref(e),r=document.createElement("link");return r.setAttribute("href",t),r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r}function getHref(e){var t=Object.keys(e).map(function(t){var r=e[t];return t=t.replace(/\s+/,"+"),"boolean"==typeof r?t:t+":"+makeArray(r).join(",")}).join("|");return"http://fonts.googleapis.com/css?family="+t}function append(e){var t=asElement(e);return document.head.appendChild(t),t}function makeArray(e){return Array.isArray(e)?e:[e]}module.exports=asString,module.exports.add=append;


},{}],184:[function(require,module,exports){
var inserted=[];module.exports=function(e){if(!(inserted.indexOf(e)>=0)){inserted.push(e);var d=document.createElement("style"),t=document.createTextNode(e);d.appendChild(t),document.head.childNodes.length?document.head.insertBefore(d,document.head.childNodes[0]):document.head.appendChild(d)}};


},{}],185:[function(require,module,exports){
function render(e,r){r=r||{};var t=compile(e);return t(r)}function compile(e){for(var r,t=[],n=parse(e),o=0;o<n.length;++o)if(r=n[o],o%2==0)t.push('"'+r.replace(/"/g,'\\"')+'"');else switch(r[0]){case"/":r=r.slice(1),t.push(") + ");break;case"^":r=r.slice(1),assertProperty(r),t.push(' + section(obj, "'+r+'", true, ');break;case"#":r=r.slice(1),assertProperty(r),t.push(' + section(obj, "'+r+'", false, ');break;case"!":r=r.slice(1),assertProperty(r),t.push(" + obj."+r+" + ");break;default:assertProperty(r),t.push(" + escape(obj."+r+") + ")}return t="\n"+indent(escape.toString())+";\n\n"+indent(section.toString())+";\n\n  return "+t.join("").replace(/\n/g,"\\n"),new Function("obj",t)}function assertProperty(e){if(!e.match(/^[\w.]+$/))throw new Error('invalid property "'+e+'"')}function parse(e){return e.split(/\{\{|\}\}/)}function indent(e){return e.replace(/^/gm,"  ")}function section(e,r,t,n){var o=e[r];return"function"==typeof o?o.call(e,n):(t&&(o=!o),o?n:"")}function escape(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}exports=module.exports=render,exports.compile=compile;


},{}],186:[function(require,module,exports){
function resolve(r,e,o){var s="http://api.soundcloud.com/resolve.json?"+qs.stringify({url:e,client_id:r});xhr({uri:s,method:"GET"},function(r,e,s){if(r)return o(r);try{s=JSON.parse(s)}catch(n){return o(n)}return s.errors?o(new Error(s.errors[0].error_message)):o(null,s)})}var qs=require("querystring"),xhr=require("xhr");module.exports=resolve;


},{"querystring":200,"xhr":187}],187:[function(require,module,exports){
function createXHR(e,t){function o(){4===s.readyState&&n()}function n(){var e=null,o=s.statusCode=s.status,n=s.body=s.response||s.responseText||s.responseXML;if(0===o||o>=400&&600>o){var r=s.responseText||messages[String(s.status).charAt(0)];e=new Error(r),e.statusCode=s.status}if(c)try{n=s.body=JSON.parse(n)}catch(a){}t(e,s,n)}function r(e){t(e,s)}"string"==typeof e&&(e={uri:e}),e=e||{},t=once(t);var s;s=e.cors?new XDR:new XHR;var a=s.url=e.uri,i=s.method=e.method||"GET",u=e.body||e.data,d=s.headers=e.headers||{},c=!1;return"json"in e&&(c=!0,d["Content-Type"]="application/json",u=JSON.stringify(e.json)),s.onreadystatechange=o,s.onload=n,s.onerror=r,s.onprogress=function(){},s.ontimeout=noop,s.open(i,a),e.cors&&(s.withCredentials=!0),s.timeout="timeout"in e?e.timeout:5e3,s.setRequestHeader&&Object.keys(d).forEach(function(e){s.setRequestHeader(e,d[e])}),s.send(u),s}function noop(){}var window=require("global/window"),once=require("once"),messages={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},XHR=window.XMLHttpRequest||noop,XDR="withCredentials"in new XHR?window.XMLHttpRequest:window.XDomainRequest;module.exports=createXHR;


},{"global/window":188,"once":189}],188:[function(require,module,exports){
(function (global){
module.exports="undefined"!=typeof window?window:"undefined"!=typeof global?global:{};


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],189:[function(require,module,exports){
function once(n){var o=!1;return function(){return o?void 0:(o=!0,n.apply(this,arguments))}}module.exports=once,once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0})});


},{}],190:[function(require,module,exports){
function offset(e,t){var n=e.clientX||0,r=e.clientY||0,o=bounds(t);return[n-o.left,r-o.top]}function getTargetTouch(e,t){return Array.prototype.slice.call(e).filter(function(e){return e.target===t})[0]||e[0]}function getTouch(e,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return null}function listeners(e,t){return function(n){t?e.addEventListener(n.type,n.listener):e.removeEventListener(n.type,n.listener)}}function normalize(e){return e.replace(/^(touch|mouse)/,"").replace(/up$/,"end").replace(/down$/,"start")}function bounds(e){return e===window||e===document||e===document.body?ROOT:e.getBoundingClientRect()}var Emitter=require("events/"),allEvents=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup"],ROOT={left:0,top:0};module.exports=function(e,t){function n(e,t){var n;return o&&/^touchend/.test(t)?(n=getTouch(e.changedTouches,o.identifier||0),n&&(o=null)):!o&&/^touchstart/.test(t)?o=n=getTargetTouch(e.changedTouches,r.target):o&&(n=getTouch(e.changedTouches,o.identifier||0)),n}t=t||{},e=e||window;var r=new Emitter;r.target=t.target||e;var o=null,u=t.filtered,i=allEvents;"string"==typeof t.type&&(i=allEvents.filter(function(e){return 0===e.indexOf(t.type)}));var c=i.map(function(e){var t=normalize(e),o=function(o){var i=o;if(/^touch/.test(e)&&(i=u?n(o,e):getTargetTouch(o.changedTouches,r.target)),i){var c=offset(i,r.target);r.emit(t,o,c)}};return{type:e,listener:o}});return r.enable=function(){return c.forEach(listeners(e,!0)),r},r.disable=function(){return c.forEach(listeners(e,!1)),r},r.enable(),r};


},{"events/":122}],191:[function(require,module,exports){



},{}],192:[function(require,module,exports){
function Buffer(t,e,r){if(!(this instanceof Buffer))return new Buffer(t,e,r);var n,i=typeof t;if("number"===i)n=t>0?t>>>0:0;else if("string"===i)n=Buffer.byteLength(t,e);else{if("object"!==i||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&isArray(t.data)&&(t=t.data),n=+t.length>0?Math.floor(+t.length):0}if(n>kMaxLength)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength.toString(16)+" bytes");var f;Buffer.TYPED_ARRAY_SUPPORT?f=Buffer._augment(new Uint8Array(n)):(f=this,f.length=n,f._isBuffer=!0);var o;if(Buffer.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)f._set(t);else if(isArrayish(t))if(Buffer.isBuffer(t))for(o=0;n>o;o++)f[o]=t.readUInt8(o);else for(o=0;n>o;o++)f[o]=(t[o]%256+256)%256;else if("string"===i)f.write(t,0,e);else if("number"===i&&!Buffer.TYPED_ARRAY_SUPPORT&&!r)for(o=0;n>o;o++)f[o]=0;return n>0&&n<=Buffer.poolSize&&(f.parent=rootParent),f}function SlowBuffer(t,e,r){if(!(this instanceof SlowBuffer))return new SlowBuffer(t,e,r);var n=new Buffer(t,e,r);return delete n.parent,n}function hexWrite(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var f=e.length;if(f%2!==0)throw new Error("Invalid hex string");n>f/2&&(n=f/2);for(var o=0;n>o;o++){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[r+o]=u}return o}function utf8Write(t,e,r,n){var i=blitBuffer(utf8ToBytes(e,t.length-r),t,r,n);return i}function asciiWrite(t,e,r,n){var i=blitBuffer(asciiToBytes(e),t,r,n);return i}function binaryWrite(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){var i=blitBuffer(base64ToBytes(e),t,r,n);return i}function utf16leWrite(t,e,r,n){var i=blitBuffer(utf16leToBytes(e,t.length-r),t,r,n,2);return i}function base64Slice(t,e,r){return base64.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function utf8Slice(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var f=e;r>f;f++)t[f]<=127?(n+=decodeUtf8Char(i)+String.fromCharCode(t[f]),i=""):i+="%"+t[f].toString(16);return n+decodeUtf8Char(i)}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(127&t[i]);return n}function binarySlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function hexSlice(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",f=e;r>f;f++)i+=toHex(t[f]);return i}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),i="",f=0;f<n.length;f+=2)i+=String.fromCharCode(n[f]+256*n[f+1]);return i}function checkOffset(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,i,f){if(!Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range")}function objectWriteUInt16(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,f=Math.min(t.length-r,2);f>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,f=Math.min(t.length-r,4);f>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function checkIEEE754(t,e,r,n,i,f){if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function writeFloat(t,e,r,n,i){return i||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,i){return i||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}function base64clean(t){if(t=stringtrim(t).replace(INVALID_BASE64_RE,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function isArrayish(t){return isArray(t)||Buffer.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function toHex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){var r,n=t.length,i=null;e=e||1/0;for(var f=[],o=0;n>o;o++){if(r=t.charCodeAt(o),r>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&f.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&f.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&f.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((e-=3)>-1&&f.push(239,191,189),i=null);if(128>r){if((e-=1)<0)break;f.push(r)}else if(2048>r){if((e-=2)<0)break;f.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;f.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((e-=4)<0)break;f.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return f}function asciiToBytes(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,i,f=[],o=0;o<t.length&&!((e-=2)<0);o++)r=t.charCodeAt(o),n=r>>8,i=r%256,f.push(i),f.push(n);return f}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n,i){i&&(n-=n%i);for(var f=0;n>f&&!(f+r>=e.length||f>=t.length);f++)e[f+r]=t[f];return f}function decodeUtf8Char(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var kMaxLength=1073741823,rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(r){return!1}}(),Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");for(var r=t.length,n=e.length,i=0,f=Math.min(r,n);f>i&&t[i]===e[i];i++);return i!==f&&(r=t[i],n=e[i]),n>r?-1:r>n?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new Buffer(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var n=new Buffer(e),i=0;for(r=0;r<t.length;r++){var f=t[r];f.copy(n,i),i+=f.length}return n},Buffer.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=utf8ToBytes(t).length;break;case"base64":r=base64ToBytes(t).length;break;default:r=t.length}return r},Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(t,e,r){var n=!1;if(e>>>=0,r=void 0===r||r===1/0?this.length:r>>>0,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"binary":return binarySlice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return 0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return Buffer.compare(this,t)},Buffer.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},Buffer.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},Buffer.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var i=n;n=e,e=r,r=i}if(e=Number(e)||0,0>r||0>e||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var f=this.length-e;r?(r=Number(r),r>f&&(r=f)):r=f,n=String(n||"utf8").toLowerCase();var o;switch(n){case"hex":o=hexWrite(this,t,e,r);break;case"utf8":case"utf-8":o=utf8Write(this,t,e,r);break;case"ascii":o=asciiWrite(this,t,e,r);break;case"binary":o=binaryWrite(this,t,e,r);break;case"base64":o=base64Write(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=utf16leWrite(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+n)}return o},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var n;if(Buffer.TYPED_ARRAY_SUPPORT)n=Buffer._augment(this.subarray(t,e));else{var i=e-t;n=new Buffer(i,void 0,!0);for(var f=0;i>f;f++)n[f]=this[f+t]}return n.length&&(n.parent=this.parent||this),n},Buffer.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return n},Buffer.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=e,i=1,f=this[t+--n];n>0&&(i*=256);)f+=this[t+--n]*i;return i*=128,f>=i&&(f-=Math.pow(2,8*e)),f},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=1,f=0;for(this[e]=255&t;++f<r&&(i*=256);)this[e+f]=t/i>>>0&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=r-1,f=1;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=t/f>>>0&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){t=+t,e>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=0,f=1,o=0>t?1:0;for(this[e]=255&t;++i<r&&(f*=256);)this[e+i]=(t/f>>0)-o&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){t=+t,e>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=r-1,f=1,o=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=(t/f>>0)-o&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){var i=this;if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===t.length||0===i.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=i.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var f=n-r;if(1e3>f||!Buffer.TYPED_ARRAY_SUPPORT)for(var o=0;f>o;o++)t[o+e]=this[o+r];else t._set(this.subarray(r,r+f),e);return f},Buffer.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=utf8ToBytes(t.toString()),f=i.length;for(n=e;r>n;n++)this[n]=i[n%f]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(t){return t.constructor=Buffer,t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=BP.get,t.set=BP.set,t.write=BP.write,t.toString=BP.toString,t.toLocaleString=BP.toString,t.toJSON=BP.toJSON,t.equals=BP.equals,t.compare=BP.compare,t.copy=BP.copy,t.slice=BP.slice,t.readUIntLE=BP.readUIntLE,t.readUIntBE=BP.readUIntBE,t.readUInt8=BP.readUInt8,t.readUInt16LE=BP.readUInt16LE,t.readUInt16BE=BP.readUInt16BE,t.readUInt32LE=BP.readUInt32LE,t.readUInt32BE=BP.readUInt32BE,t.readIntLE=BP.readIntLE,t.readIntBE=BP.readIntBE,t.readInt8=BP.readInt8,t.readInt16LE=BP.readInt16LE,t.readInt16BE=BP.readInt16BE,t.readInt32LE=BP.readInt32LE,t.readInt32BE=BP.readInt32BE,t.readFloatLE=BP.readFloatLE,t.readFloatBE=BP.readFloatBE,t.readDoubleLE=BP.readDoubleLE,t.readDoubleBE=BP.readDoubleBE,t.writeUInt8=BP.writeUInt8,t.writeUIntLE=BP.writeUIntLE,t.writeUIntBE=BP.writeUIntBE,t.writeUInt16LE=BP.writeUInt16LE,t.writeUInt16BE=BP.writeUInt16BE,t.writeUInt32LE=BP.writeUInt32LE,t.writeUInt32BE=BP.writeUInt32BE,t.writeIntLE=BP.writeIntLE,t.writeIntBE=BP.writeIntBE,t.writeInt8=BP.writeInt8,t.writeInt16LE=BP.writeInt16LE,t.writeInt16BE=BP.writeInt16BE,t.writeInt32LE=BP.writeInt32LE,t.writeInt32BE=BP.writeInt32BE,t.writeFloatLE=BP.writeFloatLE,t.writeFloatBE=BP.writeFloatBE,t.writeDoubleLE=BP.writeDoubleLE,t.writeDoubleBE=BP.writeDoubleBE,t.fill=BP.fill,t.inspect=BP.inspect,t.toArrayBuffer=BP.toArrayBuffer,t};var INVALID_BASE64_RE=/[^+\/0-9A-z\-]/g;


},{"base64-js":193,"ieee754":194,"is-array":195}],193:[function(require,module,exports){
var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function r(t){var r=t.charCodeAt(0);return r===h||r===u?62:r===c||r===f?63:o>r?-1:o+10>r?r-o+26+26:i+26>r?r-i:A+26>r?r-A+26:void 0}function e(t){function e(t){i[f++]=t}var n,h,c,o,A,i;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=t.length;A="="===t.charAt(u-2)?2:"="===t.charAt(u-1)?1:0,i=new a(3*t.length/4-A),c=A>0?t.length-4:t.length;var f=0;for(n=0,h=0;c>n;n+=4,h+=3)o=r(t.charAt(n))<<18|r(t.charAt(n+1))<<12|r(t.charAt(n+2))<<6|r(t.charAt(n+3)),e((16711680&o)>>16),e((65280&o)>>8),e(255&o);return 2===A?(o=r(t.charAt(n))<<2|r(t.charAt(n+1))>>4,e(255&o)):1===A&&(o=r(t.charAt(n))<<10|r(t.charAt(n+1))<<4|r(t.charAt(n+2))>>2,e(o>>8&255),e(255&o)),i}function n(t){function r(t){return lookup.charAt(t)}function e(t){return r(t>>18&63)+r(t>>12&63)+r(t>>6&63)+r(63&t)}var n,a,h,c=t.length%3,o="";for(n=0,h=t.length-c;h>n;n+=3)a=(t[n]<<16)+(t[n+1]<<8)+t[n+2],o+=e(a);switch(c){case 1:a=t[t.length-1],o+=r(a>>2),o+=r(a<<4&63),o+="==";break;case 2:a=(t[t.length-2]<<8)+t[t.length-1],o+=r(a>>10),o+=r(a>>4&63),o+=r(a<<2&63),o+="="}return o}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,h="+".charCodeAt(0),c="/".charCodeAt(0),o="0".charCodeAt(0),A="a".charCodeAt(0),i="A".charCodeAt(0),u="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=e,t.fromByteArray=n}("undefined"==typeof exports?this.base64js={}:exports);


},{}],194:[function(require,module,exports){
exports.read=function(o,t,a,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,n=a?h-1:0,s=a?-1:1,N=o[t+n];for(n+=s,M=N&(1<<-i)-1,N>>=-i,i+=w;i>0;M=256*M+o[t+n],n+=s,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+o[t+n],n+=s,i-=8);if(0===M)M=1-e;else{if(M===f)return p?0/0:(N?-1:1)*(1/0);p+=Math.pow(2,r),M-=e}return(N?-1:1)*p*Math.pow(2,M-r)},exports.write=function(o,t,a,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,n=i>>1,s=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,N=r?0:M-1,u=r?1:-1,l=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(w=isNaN(t)?1:0,p=i):(p=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-p))<1&&(p--,f*=2),t+=p+n>=1?s/f:s*Math.pow(2,1-n),t*f>=2&&(p++,f/=2),p+n>=i?(w=0,p=i):p+n>=1?(w=(t*f-1)*Math.pow(2,h),p+=n):(w=t*Math.pow(2,n-1)*Math.pow(2,h),p=0));h>=8;o[a+N]=255&w,N+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;o[a+N]=255&p,N+=u,p/=256,e-=8);o[a+N-u]|=128*l};


},{}],195:[function(require,module,exports){
var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(r){return!!r&&"[object Array]"==str.call(r)};


},{}],196:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,s,i,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];n.apply(this,i)}else if(isObject(n)){for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(o=n.slice(),s=o.length,r=0;s>r;r++)o[r].apply(this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,s,i,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=i;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){s=r;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};


},{}],197:[function(require,module,exports){
function drainQueue(){if(!draining){draining=!0;for(var e,o=queue.length;o;){e=queue,queue=[];for(var r=-1;++r<o;)e[r]();o=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(e){queue.push(e),draining||setTimeout(drainQueue,0)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};


},{}],198:[function(require,module,exports){
"use strict";function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(r,e,t,n){e=e||"&",t=t||"=";var o={};if("string"!=typeof r||0===r.length)return o;var a=/\+/g;r=r.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var y=0;p>y;++y){var u,c,i,l,f=r[y].replace(a,"%20"),v=f.indexOf(t);v>=0?(u=f.substr(0,v),c=f.substr(v+1)):(u=f,c=""),i=decodeURIComponent(u),l=decodeURIComponent(c),hasOwnProperty(o,i)?isArray(o[i])?o[i].push(l):o[i]=[o[i],l]:o[i]=l}return o};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};


},{}],199:[function(require,module,exports){
"use strict";function map(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}var stringifyPrimitive=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};module.exports=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?map(objectKeys(r),function(n){var i=encodeURIComponent(stringifyPrimitive(n))+t;return isArray(r[n])?map(r[n],function(r){return i+encodeURIComponent(stringifyPrimitive(r))}).join(e):i+encodeURIComponent(stringifyPrimitive(r[n]))}).join(e):n?encodeURIComponent(stringifyPrimitive(n))+t+encodeURIComponent(stringifyPrimitive(r)):""};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},objectKeys=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e};


},{}],200:[function(require,module,exports){
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");


},{"./decode":198,"./encode":199}]},{},[34])


//# sourceMappingURL=bundle.js.map